!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=20)}([function(e,t,n){"undefined"!=typeof self&&self,e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=37)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),a=n(42),u=r(a),s=n(43),l=r(s),c=n(44),f=r(c),h=n(45),d=r(h),_=n(24),v=(r(_),n(46)),p=r(v),m=void 0,E=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.canvas,this._viewport=[0,0,0,0],this._enabledVertexAttribute=[],this.identityMatrix=o.mat4.create(),this._normalMatrix=o.mat3.create(),this._inverseModelViewMatrix=o.mat3.create(),this._modelMatrix=o.mat4.create(),this._matrix=o.mat4.create(),this._matrixStacks=[],this._lastMesh=null,this._useWebGL2=!1,this._hasArrayInstance,this._extArrayInstance,this._hasCheckedExt=!1,o.mat4.identity(this.identityMatrix,this.identityMatrix),this.isMobile=!1,/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(this.isMobile=!0)}return i(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!=e){void 0!==this.canvas&&null!==this.canvas&&this.destroy(),this.canvas=e,this.setSize(window.innerWidth,window.innerHeight),t.useWebgl2=t.useWebgl2||!1;var n=void 0;t.useWebgl2&&(n=this.canvas.getContext("experimental-webgl2",t)||this.canvas.getContext("webgl2",t))?this._useWebGL2=!0:(n=this.canvas.getContext("webgl",t)||this.canvas.getContext("experimental-webgl",t),this._useWebGL2=!1),console.log("Using WebGL 2 ?",this.webgl2),this.initWithGL(n)}else console.error("Canvas not exist")}},{key:"initWithGL",value:function(e){this.canvas||(this.canvas=e.canvas),m=this.gl=e,this.extensions={};for(var t=0;t<p.default.length;t++)this.extensions[p.default[t]]=m.getExtension(p.default[t]);(0,l.default)(),(0,u.default)(m,"OES_vertex_array_object"),(0,u.default)(m,"ANGLE_instanced_arrays"),(0,u.default)(m,"WEBGL_draw_buffers"),this.enable(this.DEPTH_TEST),this.enable(this.CULL_FACE),this.enable(this.BLEND),this.enableAlphaBlending()}},{key:"setViewport",value:function(e,t,n,r){var i=!1;e!==this._viewport[0]&&(i=!0),t!==this._viewport[1]&&(i=!0),n!==this._viewport[2]&&(i=!0),r!==this._viewport[3]&&(i=!0),i&&(m.viewport(e,t,n,r),this._viewport=[e,t,n,r])}},{key:"scissor",value:function(e,t,n,r){m.scissor(e,t,n,r)}},{key:"clear",value:function(e,t,n,r){m.clearColor(e,t,n,r),m.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT)}},{key:"cullFace",value:function(e){m.cullFace(e)}},{key:"setMatrices",value:function(e){this.camera=e,this.rotate(this.identityMatrix)}},{key:"useShader",value:function(e){this.shader=e,this.shaderProgram=this.shader.shaderProgram}},{key:"rotate",value:function(e){o.mat4.copy(this._modelMatrix,e),o.mat4.multiply(this._matrix,this.camera.matrix,this._modelMatrix),o.mat3.fromMat4(this._normalMatrix,this._matrix),o.mat3.invert(this._normalMatrix,this._normalMatrix),o.mat3.transpose(this._normalMatrix,this._normalMatrix),o.mat3.fromMat4(this._inverseModelViewMatrix,this._matrix),o.mat3.invert(this._inverseModelViewMatrix,this._inverseModelViewMatrix)}},{key:"draw",value:function(e,t){if(e.length)for(var n=0;n<e.length;n++)this.draw(e[n]);else{e.bind(this.shaderProgram),void 0!==this.camera&&(this.shader.uniform("uProjectionMatrix","mat4",this.camera.projection),this.shader.uniform("uViewMatrix","mat4",this.camera.matrix)),this.shader.uniform("uModelMatrix","mat4",this._modelMatrix),this.shader.uniform("uNormalMatrix","mat3",this._normalMatrix),this.shader.uniform("uModelViewMatrixInverse","mat3",this._inverseModelViewMatrix);var r=e.drawType;void 0!==t&&(r=t),e.isInstanced?m.drawElementsInstanced(e.drawType,e.iBuffer.numItems,m.UNSIGNED_SHORT,0,e.numInstance):r===m.POINTS?m.drawArrays(r,0,e.vertexSize):m.drawElements(r,e.iBuffer.numItems,m.UNSIGNED_SHORT,0),e.unbind()}}},{key:"drawTransformFeedback",value:function(e){var t=e.meshSource,n=e.meshDestination,r=e.numPoints,i=e.transformFeedback;t.bind(this.shaderProgram),n.generateBuffers(this.shaderProgram),m.bindTransformFeedback(m.TRANSFORM_FEEDBACK,i),n.attributes.forEach(function(e,t){m.bindBufferBase(m.TRANSFORM_FEEDBACK_BUFFER,t,e.buffer)}),m.enable(m.RASTERIZER_DISCARD),m.beginTransformFeedback(m.POINTS),m.drawArrays(m.POINTS,0,r),m.endTransformFeedback(),m.disable(m.RASTERIZER_DISCARD),m.useProgram(null),m.bindBuffer(m.ARRAY_BUFFER,null),n.attributes.forEach(function(e,t){m.bindBufferBase(m.TRANSFORM_FEEDBACK_BUFFER,t,null)}),m.bindTransformFeedback(m.TRANSFORM_FEEDBACK,null),t.unbind()}},{key:"setSize",value:function(e,t){this._width=e,this._height=t,this.canvas.width=this._width,this.canvas.height=this._height,this._aspectRatio=this._width/this._height,m&&this.viewport(0,0,this._width,this._height)}},{key:"showExtensions",value:function(){for(var e in console.log("Extensions : ",this.extensions),this.extensions)this.extensions[e]&&console.log(e,":",this.extensions[e])}},{key:"checkExtension",value:function(e){return!!this.extensions[e]}},{key:"getExtension",value:function(e){return this.extensions[e]}},{key:"enableAlphaBlending",value:function(){m.blendFunc(m.SRC_ALPHA,m.ONE_MINUS_SRC_ALPHA)}},{key:"enableAdditiveBlending",value:function(){m.blendFunc(m.ONE,m.ONE)}},{key:"pushMatrix",value:function(){var e=o.mat4.clone(this._modelMatrix);this._matrixStacks.push(e)}},{key:"popMatrix",value:function(){if(0==this._matrixStacks.length)return null;var e=this._matrixStacks.pop();this.rotate(e)}},{key:"enable",value:function(e){m.enable(e)}},{key:"disable",value:function(e){m.disable(e)}},{key:"viewport",value:function(e,t,n,r){this.setViewport(e,t,n,r)}},{key:"destroy",value:function(){if(this.canvas.parentNode)try{this.canvas.parentNode.removeChild(this.canvas)}catch(e){console.log("Error : ",e)}this.canvas=null}},{key:"FLOAT",get:function(){return(0,f.default)()}},{key:"HALF_FLOAT",get:function(){return(0,d.default)()}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"aspectRatio",get:function(){return this._aspectRatio}},{key:"webgl2",get:function(){return this._useWebGL2}}]),e}(),T=new E;t.default=T},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0),u=(r=a)&&r.__esModule?r:{default:r},s=(n(47),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}),l=function(e){return e.slice?e.slice(0):new Float32Array(e)},c=void 0,f=n(9),h=n(48),d={float:"uniform1f",vec2:"uniform2fv",vec3:"uniform3fv",vec4:"uniform4fv",int:"uniform1i",mat3:"uniformMatrix3fv",mat4:"uniformMatrix4fv"},_=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h,r=arguments[2];(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),c=u.default.gl,this.parameters=[],this.uniformTextures=[],this._varyings=r,t||(t=f),n||(n=f);var i=this._createShaderProgram(t,!0),o=this._createShaderProgram(n,!1);this._attachShaderProgram(i,o)}return o(e,[{key:"bind",value:function(){u.default.shader!==this&&(c.useProgram(this.shaderProgram),u.default.useShader(this),this.uniformTextures=[])}},{key:"uniform",value:function(e,t,n){if("object"!==(void 0===e?"undefined":i(e))){for(var r=d[t]||t,o=!1,a=void 0,u=-1,f=0;f<this.parameters.length;f++)if((a=this.parameters[f]).name===e){o=!0,u=f;break}var h=!1;if(o?(this.shaderProgram[e]=a.uniformLoc,h=a.isNumber):(h="uniform1i"===r||"uniform1f"===r,this.shaderProgram[e]=c.getUniformLocation(this.shaderProgram,e),h?this.parameters.push({name:e,type:r,value:n,uniformLoc:this.shaderProgram[e],isNumber:h}):this.parameters.push({name:e,type:r,value:l(n),uniformLoc:this.shaderProgram[e],isNumber:h}),u=this.parameters.length-1),this.parameters[u].uniformLoc)if(-1===r.indexOf("Matrix"))if(h){var _=this.parameters[u].value!==n||!o;_&&(c[r](this.shaderProgram[e],n),this.parameters[u].value=n)}else s(this.parameters[u].value,n)&&o||(c[r](this.shaderProgram[e],n),this.parameters[u].value=l(n));else s(this.parameters[u].value,n)&&o||(c[r](this.shaderProgram[e],!1,n),this.parameters[u].value=l(n))}else this.uniformObject(e)}},{key:"uniformObject",value:function(t){for(var n in t){var r=t[n],i=e.getUniformType(r);if(r.concat&&r[0].concat){for(var o=[],a=0;a<r.length;a++)o=o.concat(r[a]);r=o}this.uniform(n,i,r)}}},{key:"_createShaderProgram",value:function(e,t){var n=t?u.default.VERTEX_SHADER:u.default.FRAGMENT_SHADER,r=c.createShader(n);return c.shaderSource(r,e),c.compileShader(r),c.getShaderParameter(r,c.COMPILE_STATUS)?r:(console.warn("Error in Shader : ",c.getShaderInfoLog(r)),console.log(function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(e)),null)}},{key:"_attachShaderProgram",value:function(e,t){this.shaderProgram=c.createProgram(),c.attachShader(this.shaderProgram,e),c.attachShader(this.shaderProgram,t),c.deleteShader(e),c.deleteShader(t),this._varyings&&(console.log("Transform feedback setup : ",this._varyings),c.transformFeedbackVaryings(this.shaderProgram,this._varyings,c.SEPARATE_ATTRIBS)),c.linkProgram(this.shaderProgram)}}]),e}();_.getUniformType=function(e){var t=!!e.concat;return t?function(e){return 9===e.length?"uniformMatrix3fv":16===e.length?"uniformMatrix4fv":"vec"+e.length}(e[0].concat?e[0]:e):"float"},t.default=_},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.vec4=t.vec3=t.vec2=t.quat2=t.quat=t.mat4=t.mat3=t.mat2d=t.mat2=t.glMatrix=void 0;var i=n(3),o=r(i),a=n(38),u=r(a),s=n(39),l=r(s),c=n(18),f=r(c),h=n(19),d=r(h),_=n(20),v=r(_),p=n(40),m=r(p),E=n(41),T=r(E),b=n(21),g=r(b),y=n(22),x=r(y);t.glMatrix=o,t.mat2=u,t.mat2d=l,t.mat3=f,t.mat4=d,t.quat=v,t.quat2=m,t.vec2=T,t.vec3=g,t.vec4=x},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setMatrixArrayType=function(e){t.ARRAY_TYPE=e},t.toRadian=function(e){return e*i},t.equals=function(e,t){return Math.abs(e-t)<=r*Math.max(1,Math.abs(e),Math.abs(t))};var r=t.EPSILON=1e-6,i=(t.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,t.RANDOM=Math.random,Math.PI/180)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._delayTasks=[],this._nextTasks=[],this._deferTasks=[],this._highTasks=[],this._usurpTask=[],this._enterframeTasks=[],this._idTable=0,this._startTime=(new Date).getTime(),this._deltaTime=0,this._internalTime=0,this._isPaused=!1,this._loop()}return r(e,[{key:"addEF",value:function(e,t){t=t||[];var n=this._idTable;return this._enterframeTasks[n]={func:e,params:t},this._idTable++,n}},{key:"removeEF",value:function(e){return void 0!==this._enterframeTasks[e]&&(this._enterframeTasks[e]=null),-1}},{key:"delay",value:function(e,t,n){var r=(new Date).getTime(),i={func:e,params:t,delay:n,time:r};this._delayTasks.push(i)}},{key:"defer",value:function(e,t){var n={func:e,params:t};this._deferTasks.push(n)}},{key:"next",value:function(e,t){var n={func:e,params:t};this._nextTasks.push(n)}},{key:"usurp",value:function(e,t){var n={func:e,params:t};this._usurpTask.push(n)}},{key:"pause",value:function(){this._isPaused=!0}},{key:"advance",value:function(){this._internalTime+=1/60}},{key:"resume",value:function(){this._isPaused=!1}},{key:"_process",value:function(){var e=0,t=void 0,n=void 0;for(e=0;e<this._enterframeTasks.length;e++)null!==(t=this._enterframeTasks[e])&&void 0!==t&&t.func(t.params);for(;this._highTasks.length>0;)(t=this._highTasks.pop()).func(t.params);var r=(new Date).getTime(),i=this._deltaTime;for(this._deltaTime=(r-this._startTime)/1e3,e=0;e<this._delayTasks.length;e++)t=this._delayTasks[e],r-t.time>t.delay&&(t.func(t.params),this._delayTasks.splice(e,1));for(r=(new Date).getTime(),this._deltaTime=(r-this._startTime)/1e3,n=1e3/60;this._deferTasks.length>0;){if(t=this._deferTasks.shift(),!((new Date).getTime()-r<n)){this._deferTasks.unshift(t);break}t.func(t.params)}for(r=(new Date).getTime(),this._deltaTime=(r-this._startTime)/1e3,n=1e3/60;this._usurpTask.length>0;)t=this._usurpTask.shift(),(new Date).getTime()-r<n&&t.func(t.params);this._highTasks=this._highTasks.concat(this._nextTasks),this._nextTasks=[],this._usurpTask=[],this._isPaused||(this._internalTime+=this._deltaTime-i)}},{key:"_loop",value:function(){var e=this;this._process(),window.requestAnimationFrame(function(){return e._loop()})}},{key:"intervalTime",get:function(){return this._internalTime}},{key:"deltaTime",get:function(){return this._deltaTime}}]),e}(),o=new i;t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=r(o),u=n(2),s=n(24),l=r(s),c=void 0,f=function(e){var t=void 0;return void 0!==e.buffer?t=e.buffer:(t=c.createBuffer(),e.buffer=t),t},h=function(e,t){for(var n=[],r=0;r<e.length;r+=t){for(var i=[],o=0;o<t;o++)i.push(e[r+o]);n.push(i)}return n},d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),c=a.default.gl,this.drawType=t,this._attributes=[],this._numInstance=-1,this._enabledVertexAttribute=[],this._indices=[],this._faces=[],this._bufferChanged=[],this._hasIndexBufferChanged=!1,this._hasVAO=!1,this._isInstanced=!1,this._extVAO=!!a.default.gl.createVertexArray,this._useVAO=!!this._extVAO&&n}return i(e,[{key:"bufferVertex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:35044;return this.bufferData(e,"aVertexPosition",3,t),this.normals.length<this.vertices.length&&this.bufferNormal(e,t),this}},{key:"bufferTexCoord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:35044;return this.bufferData(e,"aTextureCoord",2,t),this}},{key:"bufferNormal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:35044;return this.bufferData(e,"aNormal",3,t),this}},{key:"bufferIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._drawType=t?c.DYNAMIC_DRAW:c.STATIC_DRAW,this._indices=new Uint16Array(e),this._numItems=this._indices.length,this}},{key:"bufferFlattenData",value:function(e,t,n){var r=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]&&arguments[4],h(e,n));return this.bufferData(r,t,n,35044,!1),this}},{key:"bufferData",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:35044,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=0,a=r,u=[];for(n||(n=e[0].length),this._isInstanced=i||this._isInstanced,o=0;o<e.length;o++)for(var s=0;s<e[o].length;s++)u.push(e[o][s]);var l=new Float32Array(u),c=this.getAttribute(t);return c?(c.itemSize=n,c.dataArray=l,c.source=e):this._attributes.push({name:t,source:e,itemSize:n,drawType:a,dataArray:l,isInstanced:i}),this._bufferChanged.push(t),this}},{key:"bufferInstance",value:function(e,t){if(a.default.gl.vertexAttribDivisor){var n=e[0].length;this._numInstance=e.length,this.bufferData(e,t,n,35044,!0)}else console.error("Extension : ANGLE_instanced_arrays is not supported with this device !")}},{key:"bind",value:function(e){this.generateBuffers(e),this.hasVAO?c.bindVertexArray(this.vao):(this.attributes.forEach(function(e){c.bindBuffer(c.ARRAY_BUFFER,e.buffer);var t=e.attrPosition;c.vertexAttribPointer(t,e.itemSize,c.FLOAT,!1,0,0),e.isInstanced&&c.vertexAttribDivisor(t,1)}),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.iBuffer))}},{key:"generateBuffers",value:function(e){var t=this;0!=this._bufferChanged.length&&(this._useVAO?(this._vao||(this._vao=c.createVertexArray()),c.bindVertexArray(this._vao),this._attributes.forEach(function(n){if(-1!==t._bufferChanged.indexOf(n.name)){var r=f(n);c.bindBuffer(c.ARRAY_BUFFER,r),c.bufferData(c.ARRAY_BUFFER,n.dataArray,n.drawType);var i=(0,l.default)(c,e,n.name);c.enableVertexAttribArray(i),c.vertexAttribPointer(i,n.itemSize,c.FLOAT,!1,0,0),n.attrPosition=i,n.isInstanced&&c.vertexAttribDivisor(i,1)}}),this._updateIndexBuffer(),c.bindVertexArray(null),this._hasVAO=!0):(this._attributes.forEach(function(n){if(-1!==t._bufferChanged.indexOf(n.name)){var r=f(n);c.bindBuffer(c.ARRAY_BUFFER,r),c.bufferData(c.ARRAY_BUFFER,n.dataArray,n.drawType);var i=(0,l.default)(c,e,n.name);c.enableVertexAttribArray(i),c.vertexAttribPointer(i,n.itemSize,c.FLOAT,!1,0,0),n.attrPosition=i,n.isInstanced&&c.vertexAttribDivisor(i,1)}}),this._updateIndexBuffer()),this._hasIndexBufferChanged=!1,this._bufferChanged=[])}},{key:"unbind",value:function(){this._useVAO&&c.bindVertexArray(null),this._attributes.forEach(function(e){e.isInstanced&&c.vertexAttribDivisor(e.attrPosition,0)})}},{key:"_updateIndexBuffer",value:function(){this._hasIndexBufferChanged||(this.iBuffer||(this.iBuffer=c.createBuffer()),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.iBuffer),c.bufferData(c.ELEMENT_ARRAY_BUFFER,this._indices,this._drawType),this.iBuffer.itemSize=1,this.iBuffer.numItems=this._numItems)}},{key:"computeNormals",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.generateFaces(),e?this._computeFaceNormals():this._computeVertexNormals()}},{key:"_computeFaceNormals",value:function(){for(var e=void 0,t=void 0,n=[],r=0;r<this._indices.length;r+=3){e=r/3;var i=(t=this._faces[e]).normal;n[t.indices[0]]=i,n[t.indices[1]]=i,n[t.indices[2]]=i}this.bufferNormal(n)}},{key:"_computeVertexNormals",value:function(){for(var e=void 0,t=u.vec3.create(),n=[],r=this.vertices,i=0;i<r.length;i++){u.vec3.set(t,0,0,0);for(var o=0;o<this._faces.length;o++)(e=this._faces[o]).indices.indexOf(i)>=0&&(t[0]+=e.normal[0],t[1]+=e.normal[1],t[2]+=e.normal[2]);u.vec3.normalize(t,t),n.push([t[0],t[1],t[2]])}this.bufferNormal(n)}},{key:"generateFaces",value:function(){for(var e=void 0,t=void 0,n=void 0,r=void 0,i=void 0,o=void 0,a=(u.vec3.create(),u.vec3.create(),u.vec3.create(),this.vertices),s=0;s<this._indices.length;s+=3){e=this._indices[s],t=this._indices[s+1],n=this._indices[s+2],r=a[e],i=a[t],o=a[n];var l={indices:[e,t,n],vertices:[r,i,o]};this._faces.push(l)}}},{key:"getAttribute",value:function(e){return this._attributes.find(function(t){return t.name===e})}},{key:"getSource",value:function(e){var t=this.getAttribute(e);return t?t.source:[]}},{key:"vertices",get:function(){return this.getSource("aVertexPosition")}},{key:"normals",get:function(){return this.getSource("aNormal")}},{key:"coords",get:function(){return this.getSource("aTextureCoord")}},{key:"indices",get:function(){return this._indices}},{key:"vertexSize",get:function(){return this.vertices.length}},{key:"faces",get:function(){return this._faces}},{key:"attributes",get:function(){return this._attributes}},{key:"hasVAO",get:function(){return this._hasVAO}},{key:"vao",get:function(){return this._vao}},{key:"numInstance",get:function(){return this._numInstance}},{key:"isInstanced",get:function(){return this._isInstanced}}]),e}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=(r=o)&&r.__esModule?r:{default:r},u=function(){function e(t,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._mesh=t,this._shader=n}return i(e,[{key:"draw",value:function(){this._shader.bind(),a.default.draw(this.mesh)}},{key:"mesh",get:function(){return this._mesh}},{key:"shader",get:function(){return this._shader}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(5),o=(r=i)&&r.__esModule?r:{default:r},a={},u=void 0;a.plane=function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"xy",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,a=[],u=[],s=[],l=[],c=e/n,f=t/n,h=1/n,d=.5*-e,_=.5*-t,v=0,p=0;p<n;p++)for(var m=0;m<n;m++){var E=c*p+d,T=f*m+_,b=p/n,g=m/n;"xz"===r?(a.push([E,0,T+f]),a.push([E+c,0,T+f]),a.push([E+c,0,T]),a.push([E,0,T]),u.push([b,1-(g+h)]),u.push([b+h,1-(g+h)]),u.push([b+h,1-g]),u.push([b,1-g]),l.push([0,1,0]),l.push([0,1,0]),l.push([0,1,0]),l.push([0,1,0])):"yz"===r?(a.push([0,T,E]),a.push([0,T,E+c]),a.push([0,T+f,E+c]),a.push([0,T+f,E]),u.push([b,g]),u.push([b+h,g]),u.push([b+h,g+h]),u.push([b,g+h]),l.push([1,0,0]),l.push([1,0,0]),l.push([1,0,0]),l.push([1,0,0])):(a.push([E,T,0]),a.push([E+c,T,0]),a.push([E+c,T+f,0]),a.push([E,T+f,0]),u.push([b,g]),u.push([b+h,g]),u.push([b+h,g+h]),u.push([b,g+h]),l.push([0,0,1]),l.push([0,0,1]),l.push([0,0,1]),l.push([0,0,1])),s.push(4*v+0),s.push(4*v+1),s.push(4*v+2),s.push(4*v+0),s.push(4*v+2),s.push(4*v+3),v++}var y=new o.default(i);return y.bufferVertex(a),y.bufferTexCoord(u),y.bufferIndex(s),y.bufferNormal(l),y},a.sphere=function(e,t){function n(n,r){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=n/t*Math.PI-.5*Math.PI,a=r/t*Math.PI*2,u=i?1:e,s=[];s[1]=Math.sin(o)*u;var l=Math.cos(o)*u;return s[0]=Math.cos(a)*l,s[2]=Math.sin(a)*l,s[0]=Math.floor(1e4*s[0])/1e4,s[1]=Math.floor(1e4*s[1])/1e4,s[2]=Math.floor(1e4*s[2])/1e4,s}for(var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,a=[],u=[],s=[],l=[],c=1/t,f=0,h=0;h<t;h++)for(var d=0;d<t;d++){a.push(n(h,d)),a.push(n(h+1,d)),a.push(n(h+1,d+1)),a.push(n(h,d+1)),l.push(n(h,d,!0)),l.push(n(h+1,d,!0)),l.push(n(h+1,d+1,!0)),l.push(n(h,d+1,!0));var _=d/t,v=h/t;u.push([1-_,v]),u.push([1-_,v+c]),u.push([1-_-c,v+c]),u.push([1-_-c,v]),s.push(4*f+0),s.push(4*f+1),s.push(4*f+2),s.push(4*f+0),s.push(4*f+2),s.push(4*f+3),f++}r&&s.reverse();var p=new o.default(i);return p.bufferVertex(a),p.bufferTexCoord(u),p.bufferIndex(s),p.bufferNormal(l),p},a.cube=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,i=e/2,a=(t=t||e)/2,u=(n=n||e)/2,s=[],l=[],c=[],f=[],h=0;s.push([-i,a,-u]),s.push([i,a,-u]),s.push([i,-a,-u]),s.push([-i,-a,-u]),f.push([0,0,-1]),f.push([0,0,-1]),f.push([0,0,-1]),f.push([0,0,-1]),l.push([0,0]),l.push([1,0]),l.push([1,1]),l.push([0,1]),c.push(4*h+0),c.push(4*h+1),c.push(4*h+2),c.push(4*h+0),c.push(4*h+2),c.push(4*h+3),h++,s.push([i,a,-u]),s.push([i,a,u]),s.push([i,-a,u]),s.push([i,-a,-u]),f.push([1,0,0]),f.push([1,0,0]),f.push([1,0,0]),f.push([1,0,0]),l.push([0,0]),l.push([1,0]),l.push([1,1]),l.push([0,1]),c.push(4*h+0),c.push(4*h+1),c.push(4*h+2),c.push(4*h+0),c.push(4*h+2),c.push(4*h+3),h++,s.push([i,a,u]),s.push([-i,a,u]),s.push([-i,-a,u]),s.push([i,-a,u]),f.push([0,0,1]),f.push([0,0,1]),f.push([0,0,1]),f.push([0,0,1]),l.push([0,0]),l.push([1,0]),l.push([1,1]),l.push([0,1]),c.push(4*h+0),c.push(4*h+1),c.push(4*h+2),c.push(4*h+0),c.push(4*h+2),c.push(4*h+3),h++,s.push([-i,a,u]),s.push([-i,a,-u]),s.push([-i,-a,-u]),s.push([-i,-a,u]),f.push([-1,0,0]),f.push([-1,0,0]),f.push([-1,0,0]),f.push([-1,0,0]),l.push([0,0]),l.push([1,0]),l.push([1,1]),l.push([0,1]),c.push(4*h+0),c.push(4*h+1),c.push(4*h+2),c.push(4*h+0),c.push(4*h+2),c.push(4*h+3),h++,s.push([i,a,-u]),s.push([-i,a,-u]),s.push([-i,a,u]),s.push([i,a,u]),f.push([0,1,0]),f.push([0,1,0]),f.push([0,1,0]),f.push([0,1,0]),l.push([0,0]),l.push([1,0]),l.push([1,1]),l.push([0,1]),c.push(4*h+0),c.push(4*h+1),c.push(4*h+2),c.push(4*h+0),c.push(4*h+2),c.push(4*h+3),h++,s.push([i,-a,u]),s.push([-i,-a,u]),s.push([-i,-a,-u]),s.push([i,-a,-u]),f.push([0,-1,0]),f.push([0,-1,0]),f.push([0,-1,0]),f.push([0,-1,0]),l.push([0,0]),l.push([1,0]),l.push([1,1]),l.push([0,1]),c.push(4*h+0),c.push(4*h+1),c.push(4*h+2),c.push(4*h+0),c.push(4*h+2),c.push(4*h+3),h++;var d=new o.default(r);return d.bufferVertex(s),d.bufferTexCoord(l),d.bufferIndex(c),d.bufferNormal(f),d},a.skybox=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=[],r=[],i=[],a=[],u=0;n.push([e,e,-e]),n.push([-e,e,-e]),n.push([-e,-e,-e]),n.push([e,-e,-e]),a.push([0,0,-1]),a.push([0,0,-1]),a.push([0,0,-1]),a.push([0,0,-1]),r.push([0,0]),r.push([1,0]),r.push([1,1]),r.push([0,1]),i.push(4*u+0),i.push(4*u+1),i.push(4*u+2),i.push(4*u+0),i.push(4*u+2),i.push(4*u+3),u++,n.push([e,-e,-e]),n.push([e,-e,e]),n.push([e,e,e]),n.push([e,e,-e]),a.push([1,0,0]),a.push([1,0,0]),a.push([1,0,0]),a.push([1,0,0]),r.push([0,0]),r.push([1,0]),r.push([1,1]),r.push([0,1]),i.push(4*u+0),i.push(4*u+1),i.push(4*u+2),i.push(4*u+0),i.push(4*u+2),i.push(4*u+3),u++,n.push([-e,e,e]),n.push([e,e,e]),n.push([e,-e,e]),n.push([-e,-e,e]),a.push([0,0,1]),a.push([0,0,1]),a.push([0,0,1]),a.push([0,0,1]),r.push([0,0]),r.push([1,0]),r.push([1,1]),r.push([0,1]),i.push(4*u+0),i.push(4*u+1),i.push(4*u+2),i.push(4*u+0),i.push(4*u+2),i.push(4*u+3),u++,n.push([-e,-e,e]),n.push([-e,-e,-e]),n.push([-e,e,-e]),n.push([-e,e,e]),a.push([-1,0,0]),a.push([-1,0,0]),a.push([-1,0,0]),a.push([-1,0,0]),r.push([0,0]),r.push([1,0]),r.push([1,1]),r.push([0,1]),i.push(4*u+0),i.push(4*u+1),i.push(4*u+2),i.push(4*u+0),i.push(4*u+2),i.push(4*u+3),u++,n.push([e,e,e]),n.push([-e,e,e]),n.push([-e,e,-e]),n.push([e,e,-e]),a.push([0,1,0]),a.push([0,1,0]),a.push([0,1,0]),a.push([0,1,0]),r.push([0,0]),r.push([1,0]),r.push([1,1]),r.push([0,1]),i.push(4*u+0),i.push(4*u+1),i.push(4*u+2),i.push(4*u+0),i.push(4*u+2),i.push(4*u+3),u++,n.push([e,-e,-e]),n.push([-e,-e,-e]),n.push([-e,-e,e]),n.push([e,-e,e]),a.push([0,-1,0]),a.push([0,-1,0]),a.push([0,-1,0]),a.push([0,-1,0]),r.push([0,0]),r.push([1,0]),r.push([1,1]),r.push([0,1]),i.push(4*u+0),i.push(4*u+1),i.push(4*u+2),i.push(4*u+0),i.push(4*u+2),i.push(4*u+3);var s=new o.default(t);return s.bufferVertex(n),s.bufferTexCoord(r),s.bufferIndex(i),s.bufferNormal(a),s},a.bigTriangle=function(){return u||((u=new o.default).bufferData([[-1,-1],[-1,4],[4,-1]],"aPosition",2),u.bufferIndex([2,1,0])),u},t.default=a},function(e,t,n){"use strict";e.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6403:"RED",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33321:"R8",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},function(e,t){e.exports="// basic.vert\n\n#define SHADER_NAME BASIC_VERTEX\n\nprecision highp float;\n#define GLSLIFY 1\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vNormal;\n\nvoid main(void) {\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n    vNormal = aNormal;\n}"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(4),a=(r=o)&&r.__esModule?r:{default:r},u=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.easing=r,this._value=t,this._targetValue=t,this._efIndex=a.default.addEF(function(){return n._update()})}return i(e,[{key:"_update",value:function(){this._checkLimit(),this._value+=(this._targetValue-this._value)*this.easing,Math.abs(this._targetValue-this._value)<1e-4&&(this._value=this._targetValue)}},{key:"setTo",value:function(e){this._targetValue=this._value=e}},{key:"add",value:function(e){this._targetValue+=e}},{key:"limit",value:function(e,t){e>t?this.limit(t,e):(this._min=e,this._max=t,this._checkLimit())}},{key:"_checkLimit",value:function(){void 0!==this._min&&this._targetValue<this._min&&(this._targetValue=this._min),void 0!==this._max&&this._targetValue>this._max&&(this._targetValue=this._max)}},{key:"destroy",value:function(){a.default.removeEF(this._efIndex)}},{key:"value",set:function(e){this._targetValue=e},get:function(){return this._value}},{key:"targetValue",get:function(){return this._targetValue}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),o=i.vec3.create(),a=i.vec3.create(),u=i.vec3.create(),s=i.vec3.create(),l=i.vec3.create(),c=i.vec3.create(),f=i.vec3.create(),h=i.vec3.create(),d=function(){function e(t,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.origin=i.vec3.clone(t),this.direction=i.vec3.clone(n)}return r(e,[{key:"at",value:function(e){return i.vec3.copy(s,this.direction),i.vec3.scale(s,s,e),i.vec3.add(s,s,this.origin),s}},{key:"lookAt",value:function(e){i.vec3.sub(this.direction,e,this.origin),i.vec3.normalize(this.origin,this.origin)}},{key:"closestPointToPoint",value:function(e){var t=i.vec3.create();i.vec3.sub(e,this.origin);var n=i.vec3.dot(t,this.direction);return n<0?i.vec3.clone(this.origin):(i.vec3.copy(t,this.direction),i.vec3.scale(t,t,n),i.vec3.add(t,t,this.origin),t)}},{key:"distanceToPoint",value:function(e){return Math.sqrt(this.distanceSqToPoint(e))}},{key:"distanceSqToPoint",value:function(e){var t=i.vec3.create();i.vec3.sub(t,e,this.origin);var n=i.vec3.dot(t,this.direction);return n<0?i.vec3.squaredDistance(this.origin,e):(i.vec3.copy(t,this.direction),i.vec3.scale(t,t,n),i.vec3.add(t,t,this.origin),i.vec3.squaredDistance(t,e))}},{key:"intersectsSphere",value:function(e,t){return this.distanceToPoint(e)<=t}},{key:"intersectSphere",value:function(e,t){var n=i.vec3.create();i.vec3.sub(n,e,this.origin);var r=i.vec3.dot(n,this.direction),o=i.vec3.dot(n,n)-r*r,a=t*t;if(o>a)return null;var u=Math.sqrt(a-o),s=r-u,l=r+u;return s<0&&l<0?null:s<0?this.at(l):this.at(s)}},{key:"distanceToPlane",value:function(e,t){i.vec3.dot(t,this.direction)}},{key:"intersectTriangle",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];i.vec3.copy(o,e),i.vec3.copy(a,t),i.vec3.copy(u,n),i.vec3.sub(l,a,o),i.vec3.sub(c,u,o),i.vec3.cross(f,l,c);var s=i.vec3.dot(this.direction,f),d=void 0;if(s>0){if(r)return null;d=1}else{if(!(s<0))return null;d=-1,s=-s}i.vec3.sub(h,this.origin,o),i.vec3.cross(c,h,c);var _=d*i.vec3.dot(this.direction,c);if(_<0)return null;i.vec3.cross(l,l,h);var v=d*i.vec3.dot(this.direction,l);if(v<0)return null;if(_+v>s)return null;var p=-d*i.vec3.dot(h,f);return p<0?null:this.at(p/s)}}]),e}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),o=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._matrix=i.mat4.create(),this._quat=i.quat.create(),this._orientation=i.mat4.create(),this._projection=i.mat4.create(),this.position=vec3.create()}return r(e,[{key:"lookAt",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,1,0];this._eye=vec3.clone(e),this._center=vec3.clone(t),vec3.copy(this.position,e),i.mat4.identity(this._matrix),i.mat4.lookAt(this._matrix,e,t,n)}},{key:"setFromOrientation",value:function(e,t,n,r){i.quat.set(this._quat,e,t,n,r),i.mat4.fromQuat(this._orientation,this._quat),i.mat4.translate(this._matrix,this._orientation,this.positionOffset)}},{key:"setProjection",value:function(e){this._projection=i.mat4.clone(e)}},{key:"setView",value:function(e){this._matrix=i.mat4.clone(e)}},{key:"setFromViewProj",value:function(e,t){this.setView(e),this.setProjection(t)}},{key:"matrix",get:function(){return this._matrix}},{key:"viewMatrix",get:function(){return this._matrix}},{key:"projection",get:function(){return this._projection}},{key:"projectionMatrix",get:function(){return this._projection}},{key:"eye",get:function(){return this._eye}},{key:"center",get:function(){return this._center}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(12),a=r(o),u=n(11),s=r(u),l=n(2),c=l.mat4.create(),f=l.vec3.create(),h=function(e){function t(e,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e&&o.setPerspective(e,n,r,i),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"setPerspective",value:function(e,t,n,r){this._fov=e,this._near=n,this._far=r,this._aspectRatio=t,l.mat4.perspective(this._projection,e,t,n,r)}},{key:"setAspectRatio",value:function(e){this._aspectRatio=e,l.mat4.perspective(this.projection,this._fov,e,this._near,this._far)}},{key:"generateRay",value:function(e,t){var n=this.projectionMatrix,r=this.viewMatrix;return l.mat4.multiply(c,n,r),l.mat4.invert(c,c),l.vec3.transformMat4(f,e,c),l.vec3.sub(f,f,this.position),l.vec3.normalize(f,f),t?(t.origin=this.position,t.direction=f):t=new s.default(this.position,f),t}}]),t}(a.default);t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._req=new XMLHttpRequest,this._req.addEventListener("load",function(e){return t._onLoaded(e)}),this._req.addEventListener("progress",function(e){return t._onProgress(e)}),n&&(this._req.responseType="arraybuffer")}return r(e,[{key:"load",value:function(e,t){console.log("Loading : ",e),this._callback=t,this._req.open("GET",e),this._req.send()}},{key:"_onLoaded",value:function(){this._callback(this._req.response)}},{key:"_onProgress",value:function(){}}]),e}();t.default=i},function(e,t){e.exports="// bigTriangle.vert\n\n#define SHADER_NAME BIG_TRIANGLE_VERTEX\n\nprecision mediump float;\n#define GLSLIFY 1\nattribute vec2 aPosition;\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    gl_Position = vec4(aPosition, 0.0, 1.0);\n    vTextureCoord = aPosition * .5 + .5;\n}"},function(e,t){e.exports="// copy.frag\n\n#define SHADER_NAME COPY_FRAGMENT\n\nprecision mediump float;\n#define GLSLIFY 1\n\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\n\nvoid main(void) {\n    gl_FragColor = texture2D(texture, vTextureCoord);\n}"},function(e,t){e.exports="// simpleColor.frag\n\n#define SHADER_NAME SIMPLE_COLOR\n\nprecision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 color;\nuniform float opacity;\n\nvoid main(void) {\n    gl_FragColor = vec4(color, opacity);\n}"},function(e,t,n){"use strict";function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],h=n[0],d=n[1],_=n[2],v=n[3],p=n[4],m=n[5],E=n[6],T=n[7],b=n[8];return e[0]=h*r+d*a+_*l,e[1]=h*i+d*u+_*c,e[2]=h*o+d*s+_*f,e[3]=v*r+p*a+m*l,e[4]=v*i+p*u+m*c,e[5]=v*o+p*s+m*f,e[6]=E*r+T*a+b*l,e[7]=E*i+T*u+b*c,e[8]=E*o+T*s+b*f,e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(9);return a.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},t.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},t.clone=function(e){var t=new a.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromValues=function(e,t,n,r,i,o,u,s,l){var c=new a.ARRAY_TYPE(9);return c[0]=e,c[1]=t,c[2]=n,c[3]=r,c[4]=i,c[5]=o,c[6]=u,c[7]=s,c[8]=l,c},t.set=function(e,t,n,r,i,o,a,u,s,l){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=u,e[7]=s,e[8]=l,e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},t.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],l=t[7],c=t[8],f=c*a-u*l,h=-c*o+u*s,d=l*o-a*s,_=n*f+r*h+i*d;return _?(_=1/_,e[0]=f*_,e[1]=(-c*r+i*l)*_,e[2]=(u*r-i*a)*_,e[3]=h*_,e[4]=(c*n-i*s)*_,e[5]=(-u*n+i*o)*_,e[6]=d*_,e[7]=(-l*n+r*s)*_,e[8]=(a*n-r*o)*_,e):null},t.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],l=t[7],c=t[8];return e[0]=a*c-u*l,e[1]=i*l-r*c,e[2]=r*u-i*a,e[3]=u*s-o*c,e[4]=n*c-i*s,e[5]=i*o-n*u,e[6]=o*l-a*s,e[7]=r*s-n*l,e[8]=n*a-r*o,e},t.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],u=e[6],s=e[7],l=e[8];return t*(l*o-a*s)+n*(-l*i+a*u)+r*(s*i-o*u)},t.multiply=r,t.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],h=n[0],d=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=u,e[5]=s,e[6]=h*r+d*a+l,e[7]=h*i+d*u+c,e[8]=h*o+d*s+f,e},t.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],h=Math.sin(n),d=Math.cos(n);return e[0]=d*r+h*a,e[1]=d*i+h*u,e[2]=d*o+h*s,e[3]=d*a-h*r,e[4]=d*u-h*i,e[5]=d*s-h*o,e[6]=l,e[7]=c,e[8]=f,e},t.scale=function(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},t.fromRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},t.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,u=r+r,s=i+i,l=n*a,c=r*a,f=r*u,h=i*a,d=i*u,_=i*s,v=o*a,p=o*u,m=o*s;return e[0]=1-f-_,e[3]=c-m,e[6]=h+p,e[1]=c+m,e[4]=1-l-_,e[7]=d-v,e[2]=h-p,e[5]=d+v,e[8]=1-l-f,e},t.normalFromMat4=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],l=t[7],c=t[8],f=t[9],h=t[10],d=t[11],_=t[12],v=t[13],p=t[14],m=t[15],E=n*u-r*a,T=n*s-i*a,b=n*l-o*a,g=r*s-i*u,y=r*l-o*u,x=i*l-o*s,M=c*v-f*_,R=c*p-h*_,A=c*m-d*_,w=f*p-h*v,P=f*m-d*v,L=h*m-d*p,S=E*L-T*P+b*w+g*A-y*R+x*M;return S?(S=1/S,e[0]=(u*L-s*P+l*w)*S,e[1]=(s*A-a*L-l*R)*S,e[2]=(a*P-u*A+l*M)*S,e[3]=(i*P-r*L-o*w)*S,e[4]=(n*L-i*A+o*R)*S,e[5]=(r*A-n*P-o*M)*S,e[6]=(v*x-p*y+m*g)*S,e[7]=(p*b-_*x-m*T)*S,e[8]=(_*y-v*b+m*E)*S,e):null},t.projection=function(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},t.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e},t.subtract=i,t.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e},t.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],u=e[4],s=e[5],l=e[6],c=e[7],f=e[8],h=t[0],d=t[1],_=t[2],v=t[3],p=t[4],m=t[5],E=t[6],T=t[7],b=t[8];return Math.abs(n-h)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(r-d)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(i-_)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-v)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(u-p)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))&&Math.abs(s-m)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(l-E)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(c-T)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(f-b)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(b))};var o=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o);t.mul=r,t.sub=i},function(e,t,n){"use strict";function r(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function i(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],h=t[9],d=t[10],_=t[11],v=t[12],p=t[13],m=t[14],E=t[15],T=n[0],b=n[1],g=n[2],y=n[3];return e[0]=T*r+b*u+g*f+y*v,e[1]=T*i+b*s+g*h+y*p,e[2]=T*o+b*l+g*d+y*m,e[3]=T*a+b*c+g*_+y*E,T=n[4],b=n[5],g=n[6],y=n[7],e[4]=T*r+b*u+g*f+y*v,e[5]=T*i+b*s+g*h+y*p,e[6]=T*o+b*l+g*d+y*m,e[7]=T*a+b*c+g*_+y*E,T=n[8],b=n[9],g=n[10],y=n[11],e[8]=T*r+b*u+g*f+y*v,e[9]=T*i+b*s+g*h+y*p,e[10]=T*o+b*l+g*d+y*m,e[11]=T*a+b*c+g*_+y*E,T=n[12],b=n[13],g=n[14],y=n[15],e[12]=T*r+b*u+g*f+y*v,e[13]=T*i+b*s+g*h+y*p,e[14]=T*o+b*l+g*d+y*m,e[15]=T*a+b*c+g*_+y*E,e}function o(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=r+r,s=i+i,l=o+o,c=r*u,f=r*s,h=r*l,d=i*s,_=i*l,v=o*l,p=a*u,m=a*s,E=a*l;return e[0]=1-(d+v),e[1]=f+E,e[2]=h-m,e[3]=0,e[4]=f-E,e[5]=1-(c+v),e[6]=_+p,e[7]=0,e[8]=h+m,e[9]=_-p,e[10]=1-(c+d),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function a(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new s.ARRAY_TYPE(16);return s.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},t.clone=function(e){var t=new s.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.fromValues=function(e,t,n,r,i,o,a,u,l,c,f,h,d,_,v,p){var m=new s.ARRAY_TYPE(16);return m[0]=e,m[1]=t,m[2]=n,m[3]=r,m[4]=i,m[5]=o,m[6]=a,m[7]=u,m[8]=l,m[9]=c,m[10]=f,m[11]=h,m[12]=d,m[13]=_,m[14]=v,m[15]=p,m},t.set=function(e,t,n,r,i,o,a,u,s,l,c,f,h,d,_,v,p){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=u,e[7]=s,e[8]=l,e[9]=c,e[10]=f,e[11]=h,e[12]=d,e[13]=_,e[14]=v,e[15]=p,e},t.identity=r,t.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],o=t[6],a=t[7],u=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=u}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},t.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],l=t[7],c=t[8],f=t[9],h=t[10],d=t[11],_=t[12],v=t[13],p=t[14],m=t[15],E=n*u-r*a,T=n*s-i*a,b=n*l-o*a,g=r*s-i*u,y=r*l-o*u,x=i*l-o*s,M=c*v-f*_,R=c*p-h*_,A=c*m-d*_,w=f*p-h*v,P=f*m-d*v,L=h*m-d*p,S=E*L-T*P+b*w+g*A-y*R+x*M;return S?(S=1/S,e[0]=(u*L-s*P+l*w)*S,e[1]=(i*P-r*L-o*w)*S,e[2]=(v*x-p*y+m*g)*S,e[3]=(h*y-f*x-d*g)*S,e[4]=(s*A-a*L-l*R)*S,e[5]=(n*L-i*A+o*R)*S,e[6]=(p*b-_*x-m*T)*S,e[7]=(c*x-h*b+d*T)*S,e[8]=(a*P-u*A+l*M)*S,e[9]=(r*A-n*P-o*M)*S,e[10]=(_*y-v*b+m*E)*S,e[11]=(f*b-c*y-d*E)*S,e[12]=(u*R-a*w-s*M)*S,e[13]=(n*w-r*R+i*M)*S,e[14]=(v*T-_*g-p*E)*S,e[15]=(c*g-f*T+h*E)*S,e):null},t.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],l=t[7],c=t[8],f=t[9],h=t[10],d=t[11],_=t[12],v=t[13],p=t[14],m=t[15];return e[0]=u*(h*m-d*p)-f*(s*m-l*p)+v*(s*d-l*h),e[1]=-(r*(h*m-d*p)-f*(i*m-o*p)+v*(i*d-o*h)),e[2]=r*(s*m-l*p)-u*(i*m-o*p)+v*(i*l-o*s),e[3]=-(r*(s*d-l*h)-u*(i*d-o*h)+f*(i*l-o*s)),e[4]=-(a*(h*m-d*p)-c*(s*m-l*p)+_*(s*d-l*h)),e[5]=n*(h*m-d*p)-c*(i*m-o*p)+_*(i*d-o*h),e[6]=-(n*(s*m-l*p)-a*(i*m-o*p)+_*(i*l-o*s)),e[7]=n*(s*d-l*h)-a*(i*d-o*h)+c*(i*l-o*s),e[8]=a*(f*m-d*v)-c*(u*m-l*v)+_*(u*d-l*f),e[9]=-(n*(f*m-d*v)-c*(r*m-o*v)+_*(r*d-o*f)),e[10]=n*(u*m-l*v)-a*(r*m-o*v)+_*(r*l-o*u),e[11]=-(n*(u*d-l*f)-a*(r*d-o*f)+c*(r*l-o*u)),e[12]=-(a*(f*p-h*v)-c*(u*p-s*v)+_*(u*h-s*f)),e[13]=n*(f*p-h*v)-c*(r*p-i*v)+_*(r*h-i*f),e[14]=-(n*(u*p-s*v)-a*(r*p-i*v)+_*(r*s-i*u)),e[15]=n*(u*h-s*f)-a*(r*h-i*f)+c*(r*s-i*u),e},t.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],u=e[6],s=e[7],l=e[8],c=e[9],f=e[10],h=e[11],d=e[12],_=e[13],v=e[14],p=e[15];return(t*a-n*o)*(f*p-h*v)-(t*u-r*o)*(c*p-h*_)+(t*s-i*o)*(c*v-f*_)+(n*u-r*a)*(l*p-h*d)-(n*s-i*a)*(l*v-f*d)+(r*s-i*u)*(l*_-c*d)},t.multiply=i,t.translate=function(e,t,n){var r=n[0],i=n[1],o=n[2],a=void 0,u=void 0,s=void 0,l=void 0,c=void 0,f=void 0,h=void 0,d=void 0,_=void 0,v=void 0,p=void 0,m=void 0;return t===e?(e[12]=t[0]*r+t[4]*i+t[8]*o+t[12],e[13]=t[1]*r+t[5]*i+t[9]*o+t[13],e[14]=t[2]*r+t[6]*i+t[10]*o+t[14],e[15]=t[3]*r+t[7]*i+t[11]*o+t[15]):(a=t[0],u=t[1],s=t[2],l=t[3],c=t[4],f=t[5],h=t[6],d=t[7],_=t[8],v=t[9],p=t[10],m=t[11],e[0]=a,e[1]=u,e[2]=s,e[3]=l,e[4]=c,e[5]=f,e[6]=h,e[7]=d,e[8]=_,e[9]=v,e[10]=p,e[11]=m,e[12]=a*r+c*i+_*o+t[12],e[13]=u*r+f*i+v*o+t[13],e[14]=s*r+h*i+p*o+t[14],e[15]=l*r+d*i+m*o+t[15]),e},t.scale=function(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.rotate=function(e,t,n,r){var i=r[0],o=r[1],a=r[2],u=Math.sqrt(i*i+o*o+a*a),l=void 0,c=void 0,f=void 0,h=void 0,d=void 0,_=void 0,v=void 0,p=void 0,m=void 0,E=void 0,T=void 0,b=void 0,g=void 0,y=void 0,x=void 0,M=void 0,R=void 0,A=void 0,w=void 0,P=void 0,L=void 0,S=void 0,O=void 0,C=void 0;return u<s.EPSILON?null:(i*=u=1/u,o*=u,a*=u,l=Math.sin(n),c=Math.cos(n),f=1-c,h=t[0],d=t[1],_=t[2],v=t[3],p=t[4],m=t[5],E=t[6],T=t[7],b=t[8],g=t[9],y=t[10],x=t[11],M=i*i*f+c,R=o*i*f+a*l,A=a*i*f-o*l,w=i*o*f-a*l,P=o*o*f+c,L=a*o*f+i*l,S=i*a*f+o*l,O=o*a*f-i*l,C=a*a*f+c,e[0]=h*M+p*R+b*A,e[1]=d*M+m*R+g*A,e[2]=_*M+E*R+y*A,e[3]=v*M+T*R+x*A,e[4]=h*w+p*P+b*L,e[5]=d*w+m*P+g*L,e[6]=_*w+E*P+y*L,e[7]=v*w+T*P+x*L,e[8]=h*S+p*O+b*C,e[9]=d*S+m*O+g*C,e[10]=_*S+E*O+y*C,e[11]=v*S+T*O+x*C,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},t.rotateX=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],a=t[5],u=t[6],s=t[7],l=t[8],c=t[9],f=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+l*r,e[5]=a*i+c*r,e[6]=u*i+f*r,e[7]=s*i+h*r,e[8]=l*i-o*r,e[9]=c*i-a*r,e[10]=f*i-u*r,e[11]=h*i-s*r,e},t.rotateY=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],u=t[2],s=t[3],l=t[8],c=t[9],f=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-l*r,e[1]=a*i-c*r,e[2]=u*i-f*r,e[3]=s*i-h*r,e[8]=o*r+l*i,e[9]=a*r+c*i,e[10]=u*r+f*i,e[11]=s*r+h*i,e},t.rotateZ=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],u=t[2],s=t[3],l=t[4],c=t[5],f=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+l*r,e[1]=a*i+c*r,e[2]=u*i+f*r,e[3]=s*i+h*r,e[4]=l*i-o*r,e[5]=c*i-a*r,e[6]=f*i-u*r,e[7]=h*i-s*r,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotation=function(e,t,n){var r=n[0],i=n[1],o=n[2],a=Math.sqrt(r*r+i*i+o*o),u=void 0,l=void 0,c=void 0;return a<s.EPSILON?null:(r*=a=1/a,i*=a,o*=a,u=Math.sin(t),l=Math.cos(t),c=1-l,e[0]=r*r*c+l,e[1]=i*r*c+o*u,e[2]=o*r*c-i*u,e[3]=0,e[4]=r*i*c-o*u,e[5]=i*i*c+l,e[6]=o*i*c+r*u,e[7]=0,e[8]=r*o*c+i*u,e[9]=i*o*c-r*u,e[10]=o*o*c+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},t.fromXRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromYRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromZRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotationTranslation=o,t.fromQuat2=function(e,t){var n=new s.ARRAY_TYPE(3),r=-t[0],i=-t[1],a=-t[2],u=t[3],l=t[4],c=t[5],f=t[6],h=t[7],d=r*r+i*i+a*a+u*u;return d>0?(n[0]=2*(l*u+h*r+c*a-f*i)/d,n[1]=2*(c*u+h*i+f*r-l*a)/d,n[2]=2*(f*u+h*a+l*i-c*r)/d):(n[0]=2*(l*u+h*r+c*a-f*i),n[1]=2*(c*u+h*i+f*r-l*a),n[2]=2*(f*u+h*a+l*i-c*r)),o(e,t,n),e},t.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},t.getScaling=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[4],a=t[5],u=t[6],s=t[8],l=t[9],c=t[10];return e[0]=Math.sqrt(n*n+r*r+i*i),e[1]=Math.sqrt(o*o+a*a+u*u),e[2]=Math.sqrt(s*s+l*l+c*c),e},t.getRotation=function(e,t){var n=t[0]+t[5]+t[10],r=0;return n>0?(r=2*Math.sqrt(n+1),e[3]=.25*r,e[0]=(t[6]-t[9])/r,e[1]=(t[8]-t[2])/r,e[2]=(t[1]-t[4])/r):t[0]>t[5]&&t[0]>t[10]?(r=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/r,e[0]=.25*r,e[1]=(t[1]+t[4])/r,e[2]=(t[8]+t[2])/r):t[5]>t[10]?(r=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/r,e[0]=(t[1]+t[4])/r,e[1]=.25*r,e[2]=(t[6]+t[9])/r):(r=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/r,e[0]=(t[8]+t[2])/r,e[1]=(t[6]+t[9])/r,e[2]=.25*r),e},t.fromRotationTranslationScale=function(e,t,n,r){var i=t[0],o=t[1],a=t[2],u=t[3],s=i+i,l=o+o,c=a+a,f=i*s,h=i*l,d=i*c,_=o*l,v=o*c,p=a*c,m=u*s,E=u*l,T=u*c,b=r[0],g=r[1],y=r[2];return e[0]=(1-(_+p))*b,e[1]=(h+T)*b,e[2]=(d-E)*b,e[3]=0,e[4]=(h-T)*g,e[5]=(1-(f+p))*g,e[6]=(v+m)*g,e[7]=0,e[8]=(d+E)*y,e[9]=(v-m)*y,e[10]=(1-(f+_))*y,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},t.fromRotationTranslationScaleOrigin=function(e,t,n,r,i){var o=t[0],a=t[1],u=t[2],s=t[3],l=o+o,c=a+a,f=u+u,h=o*l,d=o*c,_=o*f,v=a*c,p=a*f,m=u*f,E=s*l,T=s*c,b=s*f,g=r[0],y=r[1],x=r[2],M=i[0],R=i[1],A=i[2],w=(1-(v+m))*g,P=(d+b)*g,L=(_-T)*g,S=(d-b)*y,O=(1-(h+m))*y,C=(p+E)*y,I=(_+T)*x,N=(p-E)*x,F=(1-(h+v))*x;return e[0]=w,e[1]=P,e[2]=L,e[3]=0,e[4]=S,e[5]=O,e[6]=C,e[7]=0,e[8]=I,e[9]=N,e[10]=F,e[11]=0,e[12]=n[0]+M-(w*M+S*R+I*A),e[13]=n[1]+R-(P*M+O*R+N*A),e[14]=n[2]+A-(L*M+C*R+F*A),e[15]=1,e},t.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,u=r+r,s=i+i,l=n*a,c=r*a,f=r*u,h=i*a,d=i*u,_=i*s,v=o*a,p=o*u,m=o*s;return e[0]=1-f-_,e[1]=c+m,e[2]=h-p,e[3]=0,e[4]=c-m,e[5]=1-l-_,e[6]=d+v,e[7]=0,e[8]=h+p,e[9]=d-v,e[10]=1-l-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.frustum=function(e,t,n,r,i,o,a){var u=1/(n-t),s=1/(i-r),l=1/(o-a);return e[0]=2*o*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*s,e[6]=0,e[7]=0,e[8]=(n+t)*u,e[9]=(i+r)*s,e[10]=(a+o)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*l,e[15]=0,e},t.perspective=function(e,t,n,r,i){var o=1/Math.tan(t/2),a=void 0;return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(a=1/(r-i),e[10]=(i+r)*a,e[14]=2*i*r*a):(e[10]=-1,e[14]=-2*r),e},t.perspectiveFromFieldOfView=function(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),u=Math.tan(t.rightDegrees*Math.PI/180),s=2/(a+u),l=2/(i+o);return e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-(a-u)*s*.5,e[9]=(i-o)*l*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e},t.ortho=function(e,t,n,r,i,o,a){var u=1/(t-n),s=1/(r-i),l=1/(o-a);return e[0]=-2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+n)*u,e[13]=(i+r)*s,e[14]=(a+o)*l,e[15]=1,e},t.lookAt=function(e,t,n,i){var o=void 0,a=void 0,u=void 0,l=void 0,c=void 0,f=void 0,h=void 0,d=void 0,_=void 0,v=void 0,p=t[0],m=t[1],E=t[2],T=i[0],b=i[1],g=i[2],y=n[0],x=n[1],M=n[2];return Math.abs(p-y)<s.EPSILON&&Math.abs(m-x)<s.EPSILON&&Math.abs(E-M)<s.EPSILON?r(e):(h=p-y,d=m-x,_=E-M,v=1/Math.sqrt(h*h+d*d+_*_),o=b*(_*=v)-g*(d*=v),a=g*(h*=v)-T*_,u=T*d-b*h,(v=Math.sqrt(o*o+a*a+u*u))?(o*=v=1/v,a*=v,u*=v):(o=0,a=0,u=0),l=d*u-_*a,c=_*o-h*u,f=h*a-d*o,(v=Math.sqrt(l*l+c*c+f*f))?(l*=v=1/v,c*=v,f*=v):(l=0,c=0,f=0),e[0]=o,e[1]=l,e[2]=h,e[3]=0,e[4]=a,e[5]=c,e[6]=d,e[7]=0,e[8]=u,e[9]=f,e[10]=_,e[11]=0,e[12]=-(o*p+a*m+u*E),e[13]=-(l*p+c*m+f*E),e[14]=-(h*p+d*m+_*E),e[15]=1,e)},t.targetTo=function(e,t,n,r){var i=t[0],o=t[1],a=t[2],u=r[0],s=r[1],l=r[2],c=i-n[0],f=o-n[1],h=a-n[2],d=c*c+f*f+h*h;d>0&&(d=1/Math.sqrt(d),c*=d,f*=d,h*=d);var _=s*h-l*f,v=l*c-u*h,p=u*f-s*c;return(d=_*_+v*v+p*p)>0&&(d=1/Math.sqrt(d),_*=d,v*=d,p*=d),e[0]=_,e[1]=v,e[2]=p,e[3]=0,e[4]=f*p-h*v,e[5]=h*_-c*p,e[6]=c*v-f*_,e[7]=0,e[8]=c,e[9]=f,e[10]=h,e[11]=0,e[12]=i,e[13]=o,e[14]=a,e[15]=1,e},t.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e},t.subtract=a,t.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e},t.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],l=e[6],c=e[7],f=e[8],h=e[9],d=e[10],_=e[11],v=e[12],p=e[13],m=e[14],E=e[15],T=t[0],b=t[1],g=t[2],y=t[3],x=t[4],M=t[5],R=t[6],A=t[7],w=t[8],P=t[9],L=t[10],S=t[11],O=t[12],C=t[13],I=t[14],N=t[15];return Math.abs(n-T)<=s.EPSILON*Math.max(1,Math.abs(n),Math.abs(T))&&Math.abs(r-b)<=s.EPSILON*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-g)<=s.EPSILON*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(o-y)<=s.EPSILON*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(a-x)<=s.EPSILON*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(u-M)<=s.EPSILON*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(l-R)<=s.EPSILON*Math.max(1,Math.abs(l),Math.abs(R))&&Math.abs(c-A)<=s.EPSILON*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(f-w)<=s.EPSILON*Math.max(1,Math.abs(f),Math.abs(w))&&Math.abs(h-P)<=s.EPSILON*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(d-L)<=s.EPSILON*Math.max(1,Math.abs(d),Math.abs(L))&&Math.abs(_-S)<=s.EPSILON*Math.max(1,Math.abs(_),Math.abs(S))&&Math.abs(v-O)<=s.EPSILON*Math.max(1,Math.abs(v),Math.abs(O))&&Math.abs(p-C)<=s.EPSILON*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(m-I)<=s.EPSILON*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(E-N)<=s.EPSILON*Math.max(1,Math.abs(E),Math.abs(N))};var u=n(3),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(u);t.mul=i,t.sub=a},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(){var e=new p.ARRAY_TYPE(4);return p.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function o(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function a(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=n[0],s=n[1],l=n[2],c=n[3];return e[0]=r*c+a*u+i*l-o*s,e[1]=i*c+a*s+o*u-r*l,e[2]=o*c+a*l+r*s-i*u,e[3]=a*c-r*u-i*s-o*l,e}function u(e,t,n,r){var i=t[0],o=t[1],a=t[2],u=t[3],s=n[0],l=n[1],c=n[2],f=n[3],h=void 0,d=void 0,_=void 0,v=void 0,m=void 0;return(d=i*s+o*l+a*c+u*f)<0&&(d=-d,s=-s,l=-l,c=-c,f=-f),1-d>p.EPSILON?(h=Math.acos(d),_=Math.sin(h),v=Math.sin((1-r)*h)/_,m=Math.sin(r*h)/_):(v=1-r,m=r),e[0]=v*i+m*s,e[1]=v*o+m*l,e[2]=v*a+m*c,e[3]=v*u+m*f,e}function s(e,t){var n=t[0]+t[4]+t[8],r=void 0;if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;r=Math.sqrt(t[3*i+i]-t[3*o+o]-t[3*a+a]+1),e[i]=.5*r,r=.5/r,e[3]=(t[3*o+a]-t[3*a+o])*r,e[o]=(t[3*o+i]+t[3*i+o])*r,e[a]=(t[3*a+i]+t[3*i+a])*r}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.setAxes=t.sqlerp=t.rotationTo=t.equals=t.exactEquals=t.normalize=t.sqrLen=t.squaredLength=t.len=t.length=t.lerp=t.dot=t.scale=t.mul=t.add=t.set=t.copy=t.fromValues=t.clone=void 0,t.create=i,t.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},t.setAxisAngle=o,t.getAxisAngle=function(e,t){var n=2*Math.acos(t[3]),r=Math.sin(n/2);return r>p.EPSILON?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n},t.multiply=a,t.rotateX=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],u=Math.sin(n),s=Math.cos(n);return e[0]=r*s+a*u,e[1]=i*s+o*u,e[2]=o*s-i*u,e[3]=a*s-r*u,e},t.rotateY=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],u=Math.sin(n),s=Math.cos(n);return e[0]=r*s-o*u,e[1]=i*s+a*u,e[2]=o*s+r*u,e[3]=a*s-i*u,e},t.rotateZ=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],u=Math.sin(n),s=Math.cos(n);return e[0]=r*s+i*u,e[1]=i*s-r*u,e[2]=o*s+a*u,e[3]=a*s-o*u,e},t.calculateW=function(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e},t.slerp=u,t.random=function(e){var t=p.RANDOM(),n=p.RANDOM(),r=p.RANDOM(),i=Math.sqrt(1-t),o=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*n),e[1]=i*Math.cos(2*Math.PI*n),e[2]=o*Math.sin(2*Math.PI*r),e[3]=o*Math.cos(2*Math.PI*r),e},t.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o,u=a?1/a:0;return e[0]=-n*u,e[1]=-r*u,e[2]=-i*u,e[3]=o*u,e},t.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},t.fromMat3=s,t.fromEuler=function(e,t,n,r){var i=.5*Math.PI/180;t*=i,n*=i,r*=i;var o=Math.sin(t),a=Math.cos(t),u=Math.sin(n),s=Math.cos(n),l=Math.sin(r),c=Math.cos(r);return e[0]=o*s*c-a*u*l,e[1]=a*u*c+o*s*l,e[2]=a*s*l-o*u*c,e[3]=a*s*c+o*u*l,e},t.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"};var l,c,f,h,d,_,v=n(3),p=r(v),m=n(18),E=r(m),T=n(21),b=r(T),g=n(22),y=r(g),x=(t.clone=y.clone,t.fromValues=y.fromValues,t.copy=y.copy,t.set=y.set,t.add=y.add,t.mul=a,t.scale=y.scale,t.dot=y.dot,t.lerp=y.lerp,t.length=y.length),M=(t.len=x,t.squaredLength=y.squaredLength),R=(t.sqrLen=M,t.normalize=y.normalize);t.exactEquals=y.exactEquals,t.equals=y.equals,t.rotationTo=(h=b.create(),d=b.fromValues(1,0,0),_=b.fromValues(0,1,0),function(e,t,n){var r=b.dot(t,n);return r<-.999999?(b.cross(h,d,t),b.len(h)<1e-6&&b.cross(h,_,t),b.normalize(h,h),o(e,h,Math.PI),e):r>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(b.cross(h,t,n),e[0]=h[0],e[1]=h[1],e[2]=h[2],e[3]=1+r,R(e,e))}),t.sqlerp=(c=i(),f=i(),function(e,t,n,r,i,o){return u(c,t,i,o),u(f,n,r,o),u(e,c,f,2*o*(1-o)),e}),t.setAxes=(l=E.create(),function(e,t,n,r){return l[0]=n[0],l[3]=n[1],l[6]=n[2],l[1]=r[0],l[4]=r[1],l[7]=r[2],l[2]=-t[0],l[5]=-t[1],l[8]=-t[2],R(e,s(e,l))})},function(e,t,n){"use strict";function r(){var e=new p.ARRAY_TYPE(3);return p.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function i(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}function o(e,t,n){var r=new p.ARRAY_TYPE(3);return r[0]=e,r[1]=t,r[2]=n,r}function a(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function u(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function s(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function l(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}function c(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}function f(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function h(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e}function d(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=r,t.clone=function(e){var t=new p.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.length=i,t.fromValues=o,t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.set=function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e},t.subtract=a,t.multiply=u,t.divide=s,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},t.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e},t.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},t.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e},t.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e},t.distance=l,t.squaredDistance=c,t.squaredLength=f,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},t.normalize=h,t.dot=d,t.cross=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],u=n[1],s=n[2];return e[0]=i*s-o*u,e[1]=o*a-r*s,e[2]=r*u-i*a,e},t.lerp=function(e,t,n,r){var i=t[0],o=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e},t.hermite=function(e,t,n,r,i,o){var a=o*o,u=a*(2*o-3)+1,s=a*(o-2)+o,l=a*(o-1),c=a*(3-2*o);return e[0]=t[0]*u+n[0]*s+r[0]*l+i[0]*c,e[1]=t[1]*u+n[1]*s+r[1]*l+i[1]*c,e[2]=t[2]*u+n[2]*s+r[2]*l+i[2]*c,e},t.bezier=function(e,t,n,r,i,o){var a=1-o,u=a*a,s=o*o,l=u*a,c=3*o*u,f=3*s*a,h=s*o;return e[0]=t[0]*l+n[0]*c+r[0]*f+i[0]*h,e[1]=t[1]*l+n[1]*c+r[1]*f+i[1]*h,e[2]=t[2]*l+n[2]*c+r[2]*f+i[2]*h,e},t.random=function(e,t){t=t||1;var n=2*p.RANDOM()*Math.PI,r=2*p.RANDOM()-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e},t.transformMat4=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,e},t.transformMat3=function(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e},t.transformQuat=function(e,t,n){var r=n[0],i=n[1],o=n[2],a=n[3],u=t[0],s=t[1],l=t[2],c=i*l-o*s,f=o*u-r*l,h=r*s-i*u,d=i*h-o*f,_=o*c-r*h,v=r*f-i*c,p=2*a;return c*=p,f*=p,h*=p,d*=2,_*=2,v*=2,e[0]=u+c+d,e[1]=s+f+_,e[2]=l+h+v,e},t.rotateX=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},t.rotateY=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},t.rotateZ=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},t.angle=function(e,t){var n=o(e[0],e[1],e[2]),r=o(t[0],t[1],t[2]);h(n,n),h(r,r);var i=d(n,r);return i>1?0:i<-1?Math.PI:Math.acos(i)},t.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],o=t[0],a=t[1],u=t[2];return Math.abs(n-o)<=p.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=p.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-u)<=p.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))};var _,v=n(3),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(v);t.sub=a,t.mul=u,t.div=s,t.dist=l,t.sqrDist=c,t.len=i,t.sqrLen=f,t.forEach=(_=r(),function(e,t,n,r,i,o){var a=void 0,u=void 0;for(t||(t=3),n||(n=0),u=r?Math.min(r*t+n,e.length):e.length,a=n;a<u;a+=t)_[0]=e[a],_[1]=e[a+1],_[2]=e[a+2],i(_,_,o),e[a]=_[0],e[a+1]=_[1],e[a+2]=_[2];return e})},function(e,t,n){"use strict";function r(){var e=new d.ARRAY_TYPE(4);return d.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function o(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}function a(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}function u(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(n*n+r*r+i*i+o*o)}function s(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return n*n+r*r+i*i+o*o}function l(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)}function c(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=r,t.clone=function(e){var t=new d.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.fromValues=function(e,t,n,r){var i=new d.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.set=function(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},t.subtract=i,t.multiply=o,t.divide=a,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},t.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e},t.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},t.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},t.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e},t.distance=u,t.squaredDistance=s,t.length=l,t.squaredLength=c,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},t.normalize=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=n*a,e[1]=r*a,e[2]=i*a,e[3]=o*a),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},t.lerp=function(e,t,n,r){var i=t[0],o=t[1],a=t[2],u=t[3];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e[3]=u+r*(n[3]-u),e},t.random=function(e,t){var n,r,i,o,a,u;t=t||1;do{n=2*d.RANDOM()-1,r=2*d.RANDOM()-1,a=n*n+r*r}while(a>=1);do{i=2*d.RANDOM()-1,o=2*d.RANDOM()-1,u=i*i+o*o}while(u>=1);var s=Math.sqrt((1-a)/u);return e[0]=t*n,e[1]=t*r,e[2]=t*i*s,e[3]=t*o*s,e},t.transformMat4=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,e},t.transformQuat=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],u=n[1],s=n[2],l=n[3],c=l*r+u*o-s*i,f=l*i+s*r-a*o,h=l*o+a*i-u*r,d=-a*r-u*i-s*o;return e[0]=c*l+d*-a+f*-s-h*-u,e[1]=f*l+d*-u+h*-a-c*-s,e[2]=h*l+d*-s+c*-u-f*-a,e[3]=t[3],e},t.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],a=t[0],u=t[1],s=t[2],l=t[3];return Math.abs(n-a)<=d.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-u)<=d.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-s)<=d.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-l)<=d.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))};var f,h=n(3),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(h);t.sub=i,t.mul=o,t.div=a,t.dist=u,t.sqrDist=s,t.len=l,t.sqrLen=c,t.forEach=(f=r(),function(e,t,n,r,i,o){var a=void 0,u=void 0;for(t||(t=4),n||(n=0),u=r?Math.min(r*t+n,e.length):e.length,a=n;a<u;a+=t)f[0]=e[a],f[1]=e[a+1],f[2]=e[a+2],f[3]=e[a+3],i(f,f,o),e[a]=f[0],e[a+1]=f[1],e[a+2]=f[2],e[a+3]=f[3];return e})},function(e,t,n){"use strict";e.exports={ACTIVE_ATTRIBUTES:35721,ACTIVE_ATTRIBUTE_MAX_LENGTH:35722,ACTIVE_TEXTURE:34016,ACTIVE_UNIFORMS:35718,ACTIVE_UNIFORM_MAX_LENGTH:35719,ALIASED_LINE_WIDTH_RANGE:33902,ALIASED_POINT_SIZE_RANGE:33901,ALPHA:6406,ALPHA_BITS:3413,ALWAYS:519,ARRAY_BUFFER:34962,ARRAY_BUFFER_BINDING:34964,ATTACHED_SHADERS:35717,BACK:1029,BLEND:3042,BLEND_COLOR:32773,BLEND_DST_ALPHA:32970,BLEND_DST_RGB:32968,BLEND_EQUATION:32777,BLEND_EQUATION_ALPHA:34877,BLEND_EQUATION_RGB:32777,BLEND_SRC_ALPHA:32971,BLEND_SRC_RGB:32969,BLUE_BITS:3412,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,BROWSER_DEFAULT_WEBGL:37444,BUFFER_SIZE:34660,BUFFER_USAGE:34661,BYTE:5120,CCW:2305,CLAMP_TO_EDGE:33071,COLOR_ATTACHMENT0:36064,COLOR_BUFFER_BIT:16384,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,COMPILE_STATUS:35713,COMPRESSED_TEXTURE_FORMATS:34467,CONSTANT_ALPHA:32771,CONSTANT_COLOR:32769,CONTEXT_LOST_WEBGL:37442,CULL_FACE:2884,CULL_FACE_MODE:2885,CURRENT_PROGRAM:35725,CURRENT_VERTEX_ATTRIB:34342,CW:2304,DECR:7683,DECR_WRAP:34056,DELETE_STATUS:35712,DEPTH_ATTACHMENT:36096,DEPTH_BITS:3414,DEPTH_BUFFER_BIT:256,DEPTH_CLEAR_VALUE:2931,DEPTH_COMPONENT:6402,RED:6403,DEPTH_COMPONENT16:33189,DEPTH_FUNC:2932,DEPTH_RANGE:2928,DEPTH_STENCIL:34041,DEPTH_STENCIL_ATTACHMENT:33306,DEPTH_TEST:2929,DEPTH_WRITEMASK:2930,DITHER:3024,DONT_CARE:4352,DST_ALPHA:772,DST_COLOR:774,DYNAMIC_DRAW:35048,ELEMENT_ARRAY_BUFFER:34963,ELEMENT_ARRAY_BUFFER_BINDING:34965,EQUAL:514,FASTEST:4353,FLOAT:5126,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,FRAGMENT_SHADER:35632,FRAMEBUFFER:36160,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_BINDING:36006,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_UNSUPPORTED:36061,FRONT:1028,FRONT_AND_BACK:1032,FRONT_FACE:2886,FUNC_ADD:32774,FUNC_REVERSE_SUBTRACT:32779,FUNC_SUBTRACT:32778,GENERATE_MIPMAP_HINT:33170,GEQUAL:518,GREATER:516,GREEN_BITS:3411,HIGH_FLOAT:36338,HIGH_INT:36341,INCR:7682,INCR_WRAP:34055,INFO_LOG_LENGTH:35716,INT:5124,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,INVALID_ENUM:1280,INVALID_FRAMEBUFFER_OPERATION:1286,INVALID_OPERATION:1282,INVALID_VALUE:1281,INVERT:5386,KEEP:7680,LEQUAL:515,LESS:513,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,LINES:1,LINE_LOOP:2,LINE_STRIP:3,LINE_WIDTH:2849,LINK_STATUS:35714,LOW_FLOAT:36336,LOW_INT:36339,LUMINANCE:6409,LUMINANCE_ALPHA:6410,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_CUBE_MAP_TEXTURE_SIZE:34076,MAX_FRAGMENT_UNIFORM_VECTORS:36349,MAX_RENDERBUFFER_SIZE:34024,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_TEXTURE_SIZE:3379,MAX_VARYING_VECTORS:36348,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VIEWPORT_DIMS:3386,MEDIUM_FLOAT:36337,MEDIUM_INT:36340,MIRRORED_REPEAT:33648,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,NEVER:512,NICEST:4354,NONE:0,NOTEQUAL:517,NO_ERROR:0,NUM_COMPRESSED_TEXTURE_FORMATS:34466,ONE:1,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,OUT_OF_MEMORY:1285,PACK_ALIGNMENT:3333,POINTS:0,POLYGON_OFFSET_FACTOR:32824,POLYGON_OFFSET_FILL:32823,POLYGON_OFFSET_UNITS:10752,RED_BITS:3410,RENDERBUFFER:36161,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_BINDING:36007,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_STENCIL_SIZE:36181,RENDERBUFFER_WIDTH:36162,RENDERER:7937,REPEAT:10497,REPLACE:7681,RGB:6407,RGB5_A1:32855,RGB565:36194,RGBA:6408,RGBA4:32854,SAMPLER_2D:35678,SAMPLER_CUBE:35680,SAMPLES:32937,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_BUFFERS:32936,SAMPLE_COVERAGE:32928,SAMPLE_COVERAGE_INVERT:32939,SAMPLE_COVERAGE_VALUE:32938,SCISSOR_BOX:3088,SCISSOR_TEST:3089,SHADER_COMPILER:36346,SHADER_SOURCE_LENGTH:35720,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,SHORT:5122,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,STATIC_DRAW:35044,STENCIL_ATTACHMENT:36128,STENCIL_BACK_FAIL:34817,STENCIL_BACK_FUNC:34816,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,STENCIL_BITS:3415,STENCIL_BUFFER_BIT:1024,STENCIL_CLEAR_VALUE:2961,STENCIL_FAIL:2964,STENCIL_FUNC:2962,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_TEST:2960,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STREAM_DRAW:35040,SUBPIXEL_BITS:3408,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,TEXTURE_2D:3553,TEXTURE_BINDING_2D:32873,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP:34067,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TRIANGLES:4,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,UNPACK_ALIGNMENT:3317,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,UNSIGNED_BYTE:5121,UNSIGNED_INT:5125,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,VALIDATE_STATUS:35715,VENDOR:7936,VERSION:7938,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_SHADER:35633,VIEWPORT:2978,ZERO:0,R8:33321}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return void 0===t.cacheAttribLoc&&(t.cacheAttribLoc={}),void 0===t.cacheAttribLoc[n]&&(t.cacheAttribLoc[n]=e.getAttribLocation(t,n)),t.cacheAttribLoc[n]}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return 0!==e&&!(e&e-1)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0),u=r(a),s=n(8),l=void r(s),c=function(){function e(t){var n,r,o,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),l=u.default.gl,a)this._texture=t;else{this._mSource=t,this._texture=l.createTexture(),this._isVideo="VIDEO"===t.tagName,this._premultiplyAlpha=!0,this._magFilter=s.magFilter||l.LINEAR,this._minFilter=s.minFilter||l.NEAREST_MIPMAP_LINEAR,this._wrapS=s.wrapS||l.MIRRORED_REPEAT,this._wrapT=s.wrapT||l.MIRRORED_REPEAT,t.width||t.videoWidth?(r=(n=t).width||n.videoWidth,o=n.height||n.videoHeight,!(!r||!o)&&i(r)&&i(o)||(this._wrapS=this._wrapT=l.CLAMP_TO_EDGE,this._minFilter===l.NEAREST_MIPMAP_LINEAR&&(this._minFilter=l.LINEAR))):(this._wrapS=this._wrapT=l.CLAMP_TO_EDGE,this._minFilter===l.NEAREST_MIPMAP_LINEAR&&(this._minFilter=l.LINEAR)),l.bindTexture(l.TEXTURE_2D,this._texture),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!0),t.exposure?l.texImage2D(l.TEXTURE_2D,0,l.RGBA,t.shape[0],t.shape[1],0,l.RGBA,l.FLOAT,t.data):l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,t),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,this._magFilter),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,this._minFilter),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,this._wrapS),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,this._wrapT);var c=u.default.getExtension("EXT_texture_filter_anisotropic");if(c){var f=l.getParameter(c.MAX_TEXTURE_MAX_ANISOTROPY_EXT);l.texParameterf(l.TEXTURE_2D,c.TEXTURE_MAX_ANISOTROPY_EXT,f)}this._canGenerateMipmap()&&l.generateMipmap(l.TEXTURE_2D),l.bindTexture(l.TEXTURE_2D,null)}}return o(e,[{key:"generateMipmap",value:function(){this._canGenerateMipmap()&&(l.bindTexture(l.TEXTURE_2D,this._texture),l.generateMipmap(l.TEXTURE_2D),l.bindTexture(l.TEXTURE_2D,null))}},{key:"updateTexture",value:function(e){e&&(this._mSource=e),l.bindTexture(l.TEXTURE_2D,this._texture),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!0),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,this._mSource),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,this._magFilter),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,this._minFilter),this._canGenerateMipmap()&&l.generateMipmap(l.TEXTURE_2D),l.bindTexture(l.TEXTURE_2D,null)}},{key:"bind",value:function(e){void 0===e&&(e=0),u.default.shader&&(l.activeTexture(l.TEXTURE0+e),l.bindTexture(l.TEXTURE_2D,this._texture),this._bindIndex=e)}},{key:"_canGenerateMipmap",value:function(){return this._minFilter===l.LINEAR_MIPMAP_NEAREST||this._minFilter===l.NEAREST_MIPMAP_LINEAR||this._minFilter===l.LINEAR_MIPMAP_LINEAR||this._minFilter===l.NEAREST_MIPMAP_NEAREST}},{key:"minFilter",set:function(e){if(e!==l.LINEAR&&e!==l.NEAREST&&e!==l.NEAREST_MIPMAP_LINEAR&&e!==l.NEAREST_MIPMAP_LINEAR&&e!==l.LINEAR_MIPMAP_LINEAR&&e!==l.NEAREST_MIPMAP_NEAREST)return this;this._minFilter=e,l.bindTexture(l.TEXTURE_2D,this._texture),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,this._minFilter),l.bindTexture(l.TEXTURE_2D,null)},get:function(){return this._minFilter}},{key:"magFilter",set:function(e){if(e!==l.LINEAR&&e!==l.NEAREST)return this;this._magFilter=e,l.bindTexture(l.TEXTURE_2D,this._texture),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,this._magFilter),l.bindTexture(l.TEXTURE_2D,null)},get:function(){return this._magFilter}},{key:"wrapS",set:function(e){if(e!==l.CLAMP_TO_EDGE&&e!==l.REPEAT&&e!==l.MIRRORED_REPEAT)return this;this._wrapS=e,l.bindTexture(l.TEXTURE_2D,this._texture),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,this._wrapS),l.bindTexture(l.TEXTURE_2D,null)},get:function(){return this._wrapS}},{key:"wrapT",set:function(e){if(e!==l.CLAMP_TO_EDGE&&e!==l.REPEAT&&e!==l.MIRRORED_REPEAT)return this;this._wrapT=e,l.bindTexture(l.TEXTURE_2D,this._texture),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,this._wrapT),l.bindTexture(l.TEXTURE_2D,null)},get:function(){return this._wrapT}},{key:"premultiplyAlpha",set:function(e){this._premultiplyAlpha=e,l.bindTexture(l.TEXTURE_2D,this._texture),console.log("premultiplyAlpha:",e),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._premultiplyAlpha),l.bindTexture(l.TEXTURE_2D,null)},get:function(){return this._premultiplyAlpha}},{key:"texture",get:function(){return this._texture}}]),e}(),f=void 0,h=void 0,d=void 0;c.whiteTexture=function(){if(void 0===f){var e=document.createElement("canvas");e.width=e.height=4;var t=e.getContext("2d");t.fillStyle="#fff",t.fillRect(0,0,4,4),f=new c(e)}return f},c.greyTexture=function(){if(void 0===h){var e=document.createElement("canvas");e.width=e.height=4;var t=e.getContext("2d");t.fillStyle="rgb(127, 127, 127)",t.fillRect(0,0,4,4),h=new c(e)}return h},c.blackTexture=function(){if(void 0===d){var e=document.createElement("canvas");e.width=e.height=4;var t=e.getContext("2d");t.fillStyle="rgb(127, 127, 127)",t.fillRect(0,0,4,4),d=new c(e)}return d},t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return 0!==e&&!(e&e-1)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(49),u=r(a),s=n(8),l=r(s),c=n(0),f=r(c),h=n(4),d=r(h),_=void 0,v=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),_=f.default.gl,this._source=t,this._getDimension(t,i,o),this._sourceType=n.type||function(e){var t=f.default.UNSIGNED_BYTE;return e instanceof Array?t=f.default.UNSIGNED_BYTE:e instanceof Uint8Array?t=f.default.UNSIGNED_BYTE:e instanceof Float32Array?t=f.default.FLOAT:e instanceof HTMLImageElement?t="image":e instanceof HTMLCanvasElement?t="canvas":e instanceof HTMLVideoElement&&(t="video"),t}(t),this._checkSource(),this._texelType=this._getTexelType(),this._isTextureReady=!0,this._params=(0,u.default)(n,t,this._width,this._height),this._checkMipmap(),this._checkWrapping(),this._texture=_.createTexture(),"video"===this._sourceType?(this._isTextureReady=!1,d.default.addEF(function(){return r._loop()})):this._uploadTexture()}return o(e,[{key:"_loop",value:function(){4==this._source.readyState&&(this._isTextureReady=!0,this._uploadTexture())}},{key:"_uploadTexture",value:function(){_.bindTexture(_.TEXTURE_2D,this._texture),_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,!0),this._isSourceHtmlElement()?_.texImage2D(_.TEXTURE_2D,0,this._params.internalFormat,this._params.format,this._texelType,this._source):_.texImage2D(_.TEXTURE_2D,0,this._params.internalFormat,this._width,this._height,0,this._params.format,this._texelType,this._source),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,this._params.magFilter),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this._params.minFilter),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,this._params.wrapS),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,this._params.wrapT),_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._premultiplyAlpha),this._generateMipmap&&_.generateMipmap(_.TEXTURE_2D),_.bindTexture(_.TEXTURE_2D,null)}},{key:"bind",value:function(t){void 0===t&&(t=0),f.default.shader&&(_.activeTexture(_.TEXTURE0+t),this._isTextureReady?_.bindTexture(_.TEXTURE_2D,this._texture):_.bindTexture(_.TEXTURE_2D,e.blackTexture().texture),this._bindIndex=t)}},{key:"updateTexture",value:function(e){this._source=e,this._checkSource(),this._uploadTexture()}},{key:"generateMipmap",value:function(){this._generateMipmap&&(_.bindTexture(_.TEXTURE_2D,this._texture),_.generateMipmap(_.TEXTURE_2D),_.bindTexture(_.TEXTURE_2D,null))}},{key:"showParameters",value:function(){for(var e in console.log("Source type : ",l.default[this._sourceType]||this._sourceType),console.log("Texel type:",l.default[this.texelType]),console.log("Dimension :",this._width,this._height),this._params)console.log(e,l.default[this._params[e]]||this._params[e]);console.log("Mipmapping :",this._generateMipmap)}},{key:"_getDimension",value:function(e,t,n){e?(this._width=e.width||e.videoWidth,this._height=e.height||e.videoWidth,this._width=this._width||t,this._height=this._height||n,this._width&&this._height||(this._width=this._height=Math.sqrt(e.length/4))):(this._width=t,this._height=n)}},{key:"_checkSource",value:function(){this._source&&(this._sourceType===f.default.UNSIGNED_BYTE?this._source instanceof Uint8Array||(this._source=new Uint8Array(this._source)):this._sourceType===f.default.FLOAT&&(this._source instanceof Float32Array||(this._source=new Float32Array(this._source))))}},{key:"_getTexelType",value:function(){return this._isSourceHtmlElement()?f.default.UNSIGNED_BYTE:f.default[l.default[this._sourceType]]}},{key:"_checkMipmap",value:function(){this._generateMipmap=this._params.mipmap,i(this._width)&&i(this._height)||(this._generateMipmap=!1),-1==l.default[this._params.minFilter].indexOf("MIPMAP")&&(this._generateMipmap=!1)}},{key:"_checkWrapping",value:function(){this._generateMipmap||(this._params.wrapS=f.default.CLAMP_TO_EDGE,this._params.wrapT=f.default.CLAMP_TO_EDGE)}},{key:"_isSourceHtmlElement",value:function(){return"image"===this._sourceType||"video"===this._sourceType||"canvas"===this._sourceType}},{key:"minFilter",get:function(){return this._params.minFilter},set:function(e){console.log("set min filter : ",l.default[e]),this._params.minFilter=e,this._checkMipmap(),_.bindTexture(_.TEXTURE_2D,this._texture),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this._params.minFilter),_.bindTexture(_.TEXTURE_2D,null),this.generateMipmap()}},{key:"magFilter",get:function(){return this._params.minFilter},set:function(e){console.log("set mag filter : ",l.default[e]),this._params.magFilter=e,_.bindTexture(_.TEXTURE_2D,this._texture),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,this._params.magFilter),_.bindTexture(_.TEXTURE_2D,null)}},{key:"wrapS",get:function(){return this._params.wrapS},set:function(e){this._params.wrapS=e,this._checkWrapping(),_.bindTexture(_.TEXTURE_2D,this._texture),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,this._params.wrapS),_.bindTexture(_.TEXTURE_2D,null)}},{key:"wrapT",get:function(){return this._params.wrapT},set:function(e){this._params.wrapT=e,this._checkWrapping(),_.bindTexture(_.TEXTURE_2D,this._texture),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,this._params.wrapT),_.bindTexture(_.TEXTURE_2D,null)}},{key:"texelType",get:function(){return this._texelType}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"texture",get:function(){return this._texture}},{key:"isTextureReady",get:function(){return this._isTextureReady}}]),e}(),p=void 0,m=void 0,E=void 0;v.whiteTexture=function(){if(void 0===p){var e=document.createElement("canvas");e.width=e.height=2;var t=e.getContext("2d");t.fillStyle="#fff",t.fillRect(0,0,2,2),p=new v(e)}return p},v.greyTexture=function(){if(void 0===m){var e=document.createElement("canvas");e.width=e.height=2;var t=e.getContext("2d");t.fillStyle="rgb(127, 127, 127)",t.fillRect(0,0,2,2),m=new v(e)}return m},v.blackTexture=function(){if(void 0===E){var e=document.createElement("canvas");e.width=e.height=2;var t=e.getContext("2d");t.fillStyle="rgb(0, 0, 0)",t.fillRect(0,0,2,2),E=new v(e)}return E},t.default=v},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=r(o),u=n(50),s=r(u),l=void 0,c=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),l=a.default.gl,r)this.texture=t;else{var i=t.length>6;t[0].mipmapCount&&(i=t[0].mipmapCount>1),this.texture=l.createTexture(),this.magFilter=n.magFilter||l.LINEAR,this.minFilter=n.minFilter||l.LINEAR_MIPMAP_LINEAR,this.wrapS=n.wrapS||l.CLAMP_TO_EDGE,this.wrapT=n.wrapT||l.CLAMP_TO_EDGE,i||this.minFilter!=l.LINEAR_MIPMAP_LINEAR||(this.minFilter=l.LINEAR),l.bindTexture(l.TEXTURE_CUBE_MAP,this.texture);var o=[l.TEXTURE_CUBE_MAP_POSITIVE_X,l.TEXTURE_CUBE_MAP_NEGATIVE_X,l.TEXTURE_CUBE_MAP_POSITIVE_Y,l.TEXTURE_CUBE_MAP_NEGATIVE_Y,l.TEXTURE_CUBE_MAP_POSITIVE_Z,l.TEXTURE_CUBE_MAP_NEGATIVE_Z],u=1,s=0;if(u=t.length/6,this.numLevels=u,i)for(var c=0;c<6;c++)for(var f=0;f<u;f++)l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!1),t[s=c*u+f].shape?l.texImage2D(o[c],f,l.RGBA,t[s].shape[0],t[s].shape[1],0,l.RGBA,l.FLOAT,t[s].data):l.texImage2D(o[c],f,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,t[s]),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_WRAP_S,this.wrapS),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_WRAP_T,this.wrapT),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_MAG_FILTER,this.magFilter),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_MIN_FILTER,this.minFilter);else{for(var h=0,d=0;d<6;d++)h=d*u,l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!1),t[h].shape?l.texImage2D(o[d],0,l.RGBA,t[h].shape[0],t[h].shape[1],0,l.RGBA,l.FLOAT,t[h].data):l.texImage2D(o[d],0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,t[h]),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_WRAP_S,this.wrapS),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_WRAP_T,this.wrapT),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_MAG_FILTER,this.magFilter),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_MIN_FILTER,this.minFilter);l.generateMipmap(l.TEXTURE_CUBE_MAP)}l.bindTexture(l.TEXTURE_CUBE_MAP,null)}}return i(e,[{key:"bind",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;a.default.shader&&(l.activeTexture(l.TEXTURE0+e),l.bindTexture(l.TEXTURE_CUBE_MAP,this.texture),l.uniform1i(a.default.shader.uniformTextures[e],e),this._bindIndex=e)}},{key:"unbind",value:function(){l.bindTexture(l.TEXTURE_CUBE_MAP,null)}}]),e}();c.parseDDS=function(e){var t=(0,s.default)(e),n=t.flags,r=new Int32Array(e,0,31),i=1;131072&n&&(i=Math.max(1,r[7]));var o=t.images.map(function(t){return{data:new Float32Array(e.slice(t.offset,t.offset+t.length)),shape:t.shape,mipmapCount:i}});return new c(o)},t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=r(o),u=n(26),s=r(u),l=n(8),c=void r(l),f=void 0,h=!1,d=void 0,_=function(){return!!a.default.webgl2||!!(d=a.default.getExtension("WEBGL_draw_buffers"))},v=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),c=a.default.gl,f=a.default.checkExtension("WEBGL_depth_texture"),this.width=t,this.height=n,this._numTargets=i,this._multipleTargets=i>1,this._parameters=r,h||_(),this._multipleTargets&&this._checkMaxNumRenderTarget(),this._init()}return i(e,[{key:"_init",value:function(){if(this._initTextures(),this.frameBuffer=c.createFramebuffer(),c.bindFramebuffer(c.FRAMEBUFFER,this.frameBuffer),a.default.webgl2){for(var e=[],t=0;t<this._numTargets;t++)c.framebufferTexture2D(c.DRAW_FRAMEBUFFER,c.COLOR_ATTACHMENT0+t,c.TEXTURE_2D,this._textures[t].texture,0),e.push(c["COLOR_ATTACHMENT"+t]);c.drawBuffers(e),c.framebufferTexture2D(c.DRAW_FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.TEXTURE_2D,this.glDepthTexture.texture,0)}else{for(var n=0;n<this._numTargets;n++)c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0+n,c.TEXTURE_2D,this._textures[n].texture,0);if(this._multipleTargets){for(var r=[],i=0;i<this._numTargets;i++)r.push(d["COLOR_ATTACHMENT"+i+"_WEBGL"]);d.drawBuffersWEBGL(r)}f&&c.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.TEXTURE_2D,this.glDepthTexture.texture,0)}var o=c.checkFramebufferStatus(c.FRAMEBUFFER);o!=c.FRAMEBUFFER_COMPLETE&&(console.error("FBOstatus",o),console.error("GL_FRAMEBUFFER_COMPLETE failed, CANNOT use Framebuffer")),c.bindTexture(c.TEXTURE_2D,null),c.bindRenderbuffer(c.RENDERBUFFER,null),c.bindFramebuffer(c.FRAMEBUFFER,null),this.clear()}},{key:"_checkMaxNumRenderTarget",value:function(){var e=a.default.gl.getParameter(d.MAX_DRAW_BUFFERS_WEBGL);this._numTargets>e&&(console.error("Over max number of draw buffers supported : ",e),this._numTargets=e)}},{key:"_initTextures",value:function(){this._textures=[];for(var e=0;e<this._numTargets;e++){var t=this._createTexture();this._textures.push(t)}a.default.webgl2?this.glDepthTexture=this._createTexture(c.DEPTH_COMPONENT16,c.UNSIGNED_SHORT,c.DEPTH_COMPONENT,!0):this.glDepthTexture=this._createTexture(c.DEPTH_COMPONENT,c.UNSIGNED_SHORT,c.DEPTH_COMPONENT,{minFilter:a.default.LINEAR})}},{key:"_createTexture",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=Object.assign({},this._parameters);for(var o in n||(n=e),i.internalFormat=e||c.RGBA,i.format=n,i.type=i.type||t||a.default.UNSIGNED_BYTE,t===c.UNSIGNED_SHORT&&(i.type=t),r)i[o]=r[o];return new s.default(null,i,this.width,this.height)}},{key:"bind",value:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&a.default.viewport(0,0,this.width,this.height),c.bindFramebuffer(c.FRAMEBUFFER,this.frameBuffer)}},{key:"unbind",value:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&a.default.viewport(0,0,a.default.width,a.default.height),c.bindFramebuffer(c.FRAMEBUFFER,null),this._textures.forEach(function(e){e.generateMipmap()})}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.bind(),a.default.clear(e,t,n,r),this.unbind()}},{key:"getTexture",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._textures[e]}},{key:"getDepthTexture",value:function(){return this.glDepthTexture}},{key:"showParameters",value:function(){this._textures[0].showParameters()}},{key:"texture",get:function(){return this._textures[0]}},{key:"depthTexture",get:function(){return this.glDepthTexture}},{key:"minFilter",get:function(){return this._textures[0].minFilter},set:function(e){this._textures.forEach(function(t){t.minFilter=e})}},{key:"magFilter",get:function(){return this._textures[0].magFilter},set:function(e){this._textures.forEach(function(t){t.magFilter=e})}},{key:"wrapS",get:function(){return this._textures[0].wrapS},set:function(e){this._textures.forEach(function(t){t.wrapS=e})}},{key:"wrapT",get:function(){return this._textures[0].wrapT},set:function(e){this._textures.forEach(function(t){t.wrapT=e})}},{key:"numTargets",get:function(){return this._numTargets}}]),e}();t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=!0;try{document.createEvent("CustomEvent")}catch(e){i=!1}var o=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._eventListeners={}}return r(e,[{key:"addEventListener",value:function(e,t){return null!==this._eventListeners&&void 0!==this._eventListeners||(this._eventListeners={}),this._eventListeners[e]||(this._eventListeners[e]=[]),this._eventListeners[e].push(t),this}},{key:"on",value:function(e,t){return this.addEventListener(e,t)}},{key:"removeEventListener",value:function(e,t){null!==this._eventListeners&&void 0!==this._eventListeners||(this._eventListeners={});var n=this._eventListeners[e];if(void 0===n)return this;for(var r=n.length,i=0;i<r;i++)n[i]===t&&(n.splice(i,1),i--,r--);return this}},{key:"off",value:function(e,t){return this.removeEventListener(e,t)}},{key:"dispatchEvent",value:function(e){null!==this._eventListeners&&void 0!==this._eventListeners||(this._eventListeners={});var t=e.type;try{null===e.target&&(e.target=this),e.currentTarget=this}catch(r){var n={type:t,detail:e.detail,dispatcher:this};return this.dispatchEvent(n)}var r=this._eventListeners[t];if(null!=r)for(var i=this._copyArray(r),o=i.length,a=0;a<o;a++){var u=i[a];u.call(this,e)}return this}},{key:"dispatchCustomEvent",value:function(e,t){var n=void 0;return i?((n=document.createEvent("CustomEvent")).dispatcher=this,n.initCustomEvent(e,!1,!1,t)):n={type:e,detail:t,dispatcher:this},this.dispatchEvent(n)}},{key:"trigger",value:function(e,t){return this.dispatchCustomEvent(e,t)}},{key:"_destroy",value:function(){if(null!==this._eventListeners){for(var e in this._eventListeners)if(this._eventListeners.hasOwnProperty(e)){for(var t=this._eventListeners[e],n=t.length,r=0;r<n;r++)t[r]=null;delete this._eventListeners[e]}this._eventListeners=null}}},{key:"_copyArray",value:function(e){for(var t=new Array(e.length),n=t.length,r=0;r<n;r++)t[r]=e[r];return t}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(10),a=r(o),u=n(4),s=r(u),l=n(2),c=function(e,t){var n=t||{};return e.touches?(n.x=e.touches[0].pageX,n.y=e.touches[0].pageY):(n.x=e.clientX,n.y=e.clientY),n},f=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._target=t,this._listenerTarget=r,this._mouse={},this._preMouse={},this.center=l.vec3.create(),this._up=l.vec3.fromValues(0,1,0),this.radius=new a.default(i),this.position=l.vec3.fromValues(0,0,this.radius.value),this.positionOffset=l.vec3.create(),this._rx=new a.default(0),this._rx.limit(-Math.PI/2,Math.PI/2),this._ry=new a.default(0),this._preRX=0,this._preRY=0,this._isLockZoom=!1,this._isLockRotation=!1,this._isInvert=!1,this.sensitivity=1,this._wheelBind=function(e){return n._onWheel(e)},this._downBind=function(e){return n._onDown(e)},this._moveBind=function(e){return n._onMove(e)},this._upBind=function(){return n._onUp()},this.connect(),s.default.addEF(function(){return n._loop()})}return i(e,[{key:"connect",value:function(){this.disconnect(),this._listenerTarget.addEventListener("mousewheel",this._wheelBind),this._listenerTarget.addEventListener("DOMMouseScroll",this._wheelBind),this._listenerTarget.addEventListener("mousedown",this._downBind),this._listenerTarget.addEventListener("touchstart",this._downBind),this._listenerTarget.addEventListener("mousemove",this._moveBind),this._listenerTarget.addEventListener("touchmove",this._moveBind),window.addEventListener("touchend",this._upBind),window.addEventListener("mouseup",this._upBind)}},{key:"disconnect",value:function(){this._listenerTarget.removeEventListener("mousewheel",this._wheelBind),this._listenerTarget.removeEventListener("DOMMouseScroll",this._wheelBind),this._listenerTarget.removeEventListener("mousedown",this._downBind),this._listenerTarget.removeEventListener("touchstart",this._downBind),this._listenerTarget.removeEventListener("mousemove",this._moveBind),this._listenerTarget.removeEventListener("touchmove",this._moveBind),window.removeEventListener("touchend",this._upBind),window.removeEventListener("mouseup",this._upBind)}},{key:"lock",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isLockZoom=e,this._isLockRotation=e,this._isMouseDown=!1}},{key:"lockZoom",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isLockZoom=e}},{key:"lockRotation",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isLockRotation=e}},{key:"inverseControl",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isInvert=e}},{key:"_onDown",value:function(e){this._isLockRotation||(this._isMouseDown=!0,c(e,this._mouse),c(e,this._preMouse),this._preRX=this._rx.targetValue,this._preRY=this._ry.targetValue)}},{key:"_onMove",value:function(e){if(!this._isLockRotation&&(c(e,this._mouse),e.touches&&e.preventDefault(),this._isMouseDown)){var t=-(this._mouse.x-this._preMouse.x);this._isInvert&&(t*=-1),this._ry.value=this._preRY-.01*t*this.sensitivity;var n=-(this._mouse.y-this._preMouse.y);this._isInvert&&(n*=-1),this._rx.value=this._preRX-.01*n*this.sensitivity}}},{key:"_onUp",value:function(){this._isLockRotation||(this._isMouseDown=!1)}},{key:"_onWheel",value:function(e){if(!this._isLockZoom){var t=e.wheelDelta,n=e.detail,r=0;r=n?t?t/n/40*n>0?1:-1:-n/3:t/120,this.radius.add(2*-r)}}},{key:"_loop",value:function(){this._updatePosition(),this._target&&this._updateCamera()}},{key:"_updatePosition",value:function(){this.position[1]=Math.sin(this._rx.value)*this.radius.value;var e=Math.cos(this._rx.value)*this.radius.value;this.position[0]=Math.cos(this._ry.value+.5*Math.PI)*e,this.position[2]=Math.sin(this._ry.value+.5*Math.PI)*e,l.vec3.add(this.position,this.position,this.positionOffset)}},{key:"_updateCamera",value:function(){this._target.lookAt(this.position,this.center,this._up)}},{key:"rx",get:function(){return this._rx}},{key:"ry",get:function(){return this._ry}}]),e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(12),a=(r=o)&&r.__esModule?r:{default:r},u=n(2),s=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),n=u.vec3.clone([0,0,5]),r=u.vec3.create(),i=u.vec3.clone([0,1,0]);return e.lookAt(n,r,i),e.ortho(-1,1,1,-1),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"setBoundary",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100;this.ortho(e,t,n,r,i,o)}},{key:"ortho",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100;this.left=e,this.right=t,this.top=n,this.bottom=r,mat4.ortho(this._projection,e,t,r,n,i,o)}}]),t}(a.default);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),a=n(4),u=(r=a)&&r.__esModule?r:{default:r},s=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._needUpdate=!0,this._x=0,this._y=0,this._z=0,this._sx=1,this._sy=1,this._sz=1,this._rx=0,this._ry=0,this._rz=0,this._position=o.vec3.create(),this._scale=o.vec3.fromValues(1,1,1),this._rotation=o.vec3.create(),this._matrix=o.mat4.create(),this._matrixParent=o.mat4.create(),this._matrixRotation=o.mat4.create(),this._matrixScale=o.mat4.create(),this._matrixTranslation=o.mat4.create(),this._matrixQuaternion=o.mat4.create(),this._quat=o.quat.create(),this._children=[]}return i(e,[{key:"addChild",value:function(e){this._children.push(e)}},{key:"removeChild",value:function(e){var t=this._children.indexOf(e);-1!=t?this._children.splice(t,1):console.warn("Child no exist")}},{key:"_update",value:function(){this._needUpdate&&(o.vec3.set(this._scale,this._sx,this._sy,this._sz),o.vec3.set(this._rotation,this._rx,this._ry,this._rz),o.vec3.set(this._position,this._x,this._y,this._z),o.mat4.identity(this._matrixTranslation,this._matrixTranslation),o.mat4.identity(this._matrixScale,this._matrixScale),o.mat4.identity(this._matrixRotation,this._matrixRotation),o.mat4.rotateX(this._matrixRotation,this._matrixRotation,this._rx),o.mat4.rotateY(this._matrixRotation,this._matrixRotation,this._ry),o.mat4.rotateZ(this._matrixRotation,this._matrixRotation,this._rz),o.mat4.fromQuat(this._matrixQuaternion,this._quat),o.mat4.mul(this._matrixRotation,this._matrixQuaternion,this._matrixRotation),o.mat4.scale(this._matrixScale,this._matrixScale,this._scale),o.mat4.translate(this._matrixTranslation,this._matrixTranslation,this._position),o.mat4.mul(this._matrix,this._matrixTranslation,this._matrixRotation),o.mat4.mul(this._matrix,this._matrix,this._matrixScale),o.mat4.mul(this._matrix,this._matrixParent,this._matrix),this.updateMatrix(),this._needUpdate=!1)}},{key:"updateMatrix",value:function(e){var t=this;e&&(this._needUpdate=!0,o.mat4.copy(this._matrixParent,e)),this._needUpdate&&this._children.forEach(function(e){e.updateMatrix(t._matrix)})}},{key:"setRotationFromQuaternion",value:function(e){var t=this;o.quat.copy(this._quat,e),this._needUpdate=!0,u.default.next(function(){return t._update()})}},{key:"matrix",get:function(){return this._needUpdate&&this._update(),this._matrix}},{key:"x",get:function(){return this._x},set:function(e){var t=this;this._needUpdate=!0,this._x=e,u.default.next(function(){return t._update()})}},{key:"y",get:function(){return this._y},set:function(e){var t=this;this._needUpdate=!0,this._y=e,u.default.next(function(){return t._update()})}},{key:"z",get:function(){return this._z},set:function(e){var t=this;this._needUpdate=!0,this._z=e,u.default.next(function(){return t._update()})}},{key:"scaleX",get:function(){return this._sx},set:function(e){var t=this;this._needUpdate=!0,this._sx=e,u.default.next(function(){return t._update()})}},{key:"scaleY",get:function(){return this._sy},set:function(e){var t=this;this._needUpdate=!0,this._sy=e,u.default.next(function(){return t._update()})}},{key:"scaleZ",get:function(){return this._sz},set:function(e){var t=this;this._needUpdate=!0,this._sz=e,u.default.next(function(){return t._update()})}},{key:"rotationX",get:function(){return this._rx},set:function(e){var t=this;this._needUpdate=!0,this._rx=e,u.default.next(function(){return t._update()})}},{key:"rotationY",get:function(){return this._ry},set:function(e){var t=this;this._needUpdate=!0,this._ry=e,u.default.next(function(){return t._update()})}},{key:"rotationZ",get:function(){return this._rz},set:function(e){var t=this;this._needUpdate=!0,this._rz=e,u.default.next(function(){return t._update()})}},{key:"children",get:function(){return this._children}}]),e}();t.default=s},function(e,t){e.exports="// generalWithNormal.vert\n\n#define SHADER_NAME GENERAL_VERTEX\n\nprecision highp float;\n#define GLSLIFY 1\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\n\nuniform vec3 position;\nuniform vec3 scale;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vNormal;\n\nvoid main(void) {\n\tvec3 pos      = aVertexPosition * scale;\n\tpos           += position;\n\tgl_Position   = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(pos, 1.0);\n\t\n\tvTextureCoord = aTextureCoord;\n\tvNormal       = normalize(uNormalMatrix * aNormal);\n}"},function(e,t){e.exports="// basic.vert\n\n#define SHADER_NAME SKYBOX_VERTEX\n\nprecision highp float;\n#define GLSLIFY 1\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vVertex;\nvarying vec3 vNormal;\n\nvoid main(void) {\n\tmat4 matView = uViewMatrix;\n\tmatView[3][0] = 0.0;\n\tmatView[3][1] = 0.0;\n\tmatView[3][2] = 0.0;\n\t\n\tgl_Position = uProjectionMatrix * matView * uModelMatrix * vec4(aVertexPosition, 1.0);\n\tvTextureCoord = aTextureCoord;\n\t\n\tvVertex = aVertexPosition;\n\tvNormal = aNormal;\n}"},function(e,t){e.exports="// basic.frag\n\n#define SHADER_NAME SKYBOX_FRAGMENT\n\nprecision mediump float;\n#define GLSLIFY 1\nuniform samplerCube texture;\nvarying vec2 vTextureCoord;\nvarying vec3 vVertex;\n\nvoid main(void) {\n    gl_FragColor = textureCube(texture, vVertex);\n}"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(28),a=(r=o)&&r.__esModule?r:{default:r},u=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._fbos=[];for(var u=0;u<t;u++){var s=new a.default(n,r,i,o);this._fbos.push(s)}}return i(e,[{key:"swap",value:function(){var e=this._fbos.shift();this._fbos.push(e)}},{key:"read",get:function(){return this._fbos[this._fbos.length-1]}},{key:"write",get:function(){return this._fbos[0]}},{key:"all",get:function(){return this._fbos}}]),e}();t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.FboPingPong=t.FboArray=t.ShaderLibs=t.Draw=t.View3D=t.View=t.Scene=t.BatchFXAA=t.BatchSky=t.BatchSkybox=t.BatchLine=t.BatchDotsPlane=t.BatchBall=t.BatchAxis=t.BatchCopy=t.GLTFParser=t.HDRLoader=t.ObjLoader=t.BinaryLoader=t.Object3D=t.Ray=t.CameraCube=t.CameraPerspective=t.CameraOrtho=t.Camera=t.TouchDetector=t.QuatRotation=t.WebglNumber=t.OrbitalControl=t.TweenNumber=t.SpringNumber=t.EaseNumber=t.EventDispatcher=t.Scheduler=t.TransformFeedbackObject=t.MultisampleFrameBuffer=t.CubeFrameBuffer=t.FrameBuffer=t.Batch=t.Geom=t.Mesh=t.GLCubeTexture=t.GLTextureOld=t.GLTexture=t.GLShader=t.GL=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o),u=n(0),s=r(u),l=n(1),c=r(l),f=n(25),h=r(f),d=n(26),_=r(d),v=n(27),p=r(v),m=n(5),E=r(m),T=n(7),b=r(T),g=n(6),y=r(g),x=n(28),M=r(x),R=n(51),A=r(R),w=n(52),P=r(w),L=n(53),S=r(L),O=n(4),C=r(O),I=n(29),N=r(I),F=n(10),D=r(F),U=n(54),B=r(U),k=n(55),V=r(k),G=n(30),X=r(G),j=n(56),H=r(j),Y=n(57),z=r(Y),q=n(8),W=r(q),Z=n(23),K=(r(Z),n(12)),Q=r(K),$=n(31),J=r($),ee=n(13),te=r(ee),ne=n(59),re=r(ne),ie=n(11),oe=r(ie),ae=n(32),ue=r(ae),se=n(14),le=r(se),ce=n(60),fe=r(ce),he=n(61),de=r(he),_e=n(63),ve=r(_e),pe=n(64),me=r(pe),Ee=n(65),Te=r(Ee),be=n(68),ge=r(be),ye=n(69),xe=r(ye),Me=n(72),Re=r(Me),Ae=n(73),we=r(Ae),Pe=n(74),Le=r(Pe),Se=n(76),Oe=r(Se),Ce=n(78),Ie=r(Ce),Ne=n(79),Fe=r(Ne),De=n(80),Ue=r(De),Be=n(81),ke=r(Be),Ve=n(82),Ge=r(Ve),Xe=n(36),je=r(Xe),He=n(83),Ye=r(He),ze=function(){function e(){for(var t in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.glm=a,this.GL=s.default,this.GLTool=s.default,this.GLShader=c.default,this.GLTexture=_.default,this.GLTextureOld=h.default,this.GLCubeTexture=p.default,this.Mesh=E.default,this.Geom=b.default,this.Batch=y.default,this.FrameBuffer=M.default,this.CubeFrameBuffer=A.default,this.Scheduler=C.default,this.EventDispatcher=N.default,this.EaseNumber=D.default,this.SpringNumber=B.default,this.TweenNumber=V.default,this.Camera=Q.default,this.CameraOrtho=J.default,this.CameraPerspective=te.default,this.Ray=oe.default,this.CameraCube=re.default,this.OrbitalControl=X.default,this.QuatRotation=H.default,this.BinaryLoader=le.default,this.ObjLoader=fe.default,this.GLTFParser=ve.default,this.HDRLoader=de.default,this.BatchCopy=me.default,this.BatchAxis=Te.default,this.BatchBall=ge.default,this.BatchBall=ge.default,this.BatchLine=Re.default,this.BatchSkybox=we.default,this.BatchSky=Le.default,this.BatchFXAA=Oe.default,this.BatchDotsPlane=xe.default,this.Scene=Ie.default,this.View=Fe.default,this.View3D=Ue.default,this.Draw=ke.default,this.Object3D=ue.default,this.ShaderLibs=Ge.default,this.WebglNumber=W.default,this.FboArray=je.default,this.FboPingPong=Ye.default,this.MultisampleFrameBuffer=P.default,this.TransformFeedbackObject=S.default,a)a[t]&&(window[t]=a[t])}return i(e,[{key:"log",value:function(){for(var e in navigator.userAgent.indexOf("Chrome")>-1?console.log("%clib alfrid : VERSION 0.3.6","background: #193441; color: #FCFFF5"):console.log("lib alfrid : VERSION ","0.3.6"),console.log("%cClasses : ","color: #193441"),this)this[e]&&console.log("%c - "+e,"color: #3E606F")}}]),e}(),qe=new ze;t.default=qe,t.GL=s.default,t.GLShader=c.default,t.GLTexture=_.default,t.GLTextureOld=h.default,t.GLCubeTexture=p.default,t.Mesh=E.default,t.Geom=b.default,t.Batch=y.default,t.FrameBuffer=M.default,t.CubeFrameBuffer=A.default,t.MultisampleFrameBuffer=P.default,t.TransformFeedbackObject=S.default,t.Scheduler=C.default,t.EventDispatcher=N.default,t.EaseNumber=D.default,t.SpringNumber=B.default,t.TweenNumber=V.default,t.OrbitalControl=X.default,t.WebglNumber=W.default,t.QuatRotation=H.default,t.TouchDetector=z.default,t.Camera=Q.default,t.CameraOrtho=J.default,t.CameraPerspective=te.default,t.CameraCube=re.default,t.Ray=oe.default,t.Object3D=ue.default,t.BinaryLoader=le.default,t.ObjLoader=fe.default,t.HDRLoader=de.default,t.GLTFParser=ve.default,t.BatchCopy=me.default,t.BatchAxis=Te.default,t.BatchBall=ge.default,t.BatchDotsPlane=xe.default,t.BatchLine=Re.default,t.BatchSkybox=we.default,t.BatchSky=Le.default,t.BatchFXAA=Oe.default,t.Scene=Ie.default,t.View=Fe.default,t.View3D=Ue.default,t.Draw=ke.default,t.ShaderLibs=Ge.default,t.FboArray=je.default,t.FboPingPong=Ye.default},function(e,t,n){"use strict";function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=n[0],s=n[1],l=n[2],c=n[3];return e[0]=r*u+o*s,e[1]=i*u+a*s,e[2]=r*l+o*c,e[3]=i*l+a*c,e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(4);return a.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},t.clone=function(e){var t=new a.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},t.fromValues=function(e,t,n,r){var i=new a.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i},t.set=function(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e},t.transpose=function(e,t){if(e===t){var n=t[1];e[1]=t[2],e[2]=n}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},t.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*o-i*r;return a?(a=1/a,e[0]=o*a,e[1]=-r*a,e[2]=-i*a,e[3]=n*a,e):null},t.adjoint=function(e,t){var n=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=n,e},t.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},t.multiply=r,t.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=Math.sin(n),s=Math.cos(n);return e[0]=r*s+o*u,e[1]=i*s+a*u,e[2]=r*-u+o*s,e[3]=i*-u+a*s,e},t.scale=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=n[0],s=n[1];return e[0]=r*u,e[1]=i*u,e[2]=o*s,e[3]=a*s,e},t.fromRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=-n,e[3]=r,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},t.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},t.LDU=function(e,t,n,r){return e[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-e[2]*n[1],[e,t,n]},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},t.subtract=i,t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],u=t[0],s=t[1],l=t[2],c=t[3];return Math.abs(n-u)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-s)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-l)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-c)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))},t.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},t.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e};var o=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o);t.mul=r,t.sub=i},function(e,t,n){"use strict";function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=t[4],s=t[5],l=n[0],c=n[1],f=n[2],h=n[3],d=n[4],_=n[5];return e[0]=r*l+o*c,e[1]=i*l+a*c,e[2]=r*f+o*h,e[3]=i*f+a*h,e[4]=r*d+o*_+u,e[5]=i*d+a*_+s,e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(6);return a.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e},t.clone=function(e){var t=new a.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},t.fromValues=function(e,t,n,r,i,o){var u=new a.ARRAY_TYPE(6);return u[0]=e,u[1]=t,u[2]=n,u[3]=r,u[4]=i,u[5]=o,u},t.set=function(e,t,n,r,i,o,a){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e},t.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=n*o-r*i;return s?(s=1/s,e[0]=o*s,e[1]=-r*s,e[2]=-i*s,e[3]=n*s,e[4]=(i*u-o*a)*s,e[5]=(r*a-n*u)*s,e):null},t.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},t.multiply=r,t.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=t[4],s=t[5],l=Math.sin(n),c=Math.cos(n);return e[0]=r*c+o*l,e[1]=i*c+a*l,e[2]=r*-l+o*c,e[3]=i*-l+a*c,e[4]=u,e[5]=s,e},t.scale=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=t[4],s=t[5],l=n[0],c=n[1];return e[0]=r*l,e[1]=i*l,e[2]=o*c,e[3]=a*c,e[4]=u,e[5]=s,e},t.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=t[4],s=t[5],l=n[0],c=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=r*l+o*c+u,e[5]=i*l+a*c+s,e},t.fromRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=-n,e[3]=r,e[4]=0,e[5]=0,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},t.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e},t.subtract=i,t.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e},t.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],u=e[4],s=e[5],l=t[0],c=t[1],f=t[2],h=t[3],d=t[4],_=t[5];return Math.abs(n-l)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-c)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-f)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-h)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(u-d)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(d))&&Math.abs(s-_)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(_))};var o=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o);t.mul=r,t.sub=i},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t,n){var r=.5*n[0],i=.5*n[1],o=.5*n[2],a=t[0],u=t[1],s=t[2],l=t[3];return e[0]=a,e[1]=u,e[2]=s,e[3]=l,e[4]=r*l+i*s-o*u,e[5]=i*l+o*a-r*s,e[6]=o*l+r*u-i*a,e[7]=-r*a-i*u-o*s,e}function o(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function a(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=n[4],s=n[5],l=n[6],c=n[7],f=t[4],h=t[5],d=t[6],_=t[7],v=n[0],p=n[1],m=n[2],E=n[3];return e[0]=r*E+a*v+i*m-o*p,e[1]=i*E+a*p+o*v-r*m,e[2]=o*E+a*m+r*p-i*v,e[3]=a*E-r*v-i*p-o*m,e[4]=r*c+a*u+i*l-o*s+f*E+_*v+h*m-d*p,e[5]=i*c+a*s+o*u-r*l+h*E+_*p+d*v-f*m,e[6]=o*c+a*l+r*s-i*u+d*E+_*m+f*p-h*v,e[7]=a*c-r*u-i*s-o*l+_*E-f*v-h*p-d*m,e}Object.defineProperty(t,"__esModule",{value:!0}),t.sqrLen=t.squaredLength=t.len=t.length=t.dot=t.mul=t.setReal=t.getReal=void 0,t.create=function(){var e=new s.ARRAY_TYPE(8);return s.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e},t.clone=function(e){var t=new s.ARRAY_TYPE(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t},t.fromValues=function(e,t,n,r,i,o,a,u){var l=new s.ARRAY_TYPE(8);return l[0]=e,l[1]=t,l[2]=n,l[3]=r,l[4]=i,l[5]=o,l[6]=a,l[7]=u,l},t.fromRotationTranslationValues=function(e,t,n,r,i,o,a){var u=new s.ARRAY_TYPE(8);u[0]=e,u[1]=t,u[2]=n,u[3]=r;var l=.5*i,c=.5*o,f=.5*a;return u[4]=l*r+c*n-f*t,u[5]=c*r+f*e-l*n,u[6]=f*r+l*t-c*e,u[7]=-l*e-c*t-f*n,u},t.fromRotationTranslation=i,t.fromTranslation=function(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e},t.fromRotation=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},t.fromMat4=function(e,t){var n=c.create();h.getRotation(n,t);var r=new s.ARRAY_TYPE(3);return h.getTranslation(r,t),i(e,n,r),e},t.copy=o,t.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},t.set=function(e,t,n,r,i,o,a,u,s){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=u,e[7]=s,e},t.getDual=function(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e},t.setDual=function(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e},t.getTranslation=function(e,t){var n=t[4],r=t[5],i=t[6],o=t[7],a=-t[0],u=-t[1],s=-t[2],l=t[3];return e[0]=2*(n*l+o*a+r*s-i*u),e[1]=2*(r*l+o*u+i*a-n*s),e[2]=2*(i*l+o*s+n*u-r*a),e},t.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=.5*n[0],s=.5*n[1],l=.5*n[2],c=t[4],f=t[5],h=t[6],d=t[7];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=a*u+i*l-o*s+c,e[5]=a*s+o*u-r*l+f,e[6]=a*l+r*s-i*u+h,e[7]=-r*u-i*s-o*l+d,e},t.rotateX=function(e,t,n){var r=-t[0],i=-t[1],o=-t[2],a=t[3],u=t[4],s=t[5],l=t[6],f=t[7],h=u*a+f*r+s*o-l*i,d=s*a+f*i+l*r-u*o,_=l*a+f*o+u*i-s*r,v=f*a-u*r-s*i-l*o;return c.rotateX(e,t,n),r=e[0],i=e[1],o=e[2],a=e[3],e[4]=h*a+v*r+d*o-_*i,e[5]=d*a+v*i+_*r-h*o,e[6]=_*a+v*o+h*i-d*r,e[7]=v*a-h*r-d*i-_*o,e},t.rotateY=function(e,t,n){var r=-t[0],i=-t[1],o=-t[2],a=t[3],u=t[4],s=t[5],l=t[6],f=t[7],h=u*a+f*r+s*o-l*i,d=s*a+f*i+l*r-u*o,_=l*a+f*o+u*i-s*r,v=f*a-u*r-s*i-l*o;return c.rotateY(e,t,n),r=e[0],i=e[1],o=e[2],a=e[3],e[4]=h*a+v*r+d*o-_*i,e[5]=d*a+v*i+_*r-h*o,e[6]=_*a+v*o+h*i-d*r,e[7]=v*a-h*r-d*i-_*o,e},t.rotateZ=function(e,t,n){var r=-t[0],i=-t[1],o=-t[2],a=t[3],u=t[4],s=t[5],l=t[6],f=t[7],h=u*a+f*r+s*o-l*i,d=s*a+f*i+l*r-u*o,_=l*a+f*o+u*i-s*r,v=f*a-u*r-s*i-l*o;return c.rotateZ(e,t,n),r=e[0],i=e[1],o=e[2],a=e[3],e[4]=h*a+v*r+d*o-_*i,e[5]=d*a+v*i+_*r-h*o,e[6]=_*a+v*o+h*i-d*r,e[7]=v*a-h*r-d*i-_*o,e},t.rotateByQuatAppend=function(e,t,n){var r=n[0],i=n[1],o=n[2],a=n[3],u=t[0],s=t[1],l=t[2],c=t[3];return e[0]=u*a+c*r+s*o-l*i,e[1]=s*a+c*i+l*r-u*o,e[2]=l*a+c*o+u*i-s*r,e[3]=c*a-u*r-s*i-l*o,u=t[4],s=t[5],l=t[6],c=t[7],e[4]=u*a+c*r+s*o-l*i,e[5]=s*a+c*i+l*r-u*o,e[6]=l*a+c*o+u*i-s*r,e[7]=c*a-u*r-s*i-l*o,e},t.rotateByQuatPrepend=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=n[0],s=n[1],l=n[2],c=n[3];return e[0]=r*c+a*u+i*l-o*s,e[1]=i*c+a*s+o*u-r*l,e[2]=o*c+a*l+r*s-i*u,e[3]=a*c-r*u-i*s-o*l,u=n[4],s=n[5],l=n[6],c=n[7],e[4]=r*c+a*u+i*l-o*s,e[5]=i*c+a*s+o*u-r*l,e[6]=o*c+a*l+r*s-i*u,e[7]=a*c-r*u-i*s-o*l,e},t.rotateAroundAxis=function(e,t,n,r){if(Math.abs(r)<s.EPSILON)return o(e,t);var i=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);r*=.5;var a=Math.sin(r),u=a*n[0]/i,l=a*n[1]/i,c=a*n[2]/i,f=Math.cos(r),h=t[0],d=t[1],_=t[2],v=t[3];e[0]=h*f+v*u+d*c-_*l,e[1]=d*f+v*l+_*u-h*c,e[2]=_*f+v*c+h*l-d*u,e[3]=v*f-h*u-d*l-_*c;var p=t[4],m=t[5],E=t[6],T=t[7];return e[4]=p*f+T*u+m*c-E*l,e[5]=m*f+T*l+E*u-p*c,e[6]=E*f+T*c+p*l-m*u,e[7]=T*f-p*u-m*l-E*c,e},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e},t.multiply=a,t.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e},t.lerp=function(e,t,n,r){var i=1-r;return d(t,n)<0&&(r=-r),e[0]=t[0]*i+n[0]*r,e[1]=t[1]*i+n[1]*r,e[2]=t[2]*i+n[2]*r,e[3]=t[3]*i+n[3]*r,e[4]=t[4]*i+n[4]*r,e[5]=t[5]*i+n[5]*r,e[6]=t[6]*i+n[6]*r,e[7]=t[7]*i+n[7]*r,e},t.invert=function(e,t){var n=v(t);return e[0]=-t[0]/n,e[1]=-t[1]/n,e[2]=-t[2]/n,e[3]=t[3]/n,e[4]=-t[4]/n,e[5]=-t[5]/n,e[6]=-t[6]/n,e[7]=t[7]/n,e},t.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e},t.normalize=function(e,t){var n=v(t);if(n>0){n=Math.sqrt(n);var r=t[0]/n,i=t[1]/n,o=t[2]/n,a=t[3]/n,u=t[4],s=t[5],l=t[6],c=t[7],f=r*u+i*s+o*l+a*c;e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=(u-r*f)/n,e[5]=(s-i*f)/n,e[6]=(l-o*f)/n,e[7]=(c-a*f)/n}return e},t.str=function(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],l=e[6],c=e[7],f=t[0],h=t[1],d=t[2],_=t[3],v=t[4],p=t[5],m=t[6],E=t[7];return Math.abs(n-f)<=s.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(r-h)<=s.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-d)<=s.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-_)<=s.EPSILON*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(a-v)<=s.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(u-p)<=s.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))&&Math.abs(l-m)<=s.EPSILON*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(c-E)<=s.EPSILON*Math.max(1,Math.abs(c),Math.abs(E))};var u=n(3),s=r(u),l=n(20),c=r(l),f=n(19),h=r(f),d=(t.getReal=c.copy,t.setReal=c.copy,t.mul=a,t.dot=c.dot),_=t.length=c.length,v=(t.len=_,t.squaredLength=c.squaredLength);t.sqrLen=v},function(e,t,n){"use strict";function r(){var e=new d.ARRAY_TYPE(2);return d.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0),e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function o(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}function a(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}function u(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)}function s(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function l(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)}function c(e){var t=e[0],n=e[1];return t*t+n*n}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.sqrDist=t.dist=t.div=t.mul=t.sub=t.len=void 0,t.create=r,t.clone=function(e){var t=new d.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},t.fromValues=function(e,t){var n=new d.ARRAY_TYPE(2);return n[0]=e,n[1]=t,n},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},t.set=function(e,t,n){return e[0]=t,e[1]=n,e},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e},t.subtract=i,t.multiply=o,t.divide=a,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},t.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e},t.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},t.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e},t.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e},t.distance=u,t.squaredDistance=s,t.length=l,t.squaredLength=c,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},t.normalize=function(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},t.cross=function(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e},t.lerp=function(e,t,n,r){var i=t[0],o=t[1];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e},t.random=function(e,t){t=t||1;var n=2*d.RANDOM()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e},t.transformMat2=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e},t.transformMat2d=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e},t.transformMat3=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e},t.transformMat4=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e},t.rotate=function(e,t,n,r){var i=t[0]-n[0],o=t[1]-n[1],a=Math.sin(r),u=Math.cos(r);return e[0]=i*u-o*a+n[0],e[1]=i*a+o*u+n[1],e},t.angle=function(e,t){var n=e[0],r=e[1],i=t[0],o=t[1],a=n*n+r*r;a>0&&(a=1/Math.sqrt(a));var u=i*i+o*o;u>0&&(u=1/Math.sqrt(u));var s=(n*i+r*o)*a*u;return s>1?0:s<-1?Math.PI:Math.acos(s)},t.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},t.equals=function(e,t){var n=e[0],r=e[1],i=t[0],o=t[1];return Math.abs(n-i)<=d.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=d.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))};var f,h=n(3),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(h);t.len=l,t.sub=i,t.mul=o,t.div=a,t.dist=u,t.sqrDist=s,t.sqrLen=c,t.forEach=(f=r(),function(e,t,n,r,i,o){var a=void 0,u=void 0;for(t||(t=2),n||(n=0),u=r?Math.min(r*t+n,e.length):e.length,a=n;a<u;a+=t)f[0]=e[a],f[1]=e[a+1],i(f,f,o),e[a]=f[0],e[a+1]=f[1];return e})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.getExtension(t);if(!n)return!1;var r=t.split("_")[0],i=new RegExp(r+"$");for(var o in n)if("function"==typeof n[o]){var a=o.replace(i,"");o.substring&&(e[a]=n[o].bind(n))}return!0}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=r(i),a=n(23),u=r(a);t.default=function(){for(var e in u.default)o.default[e]?console.log("already exist : ",e):o.default[e]=u.default[e]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return a||(u=o.default.webgl2?o.default.gl.FLOAT:o.default.getExtension("OES_texture_float")?o.default.gl.FLOAT:(console.warn("USING FLOAT BUT OES_texture_float NOT SUPPORTED"),o.default.gl.UNSIGNED_BYTE)),u};var r,i=n(0),o=(r=i)&&r.__esModule?r:{default:r},a=!1,u=void 0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return a||(u=function(){if(o.default.webgl2)return o.default.gl.HALF_FLOAT;var e=o.default.getExtension("OES_texture_half_float");return e?e.HALF_FLOAT_OES:(console.warn("USING HALF FLOAT BUT OES_texture_half_float NOT SUPPORTED"),o.default.gl.UNSIGNED_BYTE)}()),u};var r,i=n(0),o=(r=i)&&r.__esModule?r:{default:r},a=!1,u=void 0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["EXT_shader_texture_lod","EXT_sRGB","EXT_frag_depth","OES_texture_float","OES_texture_half_float","OES_texture_float_linear","OES_texture_half_float_linear","OES_standard_derivatives","WEBGL_depth_texture","EXT_texture_filter_anisotropic","OES_vertex_array_object","ANGLE_instanced_arrays","WEBGL_draw_buffers"]},function(e,t,n){"use strict";e.exports=function(e){"string"==typeof e&&(e=[e]);for(var t=[].slice.call(arguments,1),n=[],r=0;r<e.length-1;r++)n.push(e[r],t[r]||"");return n.push(e[r]),n.join("")}},function(e,t){e.exports="// basic.frag\n\n#define SHADER_NAME BASIC_FRAGMENT\n\nprecision lowp float;\n#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nuniform float time;\n// uniform sampler2D texture;\n\nvoid main(void) {\n    gl_FragColor = vec4(vTextureCoord, sin(time) * .5 + .5, 1.0);\n}"},function(e,t,n){"use strict";function r(e){return 0!==e&&!(e&e-1)}Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(0),a=(i=o)&&i.__esModule?i:{default:i};t.default=function(e,t,n,i){if(!e.minFilter){var o=a.default.LINEAR;n&&n&&r(n)&&r(i)&&(o=a.default.NEAREST_MIPMAP_LINEAR),e.minFilter=o}return e.mipmap=e.mipmap||!0,e.magFilter=e.magFilter||a.default.LINEAR,e.wrapS=e.wrapS||a.default.CLAMP_TO_EDGE,e.wrapT=e.wrapT||a.default.CLAMP_TO_EDGE,e.internalFormat=e.internalFormat||a.default.RGBA,e.format=e.format||a.default.RGBA,e.premultiplyAlpha=e.premultiplyAlpha||!1,e.level=e.level||0,e}},function(e,t,n){"use strict";function r(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var i=542327876,o=131072,a=4,u=r("DXT1"),s=r("DXT3"),l=r("DXT5"),c=r("DX10"),f=116,h=512,d=3,_=2,v=31,p=0,m=1,E=2,T=3,b=4,g=7,y=20,x=21,M=28;e.exports=function(e){var t=new Int32Array(e,0,v);if(t[p]!==i)throw new Error("Invalid magic number in DDS header");if(!t[y]&a)throw new Error("Unsupported format, must contain a FourCC code");var n,r,R,A=t[x];switch(A){case u:n=8,r="dxt1";break;case s:n=16,r="dxt3";break;case l:n=16,r="dxt5";break;case f:r="rgba32f";break;case c:var w=new Uint32Array(e.slice(128,148));r=w[0];var P=w[1];if(w[2],w[3],w[4],P!==d||r!==_)throw new Error("Unsupported DX10 texture format "+r);r="rgba32f";break;default:throw new Error("Unsupported FourCC code: "+(R=A,String.fromCharCode(255&R,R>>8&255,R>>16&255,R>>24&255)))}var L=t[E],S=1;L&o&&(S=Math.max(1,t[g]));var O=!1;t[M]&h&&(O=!0);var C,I=t[b],N=t[T],F=t[m]+4,D=I,U=N,B=[];if(A===c&&(F+=20),O)for(var k=0;k<6;k++){if("rgba32f"!==r)throw new Error("Only RGBA32f cubemaps are supported");I=D,N=U;for(var V=Math.log(I)/Math.log(2)+1,G=0;G<V;G++)C=I*N*16,B.push({offset:F,length:C,shape:[I,N]}),G<S&&(F+=C),I=Math.floor(I/2),N=Math.floor(N/2)}else for(var G=0;G<S;G++)C=Math.max(4,I)/4*Math.max(4,N)/4*n,B.push({offset:F,length:C,shape:[I,N]}),F+=C,I=Math.floor(I/2),N=Math.floor(N/2);return{shape:[D,U],images:B,format:r,flags:L,cubemap:O}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=r(o),u=n(27),s=r(u),l=void 0,c=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),l=a.default.gl,this._size=t,this.magFilter=n.magFilter||l.LINEAR,this.minFilter=n.minFilter||l.LINEAR,this.wrapS=n.wrapS||l.CLAMP_TO_EDGE,this.wrapT=n.wrapT||l.CLAMP_TO_EDGE,this._init()}return i(e,[{key:"_init",value:function(){this.texture=l.createTexture(),this.glTexture=new s.default(this.texture,{},!0),l.bindTexture(l.TEXTURE_CUBE_MAP,this.texture),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_MAG_FILTER,this.magFilter),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_MIN_FILTER,this.minFilter),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_WRAP_S,this.wrapS),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_WRAP_T,this.wrapT);for(var e=[l.TEXTURE_CUBE_MAP_POSITIVE_X,l.TEXTURE_CUBE_MAP_NEGATIVE_X,l.TEXTURE_CUBE_MAP_POSITIVE_Y,l.TEXTURE_CUBE_MAP_NEGATIVE_Y,l.TEXTURE_CUBE_MAP_POSITIVE_Z,l.TEXTURE_CUBE_MAP_NEGATIVE_Z],t=0;t<e.length;t++)l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!1),l.texImage2D(e[t],0,l.RGBA,this.width,this.height,0,l.RGBA,l.FLOAT,null);this._frameBuffers=[];for(var n=0;n<e.length;n++){var r=l.createFramebuffer();l.bindFramebuffer(l.FRAMEBUFFER,r),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,e[n],this.texture,0);var i=l.checkFramebufferStatus(l.FRAMEBUFFER);i!==l.FRAMEBUFFER_COMPLETE&&console.log("'gl.checkFramebufferStatus() returned '"+i),this._frameBuffers.push(r)}l.bindFramebuffer(l.FRAMEBUFFER,null),l.bindRenderbuffer(l.RENDERBUFFER,null),l.bindTexture(l.TEXTURE_CUBE_MAP,null)}},{key:"bind",value:function(e){a.default.viewport(0,0,this.width,this.height),l.bindFramebuffer(l.FRAMEBUFFER,this._frameBuffers[e])}},{key:"unbind",value:function(){l.bindFramebuffer(l.FRAMEBUFFER,null),a.default.viewport(0,0,a.default.width,a.default.height)}},{key:"getTexture",value:function(){return this.glTexture}},{key:"width",get:function(){return this._size}},{key:"height",get:function(){return this._size}}]),e}();t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return 0!==e&&!(e&e-1)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0),u=r(a),s=n(25),l=r(s),c=void 0,f=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),c=u.default.gl,this.width=t,this.height=n,this.magFilter=r.magFilter||c.LINEAR,this.minFilter=r.minFilter||c.LINEAR,this.wrapS=r.wrapS||c.CLAMP_TO_EDGE,this.wrapT=r.wrapT||c.CLAMP_TO_EDGE,this.useDepth=r.useDepth||!0,this.useStencil=r.useStencil||!1,this.texelType=r.type,this._numSample=r.numSample||8,i(this.width)&&i(this.height)||(this.wrapS=this.wrapT=c.CLAMP_TO_EDGE,this.minFilter===c.LINEAR_MIPMAP_NEAREST&&(this.minFilter=c.LINEAR)),this._init()}return o(e,[{key:"_init",value:function(){var e=c.UNSIGNED_BYTE;this.texelType&&(e=this.texelType),this.texelType=e,this.frameBuffer=c.createFramebuffer(),this.frameBufferColor=c.createFramebuffer(),this.renderBufferColor=c.createRenderbuffer(),this.renderBufferDepth=c.createRenderbuffer(),this.glTexture=this._createTexture(),this.glDepthTexture=this._createTexture(c.DEPTH_COMPONENT16,c.UNSIGNED_SHORT,c.DEPTH_COMPONENT,!0),c.bindRenderbuffer(c.RENDERBUFFER,this.renderBufferColor),c.renderbufferStorageMultisample(c.RENDERBUFFER,this._numSample,c.RGBA8,this.width,this.height),c.bindRenderbuffer(c.RENDERBUFFER,this.renderBufferDepth),c.renderbufferStorageMultisample(c.RENDERBUFFER,this._numSample,c.DEPTH_COMPONENT16,this.width,this.height),c.bindFramebuffer(c.FRAMEBUFFER,this.frameBuffer),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.RENDERBUFFER,this.renderBufferColor),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,this.renderBufferDepth),c.bindFramebuffer(c.FRAMEBUFFER,null),c.bindFramebuffer(c.FRAMEBUFFER,this.frameBufferColor),c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,this.glTexture.texture,0),c.bindFramebuffer(c.FRAMEBUFFER,null)}},{key:"_createTexture",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];void 0===e&&(e=c.RGBA),void 0===t&&(t=this.texelType),n||(n=e);var i=c.createTexture(),o=new l.default(i,!0),a=r?u.default.NEAREST:this.magFilter,s=r?u.default.NEAREST:this.minFilter;return c.bindTexture(c.TEXTURE_2D,i),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,a),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,s),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,this.wrapS),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,this.wrapT),c.texImage2D(c.TEXTURE_2D,0,e,this.width,this.height,0,n,t,null),c.bindTexture(c.TEXTURE_2D,null),o}},{key:"bind",value:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&u.default.viewport(0,0,this.width,this.height),c.bindFramebuffer(c.FRAMEBUFFER,this.frameBuffer)}},{key:"unbind",value:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&u.default.viewport(0,0,u.default.width,u.default.height);var e=this.width,t=this.height;c.bindFramebuffer(c.FRAMEBUFFER,null),c.bindFramebuffer(c.READ_FRAMEBUFFER,this.frameBuffer),c.bindFramebuffer(c.DRAW_FRAMEBUFFER,this.frameBufferColor),c.clearBufferfv(c.COLOR,0,[0,0,0,0]),c.blitFramebuffer(0,0,e,t,0,0,e,t,c.COLOR_BUFFER_BIT,u.default.NEAREST),c.bindFramebuffer(c.FRAMEBUFFER,null)}},{key:"getTexture",value:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.glTexture}},{key:"getDepthTexture",value:function(){return this.glDepthTexture}}]),e}();t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=r(o),u=n(1),s=r(u),l=n(5),c=r(l),f=void 0,h=function(){function e(t,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),f=a.default.gl,this._vs=t,this._fs=n,this._init()}return i(e,[{key:"_init",value:function(){this._meshCurrent=new c.default,this._meshTarget=new c.default,this._numPoints=-1,this._varyings=[],this.transformFeedback=f.createTransformFeedback()}},{key:"bufferData",value:function(e,t,n){var r=!!n;console.log("is Transform feedback ?",t,r),this._meshCurrent.bufferData(e,t,null,f.STREAM_COPY,!1),this._meshTarget.bufferData(e,t,null,f.STREAM_COPY,!1),r&&(this._varyings.push(n),this._numPoints<0&&(this._numPoints=e.length))}},{key:"bufferIndex",value:function(e){this._meshCurrent.bufferIndex(e),this._meshTarget.bufferIndex(e)}},{key:"uniform",value:function(e,t,n){this.shader&&this.shader.uniform(e,t,n)}},{key:"generate",value:function(){this.shader=new s.default(this._vs,this._fs,this._varyings)}},{key:"render",value:function(){this.shader||this.generate(),this.shader.bind(),a.default.drawTransformFeedback(this),this._swap()}},{key:"_swap",value:function(){var e=this._meshCurrent;this._meshCurrent=this._meshTarget,this._meshTarget=e}},{key:"numPoints",get:function(){return this._numPoints}},{key:"meshCurrent",get:function(){return this._meshCurrent}},{key:"meshTarget",get:function(){return this._meshTarget}},{key:"meshSource",get:function(){return this._meshCurrent}},{key:"meshDestination",get:function(){return this._meshTarget}}]),e}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(4),a=(r=o)&&r.__esModule?r:{default:r},u=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.9;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._value=t,this._targetValue=t,this.speed=r,this.decreaseRate=i,this._velocity=0,this._efIndex=a.default.addEF(function(){return n._update()})}return i(e,[{key:"_update",value:function(){this._checkLimit(),Math.abs(this._targetValue-this._value)<1e-4?this._value=this._targetValue:(this._velocity+=(this._targetValue-this._value)*this.speed,this._value+=this._velocity,this._velocity*=this.decreaseRate,Math.abs(this._targetValue-this._value)<1e-4&&(this._value=this._targetValue))}},{key:"limit",value:function(e,t){e>t?this.limit(t,e):(this._min=e,this._max=t,this._checkLimit())}},{key:"_checkLimit",value:function(){void 0!==this._min&&this._targetValue<this._min&&(this._targetValue=this._min),void 0!==this._max&&this._targetValue>this._max&&(this._targetValue=this._max)}},{key:"destroy",value:function(){a.default.removeEF(this._efIndex)}},{key:"value",set:function(e){this._targetValue=e},get:function(){return this._value}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(4),a=(r=o)&&r.__esModule?r:{default:r},u={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t=void 0,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),-n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4))},Out:function(e){var t=void 0,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1)},InOut:function(e){var t=void 0,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),(e*=2)<1?n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*-.5:n*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*.5+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{in:function(e){return 1-u.Bounce.out(1-e)},out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},inOut:function(e){return e<.5?.5*u.Bounce.in(2*e):.5*u.Bounce.out(2*e-1)+.5}}},s=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expOut",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._value=t,this._startValue=t,this._targetValue=t,this._counter=1,this.speed=i,this.easing=r,this._needUpdate=!0,this._efIndex=a.default.addEF(function(){return n._update()})}return i(e,[{key:"_update",value:function(){var e=this._counter+this.speed;e>1&&(e=1),this._counter!==e?(this._counter=e,this._needUpdate=!0):this._needUpdate=!1}},{key:"limit",value:function(e,t){e>t?this.limit(t,e):(this._min=e,this._max=t,this._checkLimit())}},{key:"setTo",value:function(e){this._value=e,this._targetValue=e,this._counter=1}},{key:"_checkLimit",value:function(){void 0!==this._min&&this._targetValue<this._min&&(this._targetValue=this._min),void 0!==this._max&&this._targetValue>this._max&&(this._targetValue=this._max)}},{key:"destroy",value:function(){a.default.removeEF(this._efIndex)}},{key:"value",set:function(e){this._startValue=this._value,this._targetValue=e,this._checkLimit(),this._counter=0},get:function(){if(this._needUpdate){var e=function(e){switch(e){default:case"linear":return u.Linear.None;case"expIn":return u.Exponential.In;case"expOut":return u.Exponential.Out;case"expInOut":return u.Exponential.InOut;case"cubicIn":return u.Cubic.In;case"cubicOut":return u.Cubic.Out;case"cubicInOut":return u.Cubic.InOut;case"quarticIn":return u.Quartic.In;case"quarticOut":return u.Quartic.Out;case"quarticInOut":return u.Quartic.InOut;case"quinticIn":return u.Quintic.In;case"quinticOut":return u.Quintic.Out;case"quinticInOut":return u.Quintic.InOut;case"sinusoidalIn":return u.Sinusoidal.In;case"sinusoidalOut":return u.Sinusoidal.Out;case"sinusoidalInOut":return u.Sinusoidal.InOut;case"circularIn":return u.Circular.In;case"circularOut":return u.Circular.Out;case"circularInOut":return u.Circular.InOut;case"elasticIn":return u.Elastic.In;case"elasticOut":return u.Elastic.Out;case"elasticInOut":return u.Elastic.InOut;case"backIn":return u.Back.In;case"backOut":return u.Back.Out;case"backInOut":return u.Back.InOut;case"bounceIn":return u.Bounce.in;case"bounceOut":return u.Bounce.out;case"bounceInOut":return u.Bounce.inOut}}(this.easing),t=e(this._counter);this._value=this._startValue+t*(this._targetValue-this._startValue),this._needUpdate=!1}return this._value}},{key:"targetValue",get:function(){return this._targetValue}}]),e}();t.default=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),a=n(10),u=r(a),s=n(4),l=r(s),c=function(e,t){var n=t||{};return e.touches?(n.x=e.touches[0].pageX,n.y=e.touches[0].pageY):(n.x=e.clientX,n.y=e.clientY),n},f=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._target=t,this._listenerTarget=r,this.matrix=o.mat4.create(),this.m=o.mat4.create(),this._vZaxis=o.vec3.clone([0,0,0]),this._zAxis=o.vec3.clone([0,0,1]),this.preMouse={x:0,y:0},this.mouse={x:0,y:0},this._isMouseDown=!1,this._rotation=o.quat.create(),this.tempRotation=o.quat.create(),this._rotateZMargin=0,this._offset=.004,this._slerp=-1,this._isLocked=!1,this._diffX=new u.default(0,i),this._diffY=new u.default(0,i),this._listenerTarget.addEventListener("mousedown",function(e){return n._onDown(e)}),this._listenerTarget.addEventListener("touchstart",function(e){return n._onDown(e)}),this._listenerTarget.addEventListener("mousemove",function(e){return n._onMove(e)}),this._listenerTarget.addEventListener("touchmove",function(e){return n._onMove(e)}),window.addEventListener("touchend",function(){return n._onUp()}),window.addEventListener("mouseup",function(){return n._onUp()}),l.default.addEF(function(){return n._loop()})}return i(e,[{key:"inverseControl",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isInvert=e}},{key:"lock",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isLocked=e}},{key:"setCameraPos",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;if(this.easing=t,!(this._slerp>0)){var n=o.quat.clone(this._rotation);this._updateRotation(n),this._rotation=o.quat.clone(n),this._currDiffX=this.diffX=0,this._currDiffY=this.diffY=0,this._isMouseDown=!1,this._isRotateZ=0,this._targetQuat=o.quat.clone(e),this._slerp=1}}},{key:"resetQuat",value:function(){this._rotation=o.quat.clone([0,0,1,0]),this.tempRotation=o.quat.clone([0,0,0,0]),this._targetQuat=void 0,this._slerp=-1}},{key:"_onDown",value:function(e){if(!this._isLocked){var t=c(e),n=o.quat.clone(this._rotation);this._updateRotation(n),this._rotation=n,this._isMouseDown=!0,this._isRotateZ=0,this.preMouse={x:t.x,y:t.y},t.y<this._rotateZMargin||t.y>window.innerHeight-this._rotateZMargin?this._isRotateZ=1:(t.x<this._rotateZMargin||t.x>window.innerWidth-this._rotateZMargin)&&(this._isRotateZ=2),this._diffX.setTo(0),this._diffY.setTo(0)}}},{key:"_onMove",value:function(e){this._isLocked||c(e,this.mouse)}},{key:"_onUp",value:function(){this._isLocked||(this._isMouseDown=!1)}},{key:"_updateRotation",value:function(e){this._isMouseDown&&!this._isLocked&&(this._diffX.value=-(this.mouse.x-this.preMouse.x),this._diffY.value=this.mouse.y-this.preMouse.y,this._isInvert&&(this._diffX.value=-this._diffX.targetValue,this._diffY.value=-this._diffY.targetValue));var t=void 0,n=void 0;if(this._isRotateZ>0)1===this._isRotateZ?(t=-this._diffX.value*this._offset,t*=this.preMouse.y<this._rotateZMargin?-1:1,n=o.quat.clone([0,0,Math.sin(t),Math.cos(t)]),o.quat.multiply(n,e,n)):(t=-this._diffY.value*this._offset,t*=this.preMouse.x<this._rotateZMargin?1:-1,n=o.quat.clone([0,0,Math.sin(t),Math.cos(t)]),o.quat.multiply(n,e,n));else{var r=o.vec3.clone([this._diffX.value,this._diffY.value,0]),i=o.vec3.create();o.vec3.cross(i,r,this._zAxis),o.vec3.normalize(i,i),t=o.vec3.length(r)*this._offset,n=o.quat.clone([Math.sin(t)*i[0],Math.sin(t)*i[1],Math.sin(t)*i[2],Math.cos(t)]),o.quat.multiply(e,n,e)}}},{key:"_loop",value:function(){o.mat4.identity(this.m),void 0===this._targetQuat?(o.quat.set(this.tempRotation,this._rotation[0],this._rotation[1],this._rotation[2],this._rotation[3]),this._updateRotation(this.tempRotation)):(this._slerp+=.1*(0-this._slerp),this._slerp<5e-4?(o.quat.copy(this._rotation,this._targetQuat),o.quat.copy(this.tempRotation,this._targetQuat),this._targetQuat=void 0,this._diffX.setTo(0),this._diffY.setTo(0),this._slerp=-1):(o.quat.set(this.tempRotation,0,0,0,0),o.quat.slerp(this.tempRotation,this._targetQuat,this._rotation,this._slerp))),o.vec3.transformQuat(this._vZaxis,this._vZaxis,this.tempRotation),o.mat4.fromQuat(this.matrix,this.tempRotation)}},{key:"easing",set:function(e){this._diffX.easing=e,this._diffY.easing=e},get:function(){return this._diffX.easing}}]),e}();t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=r(o),u=n(29),s=r(u),l=n(11),c=r(l),f=n(58),h=r(f),d=function(e){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o._mesh=e,o._mesh.generateFaces(),o._camera=n,o.faceVertices=e.faces.map(function(e){return e.vertices}),o.clickTolerance=8,o._ray=new c.default([0,0,0],[0,0,-1]),o._hit=vec3.fromValues(-999,-999,-999),o._lastPos,o._firstPos,o.mtxModel=mat4.create(),o._listenerTarget=i,o._skippingMove=r,o._onMoveBind=function(e){return o._onMove(e)},o._onDownBind=function(e){return o._onDown(e)},o._onUpBind=function(){return o._onUp()},o.connect(),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"connect",value:function(){this._listenerTarget.addEventListener("mousedown",this._onDownBind),this._listenerTarget.addEventListener("mousemove",this._onMoveBind),this._listenerTarget.addEventListener("mouseup",this._onUpBind)}},{key:"disconnect",value:function(){this._listenerTarget.removeEventListener("mousedown",this._onDownBind),this._listenerTarget.removeEventListener("mousemove",this._onMoveBind),this._listenerTarget.removeEventListener("mouseup",this._onUpBind)}},{key:"_checkHit",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"onHit",n=this._camera;if(n){var r=this._lastPos.x/a.default.width*2-1,i=-this._lastPos.y/a.default.height*2+1;n.generateRay([r,i,0],this._ray);for(var o=void 0,u=vec3.create(),s=vec3.create(),l=vec3.create(),c=0,f=function(t,n){vec3.transformMat4(n,t,e.mtxModel)},h=0;h<this.faceVertices.length;h++){var d=this.faceVertices[h];f(d[0],u),f(d[1],s),f(d[2],l);var _=this._ray.intersectTriangle(u,s,l);if(_)if(o){var v=vec3.dist(_,n.position);v<c&&(o=vec3.clone(_),c=v)}else o=vec3.clone(_),c=vec3.dist(o,n.position)}o?(this._hit=vec3.clone(o),this.dispatchCustomEvent(t,{hit:o})):this.dispatchCustomEvent("onUp")}}},{key:"_onDown",value:function(e){this._firstPos=(0,h.default)(e),this._lastPos=(0,h.default)(e),this._checkHit("onDown")}},{key:"_onMove",value:function(e){this._lastPos=(0,h.default)(e),this._skippingMove||this._checkHit()}},{key:"_onUp",value:function(){var e,t,n,r;e=this._firstPos,t=this._lastPos,n=e.x-t.x,r=e.y-t.y,Math.sqrt(n*n+r*r)<this.clickTolerance&&this._checkHit()}}]),t}(s.default);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=void 0,n=void 0;return e.touches?(t=e.touches[0].pageX,n=e.touches[0].pageY):(t=e.clientX,n=e.clientY),{x:t,y:n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(13),a=(r=o)&&r.__esModule?r:{default:r},u=n(2),s=[[u.vec3.fromValues(0,0,0),u.vec3.fromValues(1,0,0),u.vec3.fromValues(0,-1,0)],[u.vec3.fromValues(0,0,0),u.vec3.fromValues(-1,0,0),u.vec3.fromValues(0,-1,0)],[u.vec3.fromValues(0,0,0),u.vec3.fromValues(0,1,0),u.vec3.fromValues(0,0,1)],[u.vec3.fromValues(0,0,0),u.vec3.fromValues(0,-1,0),u.vec3.fromValues(0,0,-1)],[u.vec3.fromValues(0,0,0),u.vec3.fromValues(0,0,1),u.vec3.fromValues(0,-1,0)],[u.vec3.fromValues(0,0,0),u.vec3.fromValues(0,0,-1),u.vec3.fromValues(0,-1,0)]],l=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.setPerspective(Math.PI/2,1,.1,1e3),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"face",value:function(e){var t=s[e];this.lookAt(t[0],t[1],t[2])}}]),t}(a.default);t.default=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},a=n(14),u=r(a),s=n(5),l=r(s),c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"load",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;this._drawType=r,o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"load",this).call(this,e,n)}},{key:"_onLoaded",value:function(){this.parseObj(this._req.response)}},{key:"parseObj",value:function(e){function t(e){var t=parseInt(e);return 3*(t>=0?t-1:t+h.length/3)}function n(e){var t=parseInt(e);return 3*(t>=0?t-1:t+d.length/3)}function r(e){var t=parseInt(e);return 2*(t>=0?t-1:t+_.length/2)}function i(e,t,n){l.push([h[e],h[e+1],h[e+2]]),l.push([h[t],h[t+1],h[t+2]]),l.push([h[n],h[n+1],h[n+2]]),v.push(3*p+0),v.push(3*p+1),v.push(3*p+2),p++}function o(e,t,n){c.push([_[e],_[e+1]]),c.push([_[t],_[t+1]]),c.push([_[n],_[n+1]])}function a(e,t,n){f.push([d[e],d[e+1],d[e+2]]),f.push([d[t],d[t+1],d[t+2]]),f.push([d[n],d[n+1],d[n+2]])}function u(e,u,s,l,c,f,h,d,_,v,p,m){var E=t(e),T=t(u),b=t(s),g=void 0;void 0===l?i(E,T,b):(g=t(l),i(E,T,g),i(T,b,g)),void 0!==c&&(E=r(c),T=r(f),b=r(h),void 0===l?o(E,T,b):(g=r(d),o(E,T,g),o(T,b,g))),void 0!==_&&(E=n(_),T=n(v),b=n(p),void 0===l?a(E,T,b):(g=n(m),a(E,T,g),a(T,b,g)))}for(var s=e.split("\n"),l=[],c=[],f=[],h=[],d=[],_=[],v=[],p=0,m=void 0,E=/v( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,T=/vn( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,b=/vt( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,g=/f( +-?\d+)( +-?\d+)( +-?\d+)( +-?\d+)?/,y=/f( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))?/,x=/f( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))?/,M=/f( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))?/,R=0;R<s.length;R++){var A=s[R];0!==(A=A.trim()).length&&"#"!==A.charAt(0)&&(null!==(m=E.exec(A))?h.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3])):null!==(m=T.exec(A))?d.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3])):null!==(m=b.exec(A))?_.push(parseFloat(m[1]),parseFloat(m[2])):null!==(m=g.exec(A))?u(m[1],m[2],m[3],m[4]):null!==(m=y.exec(A))?u(m[2],m[5],m[8],m[11],m[3],m[6],m[9],m[12]):null!==(m=x.exec(A))?u(m[2],m[6],m[10],m[14],m[3],m[7],m[11],m[15],m[4],m[8],m[12],m[16]):null!==(m=M.exec(A))&&u(m[2],m[5],m[8],m[11],void 0,void 0,void 0,void 0,m[3],m[6],m[9],m[12]))}return this._generateMeshes({positions:l,coords:c,normals:f,indices:v})}},{key:"_generateMeshes",value:function(e){var t=e.normals.length>0,n=e.coords.length>0,r=void 0;if(e.positions.length>65535){var i=[],o=0,a={};for(a.positions=e.positions.concat(),a.coords=e.coords.concat(),a.indices=e.indices.concat(),a.normals=e.normals.concat();e.indices.length>0;){for(var u=Math.min(65535,e.positions.length),s=e.indices.splice(0,u),c=[],f=[],h=[],d=void 0,_=0,v=0;v<s.length;v++)s[v]>_&&(_=s[v]),d=s[v],c.push(a.positions[d]),n&&f.push(a.coords[d]),t&&h.push(a.normals[d]),s[v]-=o;o=_+1,(r=new l.default(this._drawType)).bufferVertex(c),n&&r.bufferTexCoord(f),r.bufferIndex(s),t&&r.bufferNormal(h),i.push(r)}return this._callback&&this._callback(i,a),i}return(r=new l.default(this._drawType)).bufferVertex(e.positions),n&&r.bufferTexCoord(e.coords),r.bufferIndex(e.indices),t&&r.bufferNormal(e.normals),this._callback&&this._callback(r,e),r}}]),t}(u.default);c.parse=function(e){return(new c).parseObj(e)},t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(14),a=r(o),u=n(62),s=r(u),l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,!0))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"parse",value:function(e){return(0,s.default)(e)}},{key:"_onLoaded",value:function(){var e=this.parse(this._req.response);this._callback&&this._callback(e)}}]),t}(a.default);l.parse=function(e){return(0,s.default)(e)},t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="#\\?RADIANCE",i="#.*",o="EXPOSURE=\\s*([0-9]*[.][0-9]*)",a="FORMAT=32-bit_rle_rgbe",u="-Y ([0-9]+) \\+X ([0-9]+)";t.default=function(e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));for(var t=0,n=e.length,s=0,l=0,c=1,f=!1,h=0;h<20;h++){var d=function(){var r="";do{var i=e[t];if(10===i){++t;break}r+=String.fromCharCode(i)}while(++t<n);return r}(),_=void 0;if(_=d.match(r));else if(_=d.match(a))f=!0;else if(_=d.match(o))c=Number(_[1]);else if(_=d.match(i));else if(_=d.match(u)){l=Number(_[1]),s=Number(_[2]);break}}if(!f)throw new Error("File is not run length encoded!");var v=new Uint8Array(s*l*4);!function(e,t,n,r,i,o){function a(t){var n=0;do{t[n++]=e[r]}while(++r<_&&n<t.length);return n}function u(t,n,i){var o=0;do{t[n+o++]=e[r]}while(++r<_&&o<i);return o}for(var s=new Array(4),l=null,c=void 0,f=void 0,h=void 0,d=new Array(2),_=e.length;o>0;){if(a(s)<s.length)throw new Error("Error reading bytes: expected "+s.length);if(2!==s[0]||2!==s[1]||0!=(128&s[2]))return t[n++]=s[0],t[n++]=s[1],t[n++]=s[2],t[n++]=s[3],void function(e,t,n,r){var i=4*r,o=u(t,n,i);if(o<i)throw new Error("Error reading raw pixels: got "+o+" bytes, expected "+i)}(0,t,n,i*o-1);if(((255&s[2])<<8|255&s[3])!==i)throw new Error("Wrong scanline width "+((255&s[2])<<8|255&s[3])+", expected "+i);null===l&&(l=new Array(4*i)),c=0;for(var v=0;v<4;v++)for(f=(v+1)*i;c<f;){if(a(d)<d.length)throw new Error("Error reading 2-byte buffer");if((255&d[0])>128){if(0==(h=(255&d[0])-128)||h>f-c)throw new Error("Bad scanline data");for(;h-- >0;)l[c++]=d[1]}else{if(0==(h=255&d[0])||h>f-c)throw new Error("Bad scanline data");if(l[c++]=d[1],--h>0){if(u(l,c,h)<h)throw new Error("Error reading non-run data");c+=h}}}for(var p=0;p<i;p++)t[n+0]=l[p],t[n+1]=l[p+i],t[n+2]=l[p+2*i],t[n+3]=l[p+3*i],n+=4;o--}}(e,v,0,t,s,l);for(var p=new Float32Array(s*l*4),m=0;m<v.length;m+=4){var E=v[m+0]/255,T=v[m+1]/255,b=v[m+2]/255,g=v[m+3],y=Math.pow(2,g-128);E*=y,T*=y,b*=y;var x=m;p[x+0]=E,p[x+1]=T,p[x+2]=b,p[x+3]=1}return{shape:[s,l],exposure:c,gamma:1,data:p}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(5),o=(r=i)&&r.__esModule?r:{default:r},a={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},u={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},s={NORMAL:"aNormal",POSITION:"aVertexPosition",TEXCOORD_0:"aTextureCoord",WEIGHTS_0:"aWeight",JOINTS_0:"aJoint",COLOR:"aColor"},l=function(e,t){return new Promise(function(n,r){var i=e.bufferViews;e.buffers,i.forEach(function(e,n){var r=t;e.data=r.slice(e.byteOffset||0,(e.byteOffset||0)+(e.byteLength||0))}),n(e)})},c=function(e){return new Promise(function(t,n){var r=e.meshes;e.geometries=[],r.forEach(function(t,n){var r=t.primitives,i={};r.forEach(function(t,n){var r=Object.keys(t.attributes),a={};if(r.forEach(function(n,r){var o=t.attributes[n],l=e.accessors[o],c=s[n];if(c){"NORMAL"===n&&(a.HAS_NORMALS=1),n.indexOf("TEXCOORD")>-1&&(a.HAS_UV=1);var h=u[l.type],d=f(e,o);d instanceof Uint32Array&&(d=new Float32Array(d)),"TEXCOORD_1"===n&&console.log(h,d),i[c]={value:d,size:h}}}),null!=t.indices){var l=f(e,t.indices,!0);i.indices={value:l,size:1}}var c=new o.default;for(var h in i){var d=i[h];"indices"!==h?c.bufferFlattenData(d.value,h,d.size):c.bufferIndex(d.value)}if(e.output.meshes.push(c),t.material){console.log("gltf.output",e.output,t.material);var _=e.output.materials[t.material];c.material=_,a=objectAssign(a,c.material.defines),c.defines=a;var v=Shaders.get(ShaderLibs.gltfVert,ShaderLibs.gltfFrag,a),p=_.emissiveFacotr,m=_.normalTexture,E=_.occlusionTexture,T=_.pbrMetallicRoughness,b=T.baseColorTexture,g=T.metallicRoughnessTexture,y={uEmissiveFactor:p||[0,0,0],uBaseColor:T.baseColorFactor||[1,1,1,1],uRoughness:T.roughnessFactor||1,uMetallic:T.metallicFactor||1,uScaleDiffBaseMR:[0,0,0,0],uScaleFGDSpec:[0,0,0,0],uScaleIBLAmbient:[1,1,1,1],uLightDirection:[1,1,1],uLightColor:[1,1,1],uGamma:1};b&&(y.uColorMap=b.glTexture),g&&(y.uMetallicRoughnessMap=g.glTexture),m&&(y.uNormalScale=m.scale||1,y.uNormalMap=m.glTexture),E&&(y.uAoMap=E.glTexture,y.uOcclusionStrength=E.strength||1),v.bind(),v.uniform(y),c.material.shader=v,c.material.uniforms=y}e.geometries.push(i)})}),t(e)})},f=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.accessors[t],i=e.bufferViews[r.bufferView].data,o=r.byteOffset||0,s=a[r.componentType]||Float32Array,l=u[r.type];null==l&&n&&(l=1);var c=new s(i,o,l*r.count),f=r.extensions&&r.extensions.WEB3D_quantized_attributes;if(f){for(var h=new Float32Array(l*r.count),d=f.decodeMatrix,_=new Array(l),v=new Array(l),p=0;p<l;p++)_[p]=d[l*(l+1)+p],v[p]=d[p*(l+1)+p];for(var m=0;m<r.count;m++)for(var E=0;E<l;E++)h[m*l+E]=c[m*l+E]*v[E]+_[E];c=h}return c};t.default={parse:function(e,t){return new Promise(function(n,r){e.output={meshes:[],scenes:[],textures:[]},l(e,t).then(c).then(function(e){n(e)}).catch(function(e){console.log("Error:",e)})})}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(7),a=r(o),u=n(1),s=r(u),l=n(6),c=r(l),f=n(15),h=r(f),d=n(16),_=r(d),v=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=a.default.bigTriangle(),n=new s.default(h.default,_.default),r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return n.bind(),n.uniform("texture","uniform1i",0),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"draw",value:function(e){this.shader.bind(),e.bind(0),function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this)}}]),t}(c.default);t.default=v},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=r(i),a=n(5),u=r(a),s=n(1),l=r(s),c=n(6),f=r(c),h=n(66),d=r(h),_=n(67),v=r(_),p=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=[],n=[],r=9999;e.push([-r,0,0]),e.push([r,0,0]),e.push([0,-r,0]),e.push([0,r,0]),e.push([0,0,-r]),e.push([0,0,r]),n.push([1,0,0]),n.push([1,0,0]),n.push([0,1,0]),n.push([0,1,0]),n.push([0,0,1]),n.push([0,0,1]);var i=new u.default(o.default.LINES);i.bufferVertex(e),i.bufferIndex([0,1,2,3,4,5]),i.bufferData(n,"aColor",3);var a=new l.default(d.default,v.default);return function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i,a))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(f.default);t.default=p},function(e,t){e.exports="// axis.vert\n\n#define SHADER_NAME BASIC_VERTEX\n\nprecision highp float;\n#define GLSLIFY 1\nattribute vec3 aVertexPosition;\nattribute vec3 aColor;\nattribute vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec3 vColor;\nvarying vec3 vNormal;\n\nvoid main(void) {\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n    vColor = aColor;\n    vNormal = aNormal;\n}"},function(e,t){e.exports="// axis.frag\n\n#define SHADER_NAME SIMPLE_TEXTURE\n\nprecision lowp float;\n#define GLSLIFY 1\nvarying vec3 vColor;\nvarying vec3 vNormal;\n\nvoid main(void) {\n\t// vec3 color = vNormal;\n\tvec3 color = vColor + vNormal * 0.0001;\n    gl_FragColor = vec4(color, 1.0);\n}"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},a=n(7),u=r(a),s=n(1),l=r(s),c=n(6),f=r(c),h=n(33),d=r(h),_=n(17),v=r(_),p=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=u.default.sphere(1,24),n=new l.default(d.default,v.default);return function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1,1],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.shader.bind(),this.shader.uniform("position","uniform3fv",e),this.shader.uniform("scale","uniform3fv",n),this.shader.uniform("color","uniform3fv",r),this.shader.uniform("opacity","uniform1f",i),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this)}}]),t}(f.default);t.default=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=r(o),u=n(5),s=r(u),l=n(1),c=r(l),f=n(6),h=r(f),d=n(70),_=r(d),v=n(71),p=r(v),m=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=[],n=[],r=0,i=void 0,o=void 0;for(i=-100;i<100;i+=1)for(o=-100;o<100;o+=1)e.push([i,o,0]),n.push(r),r++,e.push([i,0,o]),n.push(r),r++;var u=new s.default(a.default.POINTS);u.bufferVertex(e),u.bufferIndex(n);var l=new c.default(_.default,p.default),f=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,u,l));return f.color=[1,1,1],f.opacity=.65,f}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"draw",value:function(){this.shader.bind(),this.shader.uniform("color","uniform3fv",this.color),this.shader.uniform("opacity","uniform1f",this.opacity),this.shader.uniform("viewport","vec2",[a.default.width,a.default.height]),function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this)}}]),t}(h.default);t.default=m},function(e,t){e.exports="// basic.vert\n\n#define SHADER_NAME DOTS_PLANE_VERTEX\n\nprecision highp float;\n#define GLSLIFY 1\nattribute vec3 aVertexPosition;\nattribute vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform vec2 viewport;\n\nvarying vec3 vNormal;\n\nconst float radius = 0.008;\n\nvoid main(void) {\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition + aNormal * 0.000001, 1.0);\n    // gl_PointSize = 1.0;\n    vNormal = aNormal;\n\n\tfloat distOffset = viewport.y * uProjectionMatrix[1][1] * radius / gl_Position.w;\n    gl_PointSize = distOffset;\n}"},function(e,t){e.exports="// dotsPlane.frag\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform vec3 color;\nuniform float opacity;\n\nvoid main(void) {\n\tif(distance(gl_PointCoord, vec2(.5)) > .5) {\n\t\tdiscard;\n\t}\n    gl_FragColor = vec4(color, opacity);\n}"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},a=n(0),u=r(a),s=n(5),l=r(s),c=n(1),f=r(c),h=n(6),d=r(h),_=n(9),v=n(17),p=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=[];e.push([0,0,0]),e.push([0,0,0]);var n=new l.default(u.default.LINES);n.bufferVertex(e),n.bufferTexCoord([[0,0],[1,1]]),n.bufferIndex([0,1]);var r=new f.default(_,v);return function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"draw",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1,1],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this._mesh.bufferVertex([e,n]),this._shader.bind(),this._shader.uniform("color","vec3",r),this._shader.uniform("opacity","float",i),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this)}}]),t}(d.default);t.default=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(7),a=r(o),u=n(1),s=r(u),l=n(6),c=r(l),f=n(34),h=n(35),d=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=a.default.skybox(e),r=new s.default(f,h);return function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"draw",value:function(e){this.shader.bind(),e.bind(0),function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this)}}]),t}(c.default);t.default=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(7),a=r(o),u=n(1),s=r(u),l=n(6),c=r(l),f=n(75),h=n(16),d=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=a.default.sphere(e,n,!0),i=new s.default(f,h);return function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,i))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"draw",value:function(e){this.shader.bind(),e.bind(0),function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this)}}]),t}(c.default);t.default=d},function(e,t){e.exports="// sky.vert\n\nprecision highp float;\n#define GLSLIFY 1\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vNormal;\n\nvoid main(void) {\n\tmat4 matView = uViewMatrix;\n\tmatView[3][0] = 0.0;\n\tmatView[3][1] = 0.0;\n\tmatView[3][2] = 0.0;\n\t\n    gl_Position = uProjectionMatrix * matView * uModelMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n    vNormal = aNormal;\n}"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=r(o),u=n(7),s=r(u),l=n(1),c=r(l),f=n(6),h=r(f),d=n(15),_=n(77),v=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=s.default.bigTriangle(),n=new c.default(d,_),r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return n.bind(),n.uniform("texture","uniform1i",0),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"draw",value:function(e){this.shader.bind(),e.bind(0),this.shader.uniform("uResolution","vec2",[1/a.default.width,1/a.default.height]),function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this)}}]),t}(h.default);t.default=v},function(e,t){e.exports="// fxaa.frag\n\n#define SHADER_NAME FXAA\n\nprecision highp float;\n#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\nuniform vec2 uResolution;\n\n\nfloat FXAA_SUBPIX_SHIFT = 1.0/4.0;\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#define FXAA_SPAN_MAX     8.0\n\n\nvec4 applyFXAA(sampler2D tex) {\n    vec4 color;\n    vec2 fragCoord = gl_FragCoord.xy;\n    vec3 rgbNW = texture2D(tex, (fragCoord + vec2(-1.0, -1.0)) * uResolution).xyz;\n    vec3 rgbNE = texture2D(tex, (fragCoord + vec2(1.0, -1.0)) * uResolution).xyz;\n    vec3 rgbSW = texture2D(tex, (fragCoord + vec2(-1.0, 1.0)) * uResolution).xyz;\n    vec3 rgbSE = texture2D(tex, (fragCoord + vec2(1.0, 1.0)) * uResolution).xyz;\n    vec3 rgbM  = texture2D(tex, fragCoord  * uResolution).xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n              dir * rcpDirMin)) * uResolution;\n\n    vec3 rgbA = 0.5 * (\n        texture2D(tex, fragCoord * uResolution + dir * (1.0 / 3.0 - 0.5)).xyz +\n        texture2D(tex, fragCoord * uResolution + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n        texture2D(tex, fragCoord * uResolution + dir * -0.5).xyz +\n        texture2D(tex, fragCoord * uResolution + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, 1.0);\n    else\n        color = vec4(rgbB, 1.0);\n    return color;\n}\n\nvoid main(void) {\n \tvec4 color = applyFXAA(texture);\n    gl_FragColor = color;\n}"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(4),a=r(o),u=n(0),s=r(u),l=n(13),c=r(l),f=n(31),h=r(f),d=n(30),_=r(d),v=function(){function e(){var t=this;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._children=[],this._matrixIdentity=mat4.create(),s.default.enableAlphaBlending(),this._init(),this._initTextures(),this._initViews(),this._efIndex=a.default.addEF(function(){return t._loop()}),window.addEventListener("resize",function(){return t.resize()})}return i(e,[{key:"update",value:function(){}},{key:"render",value:function(){}},{key:"stop",value:function(){-1!==this._efIndex&&(this._efIndex=a.default.removeEF(this._efIndex))}},{key:"start",value:function(){var e=this;-1===this._efIndex&&(this._efIndex=a.default.addEF(function(){return e._loop()}))}},{key:"resize",value:function(){s.default.setSize(window.innerWidth,window.innerHeight),this.camera.setAspectRatio(s.default.aspectRatio)}},{key:"addChild",value:function(e){this._children.push(e)}},{key:"removeChild",value:function(e){var t=this._children.indexOf(e);-1!=t?this._children.splice(t,1):console.warn("Child no exist")}},{key:"_initTextures",value:function(){}},{key:"_initViews",value:function(){}},{key:"_renderChildren",value:function(){for(var e=0;e<this._children.length;e++)this._children[e].toRender();s.default.rotate(this._matrixIdentity)}},{key:"_init",value:function(){this.camera=new c.default,this.camera.setPerspective(45*Math.PI/180,s.default.aspectRatio,.1,100),this.orbitalControl=new _.default(this.camera,window,15),this.orbitalControl.radius.value=10,this.cameraOrtho=new h.default}},{key:"_loop",value:function(){s.default.viewport(0,0,s.default.width,s.default.height),s.default.setMatrices(this.camera),this.update(),this._renderChildren(),this.render()}}]),e}();t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),a=(r=o)&&r.__esModule?r:{default:r},u=function(){function e(t,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.shader=new a.default(t,n),this._init()}return i(e,[{key:"_init",value:function(){}},{key:"render",value:function(){}}]),e}();t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(32),a=r(o),u=n(1),s=r(u),l=n(0),c=(r(l),function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r._children=[],r.shader=new s.default(e,n),r._init(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"_init",value:function(){}},{key:"render",value:function(){}}]),t}(a.default));t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=r(o),u=n(5),s=r(u),l=n(1),c=r(l),f=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._uniforms={},this._uniformTextures=[],this._fbo,this._clearColor={r:0,g:0,b:0,a:0},this}return i(e,[{key:"setClearColor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this._clearColor.r=e,this._clearColor.g=t,this._clearColor.b=n,this._clearColor.a=r,this}},{key:"useProgram",value:function(e,t){return e instanceof c.default?this._shader=e:this._shader=new c.default(e,t),this}},{key:"setMesh",value:function(e){return this._mesh=e,this}},{key:"createMesh",value:function(e){return this._mesh=new s.default(e),this}},{key:"bufferVertex",value:function(e){return this._mesh||(this._mesh=new s.default),this._mesh.bufferVertex(e),this}},{key:"bufferTexCoord",value:function(e){return this._mesh||(this._mesh=new s.default),this._mesh.bufferTexCoord(e),this}},{key:"bufferNormal",value:function(e){return this._mesh||(this._mesh=new s.default),this._mesh.bufferNormal(e),this}},{key:"bufferIndex",value:function(e){return this._mesh||(this._mesh=new s.default),this._mesh.bufferIndex(e),this}},{key:"bufferInstance",value:function(e,t){return this._mesh?(this._mesh.bufferInstance(e,t),this):(console.warn("Need to create mesh first"),this)}},{key:"bufferData",value:function(e,t){return this._mesh||(this._mesh=new s.default),this._mesh.bufferData(e,t),this}},{key:"uniform",value:function(e,t,n){return this._uniforms[e]={type:t,value:n},this}},{key:"uniformTexture",value:function(e,t,n){return void 0!==n?this._uniformTextures[n]={name:e,texture:t}:this._uniformTextures.push({name:e,texture:t}),this}},{key:"bindFrameBuffer",value:function(e){return this._fbo=e,this}},{key:"draw",value:function(){var e=this;if(this._shader&&this._mesh){if(this._fbo){var t=this._clearColor,n=t.r,r=t.g,i=t.b,o=t.a;this._fbo.bind(),a.default.clear(n,r,i,o)}for(var u in this._shader.bind(),this._uniforms){var s=this._uniforms[u];this._shader.uniform(u,s.type,s.value)}return this._uniformTextures.forEach(function(t,n){void 0!==t&&(e._shader.uniform(t.name,"uniform1i",n),t.texture.bind(n))}),a.default.draw(this._mesh),this._fbo&&this._fbo.unbind(),this}}},{key:"shader",get:function(){return this._shader}},{key:"framebuffer",get:function(){return this._fbo}}]),e}();t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(17),o=r(i),a=n(15),u=r(a),s=n(33),l=r(s),c=n(16),f=r(c),h=n(9),d=r(h),_=n(34),v=r(_),p=n(35),m=r(p),E={simpleColorFrag:o.default,bigTriangleVert:u.default,generalVert:l.default,copyFrag:f.default,basicVert:d.default,skyboxVert:v.default,skyboxFrag:m.default};t.default=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(36),o=(r=i)&&r.__esModule?r:{default:r},a=function(e){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,2,e,n,r,i))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(o.default);t.default=a}])},function(e,t,n){"use strict";var r=n(14).EventEmitter;function i(){r.call(this),this.setMaxListeners(20)}i.prototype=Object.create(r.prototype),i.prototype.constructor=i,i.prototype.off=function(e,t){return t?this.removeListener(e,t):e?this.removeAllListeners(e):this.removeAllListeners()},e.exports=i},function(e,t,n){"use strict";e.exports={mbs:0,secs:0,update:function(e,t,n,r){var i,o=e.getAllResponseHeaders();if(o){var a=o.match(/content-length: (\d+)/i);a&&a.length&&(i=a[1])}if(i){var u=(i=parseInt(i,10))/1024/1024,s=(Date.now()-t)/1e3;this.secs+=s,this.mbs+=u,r&&this.log(n,u,s)}else r&&console.warn.call(console,"Can't get Content-Length:",n)},log:function(e,t,n){if(e){var r="File loaded: "+e.substr(e.lastIndexOf("/")+1)+" size:"+t.toFixed(2)+"mb time:"+n.toFixed(2)+"s speed:"+(t/n).toFixed(2)+"mbps";console.log.call(console,r)}var i="Total loaded: "+this.mbs.toFixed(2)+"mb time:"+this.secs.toFixed(2)+"s speed:"+this.getMbps().toFixed(2)+"mbps";console.log.call(console,i)},getMbps:function(){return this.mbs/this.secs}}},function(e,t,n){"use strict";const r=new RegExp("[^#a-f\\d]","gi"),i=new RegExp("^#?[a-f\\d]{3}[a-f\\d]?$|^#?[a-f\\d]{6}([a-f\\d]{2})?$","i");e.exports=function(e,t={}){if("string"!=typeof e||r.test(e)||!i.test(e))throw new TypeError("Expected a valid hex string");let n=255;8===(e=e.replace(/^#/,"")).length&&(n=parseInt(e.slice(6,8),16)/255,e=e.substring(0,6)),4===e.length&&(n=parseInt(e.slice(3,4).repeat(2),16)/255,e=e.substring(0,3)),3===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);const o=parseInt(e,16),a=o>>16,u=o>>8&255,s=255&o;return"array"===t.format?[a,u,s,n]:{red:a,green:u,blue:s,alpha:n}}},function(e,t,n){"use strict";var r=n(13);r.stats=n(2),e.exports=r},,,function(e,t,n){var r=n(8);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(10)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(9)(!1)).push([e.i,"html, body {\n  width: 100%;\n  height: 100%;\n  margin: 0;\n  padding: 0;\n  overflow: hidden;\n  position: static;\n  /* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#6d6d6d+0,000000+100 */\n  background: #333333;\n  /* Old browsers */\n  background: -moz-radial-gradient(center, ellipse cover, #333333 0%, #000000 100%);\n  /* FF3.6-15 */\n  background: -webkit-radial-gradient(center, ellipse cover, #333333 0%, #000000 100%);\n  /* Chrome10-25,Safari5.1-6 */\n  background: radial-gradient(ellipse at center, #333333 0%, #000000 100%);\n  /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */ }\n\nhtml {\n  -webkit-text-size-adjust: none;\n  -moz-text-size-adjust: none;\n  text-size-adjust: none; }\n\nh1, h2, h3, h4, text, p {\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-webkit-font-smoothing: antialiased;\n  font-family: 'Open Sans', sans-serif;\n  pointer-events: none; }\n\n.Main-Canvas {\n  user-select: none;\n  opacity: 1;\n  transition: opacity .5s ease-out .25s;\n  top: auto;\n  left: auto; }\n  .isLoading .Main-Canvas {\n    opacity: 0; }\n\n.container {\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  top: 0;\n  left: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center; }\n\n.Message {\n  position: absolute;\n  z-index: 999;\n  width: 100%;\n  top: calc(50% - 50px);\n  text-align: center;\n  letter-spacing: 11px;\n  color: white;\n  opacity: 0;\n  transition: opacity .5s ease-out, letter-spacing .5s ease-out; }\n  .isLoading .Message {\n    letter-spacing: 10px;\n    opacity: 1; }\n\n.link {\n  color: white;\n  position: fixed;\n  left: 0;\n  bottom: 0;\n  margin: 20px;\n  text-decoration: none;\n  font-size: 13px;\n  letter-spacing: 1px;\n  z-index: 9999;\n  opacity: 0;\n  pointer-events: none;\n  transition: opacity\t.5s ease-out; }\n  .showLink .link {\n    opacity: 1;\n    pointer-events: auto; }\n\n.Loading-Bar {\n  position: absolute;\n  z-index: 998;\n  width: 0%;\n  height: 1px;\n  top: 50%;\n  background: rgba(255, 255, 255, 0.5);\n  opacity: 0;\n  transition: width .5s ease-out, opacity .5s ease-out; }\n  .isLoading .Loading-Bar {\n    opacity: 1; }\n\n.desc {\n  color: white;\n  z-index: 9999;\n  position: absolute;\n  left: 0;\n  bottom: 30px;\n  text-align: center;\n  font-size: 12px;\n  width: 100%;\n  letter-spacing: 2px; }\n",""])},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var i=(a=r,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),o=r.sources.map(function(e){return"/*# sourceURL="+r.sourceRoot+e+" */"});return[n].concat(o).concat([i]).join("\n")}var a;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];null!=o&&(r[o]=!0)}for(i=0;i<e.length;i++){var a=e[i];null!=a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(e,t,n){var r,i,o={},a=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=r.apply(this,arguments)),i}),u=function(e){var t={};return function(e,n){if("function"==typeof e)return e();if(void 0===t[e]){var r=function(e,t){return t?t.querySelector(e):document.querySelector(e)}.call(this,e,n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}}(),s=null,l=0,c=[],f=n(11);function h(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=o[r.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](r.parts[a]);for(;a<r.parts.length;a++)i.parts.push(E(r.parts[a],t))}else{var u=[];for(a=0;a<r.parts.length;a++)u.push(E(r.parts[a],t));o[r.id]={id:r.id,refs:1,parts:u}}}}function d(e,t){for(var n=[],r={},i=0;i<e.length;i++){var o=e[i],a=t.base?o[0]+t.base:o[0],u={css:o[1],media:o[2],sourceMap:o[3]};r[a]?r[a].parts.push(u):n.push(r[a]={id:a,parts:[u]})}return n}function _(e,t){var n=u(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=c[c.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),c.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=u(e.insertAt.before,n);n.insertBefore(t,i)}}function v(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=c.indexOf(e);t>=0&&c.splice(t,1)}function p(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var r=function(){0;return n.nc}();r&&(e.attrs.nonce=r)}return m(t,e.attrs),_(e,t),t}function m(e,t){Object.keys(t).forEach(function(n){e.setAttribute(n,t[n])})}function E(e,t){var n,r,i,o;if(t.transform&&e.css){if(!(o="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=o}if(t.singleton){var a=l++;n=s||(s=p(t)),r=g.bind(null,n,a,!1),i=g.bind(null,n,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",m(t,e.attrs),_(e,t),t}(t),r=function(e,t,n){var r=n.css,i=n.sourceMap,o=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||o)&&(r=f(r));i&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var a=new Blob([r],{type:"text/css"}),u=e.href;e.href=URL.createObjectURL(a),u&&URL.revokeObjectURL(u)}.bind(null,n,t),i=function(){v(n),n.href&&URL.revokeObjectURL(n.href)}):(n=p(t),r=function(e,t){var n=t.css,r=t.media;r&&e.setAttribute("media",r);if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,n),i=function(){v(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=a()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=d(e,t);return h(n,t),function(e){for(var r=[],i=0;i<n.length;i++){var a=n[i];(u=o[a.id]).refs--,r.push(u)}e&&h(d(e,t),t);for(i=0;i<r.length;i++){var u;if(0===(u=r[i]).refs){for(var s=0;s<u.parts.length;s++)u.parts[s]();delete o[u.id]}}}};var T,b=(T=[],function(e,t){return T[e]=t,T.filter(Boolean).join("\n")});function g(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=b(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,r=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var i,o=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?e:(i=0===o.indexOf("//")?o:0===o.indexOf("/")?n+o:r+o.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")})}},function(e,t){window.gui={add:()=>{}}},function(e,t,n){"use strict";var r=n(1),i=n(15),o=0;e.exports=function e(t){var n,a={},u=[],s=[],l=0,c=0,f={},h=function(r){return Array.isArray(r)?(r.forEach(h),n):((o=!!r.assets&&Array.isArray(r.assets)?e(_(r,t)):i(_(r,t))).once("destroy",E),s.push(o),f[o.id]=o,n);var o},d=function(e){return arguments.length?a[e]?a[e]:f[e]:u},_=function(e,t){"string"==typeof e&&(e={url:e});return void 0===e.isTouchLocked&&(e.isTouchLocked=t.isTouchLocked),void 0===e.blob&&(e.blob=t.blob),void 0===e.basePath&&(e.basePath=t.basePath),e.id=e.id||e.url||String(++o),e.type=e.type||function(e){return e&&e.split("?")[0].split(".").pop().toLowerCase()}(e.url),e.crossOrigin=e.crossOrigin||t.crossOrigin,e.webAudioContext=e.webAudioContext||t.webAudioContext,e.log=t.log,e},v=function(e){var t=l+e;n.emit("progress",t/c)},p=function(e,t,r){Array.isArray(e)&&(e={id:t,file:e,type:r}),l++,n.emit("progress",l/c),a[e.id]=e.file,u.push(e),n.emit("childcomplete",e),T()},m=function(e){c--,n.listeners("error").length?n.emit("error",e):console.error(e),T()},E=function(e){f[e]=null,delete f[e],a[e]=null,delete a[e],u.some(function(t,n){if(t.id===e)return u.splice(n,1),!0})},T=function(){l>=c&&n.emit("complete",u,a,t.id,"group")};return n=Object.create(r.prototype,{_events:{value:{}},id:{get:function(){return t.id}},add:{value:h},start:{value:function(){return c=s.length,s.forEach(function(e){e.on("progress",v).once("complete",p).once("error",m).start()}),s=[],n}},get:{value:d},find:{value:function(e){if(d(e))return d(e);var t=null;return Object.keys(f).some(function(n){return!!(t=f[n].find&&f[n].find(e))}),t}},getLoader:{value:function(e){return f[e]}},loaded:{get:function(){return l>=c}},file:{get:function(){return u}},destroy:{value:function(){for(;s.length;)s.pop().destroy();return n.off("error"),n.off("progress"),n.off("complete"),u=[],a={},t.webAudioContext=null,c=0,l=0,Object.keys(f).forEach(function(e){f[e].destroy()}),f={},n.emit("destroy",n.id),n}}}),t=_(t||{},{basePath:"",blob:!1,touchLocked:!1,crossOrigin:null,webAudioContext:null,log:!1}),Array.isArray(t.assets)&&h(t.assets),n}},function(e,t,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function u(){u.init.call(this)}e.exports=u,u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var s=10;function l(e){return void 0===e._maxListeners?u.defaultMaxListeners:e._maxListeners}function c(e,t,n,r){var i,o,a,u;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=l(e))>0&&a.length>i&&!a.warned){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=a.length,u=s,console&&console.warn&&console.warn(u)}return e}function f(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,o(this.listener,this.target,e))}.bind(r);return i.listener=n,r.wrapFn=i,i}function h(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):_(i,i.length)}function d(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function _(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),u.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},u.prototype.getMaxListeners=function(){return l(this)},u.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var u=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw u.context=a,u}var s=i[e];if(void 0===s)return!1;if("function"==typeof s)o(s,this,t);else{var l=s.length,c=_(s,l);for(n=0;n<l;++n)o(c[n],this,t)}return!0},u.prototype.addListener=function(e,t){return c(this,e,t,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(e,t){return c(this,e,t,!0)},u.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,f(this,e,t)),this},u.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,f(this,e,t)),this},u.prototype.removeListener=function(e,t){var n,r,i,o,a;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},u.prototype.listeners=function(e){return h(this,e,!0)},u.prototype.rawListeners=function(e){return h(this,e,!1)},u.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},u.prototype.listenerCount=d,u.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(e,t,n){"use strict";var r=n(1),i=n(16),o=n(2);e.exports=function(e){var t,n,a,u,s,l,c=e.id,f=e.basePath||"",h=e.url,d=e.type,_=e.crossOrigin,v=e.isTouchLocked,p=e.blob&&i,m=e.webAudioContext,E=e.log,T=function(e){e&&(l={id:c,file:e,type:d},t.emit("progress",1),t.emit("complete",l,c,d),F())},b=function(e,t){n=t||y,(a=new XMLHttpRequest).open("GET",f+h,!0),a.responseType=e,a.addEventListener("progress",g),a.addEventListener("load",n),a.addEventListener("error",N),a.send()},g=function(e){e.lengthComputable&&t.emit("progress",e.loaded/e.total)},y=function(){x()&&T(a.response)},x=function(){return a&&a.status<400?(o.update(a,u,h,E),!0):(N(a&&a.statusText),!1)},M=function(){b("json",function(){if(x()){var e=a.response;"string"==typeof e&&(e=JSON.parse(e)),T(e)}})},R=function(){p?P():A()},A=function(){a=new Image,_&&(a.crossOrigin="anonymous"),a.addEventListener("error",N,!1),a.addEventListener("load",w,!1),a.src=f+h},w=function(e){window.clearTimeout(s),e||!a.error&&a.readyState?T(a):N()},P=function(){b("blob",function(){x()&&((a=new Image).addEventListener("error",N,!1),a.addEventListener("load",L,!1),a.src=window.URL.createObjectURL(a.response))})},L=function(){window.URL.revokeObjectURL(a.src),T(a)},S=function(){m?C():I("audio")},O=function(){p?b("blob"):I("video")},C=function(){b("arraybuffer",function(){x()&&m.decodeAudioData(a.response,function(e){a=null,T(e)},function(e){N(e)})})},I=function(e){a=document.createElement(e),v||(window.clearTimeout(s),s=window.setTimeout(w,2e3),a.addEventListener("canplaythrough",w,!1)),a.addEventListener("error",N,!1),a.preload="auto",a.src=f+h,a.load(),v&&T(a)},N=function(e){window.clearTimeout(s);var n=e;if(a&&a.tagName&&a.error){n="MediaError: "+["","ABORTED","NETWORK","DECODE","SRC_NOT_SUPPORTED"][a.error.code]+" "+a.src}else a&&a.statusText?n=a.statusText:e&&e.message?n=e.message:e&&e.type&&(n=e.type);t.emit("error",'Error loading "'+f+h+'" '+n),D()},F=function(){t.off("error"),t.off("progress"),t.off("complete"),a&&(a.removeEventListener("progress",g),a.removeEventListener("load",n),a.removeEventListener("error",N),a.removeEventListener("load",w),a.removeEventListener("canplaythrough",w),a.removeEventListener("load",L))},D=function(){F(),a&&a.abort&&a.readyState<4&&a.abort(),a=null,m=null,l=null,window.clearTimeout(s),t.emit("destroy",c)};return t=Object.create(r.prototype,{_events:{value:{}},id:{value:e.id},start:{value:function(){switch(u=Date.now(),d){case"json":M();break;case"jpg":case"png":case"gif":case"webp":case"svg":R();break;case"mp3":case"ogg":case"opus":case"wav":case"m4a":S();break;case"ogv":case"mp4":case"webm":case"hls":O();break;case"bin":case"binary":b("arraybuffer");break;case"txt":case"text":b("text");break;default:throw"AssetsLoader ERROR: Unknown type for file with URL: "+f+h+" ("+d+")"}}},loaded:{get:function(){return!!l}},file:{get:function(){return l}},destroy:{value:D}})}},function(e,t,n){"use strict";e.exports=function(){try{return!!new Blob}catch(e){return!1}}()},,,,function(e,t,n){"use strict";n.r(t);n(7),n(12);var r=n(0),i=n.n(r);var o=[{id:"irr_negx",url:"assets/img/irr_negx.hdr",type:"binary"},{id:"irr_negy",url:"assets/img/irr_negy.hdr",type:"binary"},{id:"irr_negz",url:"assets/img/irr_negz.hdr",type:"binary"},{id:"irr_posx",url:"assets/img/irr_posx.hdr",type:"binary"},{id:"irr_posy",url:"assets/img/irr_posy.hdr",type:"binary"},{id:"irr_posz",url:"assets/img/irr_posz.hdr",type:"binary"},{id:"liquid",url:"assets/img/liquid.jpg",type:"jpg"},{id:"studio_radiance",url:"assets/img/studio_radiance.dds",type:"binary"}];const a={};let u=[];a.init=function(){let e={};u=o.map(t=>{const n=function(e){const t=e.split(".");return t[t.length-1]}(t.url),o=function(e){return assets.find(t=>t.id===e).file}(t.id);let a;switch(n){case"jpg":case"png":return a=new r.GLTexture(o),{id:t.id,file:a};case"hdr":let u=t.id.split("_")[0];a=i.a.HDRLoader.parse(o);const s={id:t.id,file:a};return e[u]||(e[u]=[]),e[u].push(s),s;case"dds":return a=r.GLCubeTexture.parseDDS(o),{id:t.id,file:a};case"obj":const l=r.ObjLoader.parse(o);return{id:t.id,file:l}}});for(let t in e)if(6==e[t].length){console.log("Generate Cubemap :",t);const e=[a.get(`${t}_posx`),a.get(`${t}_negx`),a.get(`${t}_posy`),a.get(`${t}_negy`),a.get(`${t}_posz`),a.get(`${t}_negz`)],n=new i.a.GLCubeTexture(e);u.push({id:t,file:n})}u.length>0&&(console.debug("ASSETS:"),console.table(u))},a.get=function(e){return u.find(t=>t.id===e).file};var s=a,l={TEXTURE_SIZE:128,TEXTURE_DOWNSAMPLE:2,DENSITY_DISSIPATION:.992,VELOCITY_DISSIPATION:.9975,PRESSURE_DISSIPATION:.996,PRESSURE_ITERATIONS:20,SPLAT_RADIUS:.04,NUM_CIRCLES:10,PLANE_SIZE:10,NUM_PARTICLES:150};let c;var f=function(){return c||((c=i.a.Geom.bigTriangle()).id=`BigTriangle${Math.floor(10*Math.random())}`),c};const h=e=>{let t=e/l.PLANE_SIZE*2;return t=.5*t+.5,l.TEXTURE_SIZE*t};var d=class extends r.EventDispatcher{constructor(e){super();const t=l.PLANE_SIZE,n=i.a.Geom.plane(t,t,1,"xz");this._detector=new r.TouchDetector(n,e),this._detector.on("onHit",e=>this._onMove(e)),this._detector.on("onUp",e=>this._onUp(e)),this._position=vec3.create(),this._prePos=vec3.create(),this._isHit=!1}_onUp(e){this._isHit=!1}_onMove(e){let{hit:t}=e.detail;t[2]*=-1,this._isHit?(vec3.copy(this._prePos,this._position),vec3.copy(this._position,t)):(vec3.copy(this._prePos,t),vec3.copy(this._position,t)),this._isHit=!0;let n=h(this._position[0]),r=h(this._position[2]),i=120*(n-h(this._prePos[0])),o=120*-(r-h(this._prePos[2]));this.trigger("onDrag",{x:n,y:r,dx:i,dy:o,radius:.005})}};var _=class{constructor(){return this._uniforms={},this._uniformTextures=[],this._fbo,this._clearColor={r:0,g:0,b:0,a:0},this}setClearColor(e=0,t=0,n=0,r=0){return this._clearColor.r=e,this._clearColor.g=t,this._clearColor.b=n,this._clearColor.a=r,this}useProgram(e,t){return e instanceof r.GLShader?this._shader=e:this._shader=new r.GLShader(e,t),this}setMesh(e){return this._mesh=e,this}createMesh(e){return this._mesh=new r.Mesh(e),this}bufferVertex(e){return this._mesh||(this._mesh=new r.Mesh),this._mesh.bufferVertex(e),this}bufferTexCoord(e){return this._mesh||(this._mesh=new r.Mesh),this._mesh.bufferTexCoord(e),this}bufferNormal(e){return this._mesh||(this._mesh=new r.Mesh),this._mesh.bufferNormal(e),this}bufferIndex(e){return this._mesh||(this._mesh=new r.Mesh),this._mesh.bufferIndex(e),this}bufferInstance(e,t){return this._mesh?(this._mesh.bufferInstance(e,t),this):(console.warn("Need to create mesh first"),this)}bufferData(e,t){return this._mesh||(this._mesh=new r.Mesh),this._mesh.bufferData(e,t),this}uniform(e,t,n){return this._uniforms[e]={type:t,value:n},this}uniformTexture(e,t,n){return void 0!==n?this._uniformTextures[n]={name:e,texture:t}:this._uniformTextures.push({name:e,texture:t}),this}bindFrameBuffer(e){return this._fbo=e,this}draw(){if(this._shader&&this._mesh){if(this._fbo){const{r:e,g:t,b:n,a:i}=this._clearColor;this._fbo.bind(),r.GL.clear(e,t,n,i)}this._shader.bind();for(const e in this._uniforms){const t=this._uniforms[e];this._shader.uniform(e,t.type,t.value)}return this._uniformTextures.forEach((e,t)=>{void 0!==e&&(this._shader.uniform(e.name,"uniform1i",t),e.texture.bind(t))}),r.GL.draw(this._mesh),this._fbo&&this._fbo.unbind(),this}}get shader(){return this._shader}get framebuffer(){return this._fbo}},v="precision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTextureCoord;\nuniform float uTimestep;\nuniform float uDissipation;\nuniform vec2 uTexelSize;      // 1 / grid scale \nuniform sampler2D textureVel;  // input textureVel\nuniform sampler2D textureMap;         // quantity to advect\n\nvoid main() {\n\tvec2 pos = vTextureCoord - uTimestep * uTexelSize * texture2D(textureVel, vTextureCoord).xy;\n\tgl_FragColor = uDissipation * texture2D(textureMap, pos);\n}",p="precision highp float;\nprecision mediump sampler2D;\n#define GLSLIFY 1\n\nvarying vec2 vTextureCoord;        // grid coordinates\nuniform vec2 uTexelSize;\nuniform sampler2D textureVel; // vector field\n\nvec2 sampleVelocity(in vec2 uv) {\n    vec2 mult = vec2(1.0, 1.0);\n    if (uv.x < 0.0 || uv.x > 1.0) { mult.x = -1.0; }\n    if (uv.y < 0.0 || uv.y > 1.0) { mult.y = -1.0; }\n    return texture2D(textureVel, uv).xy;\n}\n\nvoid main() {\n  float L = sampleVelocity(vTextureCoord - vec2(uTexelSize.x, 0.0)).x;\n  float R = sampleVelocity(vTextureCoord + vec2(uTexelSize.x, 0.0)).x;\n  float T = sampleVelocity(vTextureCoord + vec2(0.0, uTexelSize.y)).y;\n  float B = sampleVelocity(vTextureCoord - vec2(0.0, uTexelSize.y)).y;\n  float div = 0.5 * (R - L + T - B);\n  gl_FragColor = vec4(div, 0.0, 0.0, 1.0);\n}",m="precision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTextureCoord;\nuniform sampler2D texturePressure;\nuniform float uDissipation;\n\nvoid main() {\n    gl_FragColor = uDissipation * texture2D(texturePressure, vTextureCoord);\n}",E="precision highp float;\nprecision mediump sampler2D;\n#define GLSLIFY 1\n\nvarying vec2 vTextureCoord; // grid coordinates    \nuniform vec2 uTexelSize;\nuniform sampler2D texturePressure;\nuniform sampler2D textureDivergence;\n\nvoid main() {\n  // left, right, bottom, and top texturePressure samples\n  float L = texture2D(texturePressure, vTextureCoord - vec2(uTexelSize.x, 0.0)).x;\n  float R = texture2D(texturePressure, vTextureCoord + vec2(uTexelSize.x, 0.0)).x;\n  float B = texture2D(texturePressure, vTextureCoord - vec2(0.0, uTexelSize.y)).x;\n  float T = texture2D(texturePressure, vTextureCoord + vec2(0.0, uTexelSize.y)).x;\n\n  // textureDivergence sample, from center\n  float bC = texture2D(textureDivergence, vTextureCoord).x;\n  \n  // evaluate Jacobi iteration\n  gl_FragColor = vec4(0.25 * (L + R + B + T - bC), 0, 0, 1);\n}",T="precision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTextureCoord;\nuniform vec2 uTexelSize;\nuniform sampler2D texturePressure;\nuniform sampler2D textureVel;\n\nvoid main() {\n\tfloat pL     = texture2D(texturePressure, vTextureCoord - vec2(uTexelSize.x, 0.0)).x;\n\tfloat pR     = texture2D(texturePressure, vTextureCoord + vec2(uTexelSize.x, 0.0)).x;\n\tfloat pB     = texture2D(texturePressure, vTextureCoord - vec2(0.0, uTexelSize.y)).x;\n\tfloat pT     = texture2D(texturePressure, vTextureCoord + vec2(0.0, uTexelSize.y)).x;\n\tvec2 v       = texture2D(textureVel, vTextureCoord).xy;\n\tgl_FragColor = vec4(v - vec2(pR - pL, pT - pB), 0.0, 1.0);\n}",b="precision highp float;\nprecision mediump sampler2D;\n#define GLSLIFY 1\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uTarget;\nuniform sampler2D texture;\nuniform float aspectRatio;\nuniform vec3 color;\nuniform vec2 point;\nuniform float radius;\nuniform float uTime;\nuniform float uIsVelocity;\n\nvoid main () {\n    vec2 p          = vTextureCoord - point.xy;\n    p.x             *= aspectRatio;\n    \n    float t         = uTime * 0.1;\n    vec2 uv         = vTextureCoord;\n    uv.x            = uv.x - uTime * 0.01;\n    uv.y            = uv.y + sin(uTime * 0.04883974) * 0.1;\n    uv              *= 1.2789145;\n    vec3 colorMap   = vec3(1.0);\n    // colorMap        = mix(colorMap, vec3(1.0), uIsVelocity);\n    \n    \n    float percent   = exp(-dot(p, p) / radius);\n    percent         = smoothstep(0.0, 0.5, percent);\n    \n    \n    float force     = length(color.xy);\n    vec2 dir       = normalize(p);\n    vec3 colorVel   = vec3(dir * force, 1.0);\n    colorVel        = mix(color, colorVel, .5);\n    vec3 colorFinal = mix(color, colorVel, uIsVelocity);\n    vec3 splat      = percent * colorFinal * colorMap;\n    \n    vec3 base       = texture2D(uTarget, vTextureCoord).xyz;\n    gl_FragColor    = vec4(base + splat, 1.0);\n}",g="// copy.frag\n\n#define SHADER_NAME SIMPLE_TEXTURE\n\nprecision highp float;\n#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\n\nuniform float uTime;\nuniform float uRadius;\nuniform float uStrength;\nuniform float uIsVelocity;\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, -s, s, c);\n\treturn m * v;\n}\n\nvec3 mod289(vec3 x) {\treturn x - floor(x * (1.0 / 289.0)) * 289.0;\t}\n\nvec4 mod289(vec4 x) {\treturn x - floor(x * (1.0 / 289.0)) * 289.0;\t}\n\nvec4 permute(vec4 x) {\treturn mod289(((x*34.0)+1.0)*x);\t}\n\nvec4 taylorInvSqrt(vec4 r) {\treturn 1.79284291400159 - 0.85373472095314 * r;}\n\nfloat snoise(vec3 v) { \n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n  i = mod289(i); \n  vec4 p = permute( permute( permute( \n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) \n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), \n                                dot(p2,x2), dot(p3,x3) ) );\n}\n\nvec3 snoiseVec3( vec3 x ){\n\n  float s  = snoise(vec3( x ));\n  float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));\n  float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));\n  vec3 c = vec3( s , s1 , s2 );\n  return c;\n\n}\n\nvec3 curlNoise( vec3 p ){\n  \n  const float e = .1;\n  vec3 dx = vec3( e   , 0.0 , 0.0 );\n  vec3 dy = vec3( 0.0 , e   , 0.0 );\n  vec3 dz = vec3( 0.0 , 0.0 , e   );\n\n  vec3 p_x0 = snoiseVec3( p - dx );\n  vec3 p_x1 = snoiseVec3( p + dx );\n  vec3 p_y0 = snoiseVec3( p - dy );\n  vec3 p_y1 = snoiseVec3( p + dy );\n  vec3 p_z0 = snoiseVec3( p - dz );\n  vec3 p_z1 = snoiseVec3( p + dz );\n\n  float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;\n  float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;\n  float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;\n\n  const float divisor = 1.0 / ( 2.0 * e );\n  return normalize( vec3( x , y , z ) * divisor );\n\n}\n\n#define PI 3.141592653\n\nvoid main(void) {\n\tvec2 center  = vec2(.5);\n\n\tfloat r = 0.15 + sin(cos(uTime) * 4.489538925) * 0.0;\n\tvec2 v       = vec2(r, 0.0);\n\tv            = rotate(v, uTime);\n\tcenter       += v;\n\t\n\tvec3 noise = curlNoise(vec3(vTextureCoord * 2.0, uTime));\n\n\t// vec2 dir     = normalize(vTextureCoord - center) * 300.0;\n\n\tvec2 dir = normalize(v);\n\tdir = rotate(dir, PI * 0.5);\n\tdir *= uStrength;\n\tfloat d      = distance(vTextureCoord, center);\n\td            = smoothstep(uRadius, 0.0, d);\n\t\n\t\n\tvec3 color   = uIsVelocity > 0.5 ? vec3(dir, 0.0) : vec3(uStrength);\n\tif(uIsVelocity > .5) {\n\t\tcolor += noise * 0.5;\n\t} else {\n\t\tcolor += noise.rrr * uStrength;\n\t}\n\tcolor        *= d;\n\t\n\tvec3 base    = texture2D(texture, vTextureCoord).xyz;\n\t\n\tgl_FragColor = vec4(color + base, 1.0);\n}";var y=class{constructor(e){this.mouse=[0,0,0],this._camera=e,this._texelSize=[1/l.TEXTURE_SIZE,1/l.TEXTURE_SIZE],this._initTextures(),this._initTouches(),this._initShaders()}_initShaders(){const e=i.a.Geom.bigTriangle();this.mesh=e;const t=i.a.ShaderLibs.bigTriangleVert;this._drawAdvect=(new _).useProgram(t,v).setMesh(e).setClearColor(0,0,0,1).uniform("uTimestep","float",.001).uniform("uTexelSize","vec2",this._texelSize),this._drawDivergence=(new _).useProgram(t,p).setMesh(e).setClearColor(0,0,0,1).bindFrameBuffer(this._fboDivergence).uniform("uTexelSize","vec2",this._texelSize),this._drawClear=(new _).useProgram(t,m).setMesh(e).setClearColor(0,0,0,1).uniform("uDissipation","float",l.PRESSURE_DISSIPATION),this._drawJacobi=(new _).useProgram(t,E).setMesh(e).setClearColor(0,0,0,1).uniform("uTexelSize","vec2",this._texelSize),this._drawGradient=(new _).useProgram(t,T).setMesh(e).setClearColor(0,0,0,1).uniform("uTexelSize","vec2",this._texelSize),this._shaderSplat=new i.a.GLShader(i.a.ShaderLibs.bigTriangleVert,b),this._shaderSplat.bind(),this._shaderSplat.uniform("texture","uniform1i",1),this._shaderSplat.uniform("uTarget","uniform1i",0),this._drawSplat=(new _).useProgram(t,g).setMesh(e)}_initTextures(){this._texture=s.get("liquid"),this._texture.minFilter=r.GL.LINEAR_MIPMAP_NEAREST,this._texture.magFilter=r.GL.LINEAR,this._texture.wrapS=this._texture.wrapT=r.GL.MIRRORED_REPEAT;const e=l.TEXTURE_SIZE;let t=r.GL.FLOAT;r.GL.isMobile&&navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)&&(t=r.GL.HALF_FLOAT);const n={minFilter:r.GL.LINEAR,magFilter:r.GL.LINEAR,wrapS:r.GL.CLAMP_TO_EDGE,wrapT:r.GL.CLAMP_TO_EDGE,type:t};this._fboVelocity=new r.FboPingPong(e,e,n),this._fboDensity=new r.FboPingPong(e,e,n),this._fboPressure=new r.FboPingPong(e,e,n),this._fboDivergence=new i.a.FrameBuffer(e,e,n)}_initTouches(){this._touch=[0,0],this.enableTouch=!0,this._touchDetect=new d(this._camera),this._touchDetect.on("onDrag",e=>{const{x:t,y:n,dx:r,dy:i,radius:o}=e.detail;this.createSplat(t,n,r,i,3*o)})}advect(e,t,n){this._drawAdvect.bindFrameBuffer(e).uniformTexture("textureVel",this._fboVelocity.read.texture,0).uniformTexture("textureMap",t,1).uniform("uDissipation","float",n).draw()}createSplat(e,t,n,i,o){o=o||l.SPLAT_RADIUS,this._fboVelocity.write.bind(),r.GL.clear(0,0,0,1),this._shaderSplat.bind(),this._shaderSplat.uniform("radius","float",o),this._shaderSplat.uniform("aspectRatio","float",1),this._shaderSplat.uniform("point","vec2",[e/l.TEXTURE_SIZE,t/l.TEXTURE_SIZE]),this._shaderSplat.uniform("color","vec3",[1*n,1*-i,1]),this._shaderSplat.uniform("uIsVelocity","float",1),this._fboVelocity.read.texture.bind(0),this._texture.bind(1),r.GL.draw(this.mesh),this._fboVelocity.write.unbind(),this._fboVelocity.swap();let a=.0075;this._fboDensity.write.bind(),r.GL.clear(0,0,0,1),this._shaderSplat.uniform("color","vec3",[a,a,a]),this._shaderSplat.uniform("uIsVelocity","float",0),this._fboDensity.read.texture.bind(0),r.GL.draw(this.mesh),this._fboDensity.write.unbind(),this._fboDensity.swap()}_debugSplat(){const e=4*i.a.Scheduler.deltaTime;let t=.1*Math.sin(i.a.Scheduler.deltaTime)+.3;this._drawSplat.bindFrameBuffer(this._fboVelocity.write).uniform("uTime","float",e).uniform("uRadius","float",.6*t).uniform("uStrength","float",100).uniform("uIsVelocity","float",1).uniformTexture("texture",this._fboVelocity.read.texture,0).draw(),this._fboVelocity.swap(),this._drawSplat.bindFrameBuffer(this._fboDensity.write).uniform("uIsVelocity","float",0).uniform("uStrength","float",.02).uniformTexture("texture",this._fboDensity.read.texture,0).draw(),this._fboDensity.swap(),t=.1*Math.cos(i.a.Scheduler.deltaTime)+.3,this._drawSplat.bindFrameBuffer(this._fboVelocity.write).uniform("uTime","float",e+Math.PI).uniform("uRadius","float",.6*t).uniform("uStrength","float",100).uniform("uIsVelocity","float",1).uniformTexture("texture",this._fboVelocity.read.texture,0).draw(),this._fboVelocity.swap(),this._drawSplat.bindFrameBuffer(this._fboDensity.write).uniform("uIsVelocity","float",0).uniform("uStrength","float",.02).uniformTexture("texture",this._fboDensity.read.texture,0).draw(),this._fboDensity.swap()}update(){this._debugSplat(),this.advect(this._fboVelocity.write,this._fboVelocity.read.texture,l.VELOCITY_DISSIPATION),this._fboVelocity.swap(),this.advect(this._fboDensity.write,this._fboDensity.read.texture,l.DENSITY_DISSIPATION),this._fboDensity.swap(),this._drawDivergence.uniformTexture("textureVel",this._fboVelocity.read.texture,0).draw(),this._drawClear.bindFrameBuffer(this._fboPressure.write).uniformTexture("texturePressure",this._fboPressure.read.texture,0).draw(),this._fboPressure.swap();for(let e=0;e<l.PRESSURE_ITERATIONS;e++)this._drawJacobi.bindFrameBuffer(this._fboPressure.write).uniformTexture("texturePressure",this._fboPressure.read.texture,0).uniformTexture("textureDivergence",this._fboDivergence.texture,1).draw(),this._fboPressure.swap();this._drawGradient.bindFrameBuffer(this._fboVelocity.write).uniformTexture("texturePressure",this._fboPressure.read.texture,0).uniformTexture("textureVel",this._fboVelocity.read.texture,1).draw(),this._fboVelocity.swap()}get velocity(){return this._fboVelocity.read.texture}get density(){return this._fboDensity.read.texture}get divergence(){return this._fboDivergence.texture}get pressure(){return this._fboPressure.read.texture}get allTextures(){return[this.velocity,this.density,this.divergence,this.pressure]}},x="// basic.vert\n\nprecision highp float;\n#define GLSLIFY 1\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\nuniform mat3 uModelViewMatrixInverse;\n\nuniform sampler2D texture;\nuniform float uCap;\nuniform float uHeight;\n\nvarying vec2 vTextureCoord;\n\nvarying vec3 vNormal;\nvarying vec3 vPosition;\nvarying vec3 vWsPosition;\nvarying vec3 vEyePosition;\nvarying vec3 vWsNormal;\n\nfloat luma(vec3 color) {\n  return dot(color, vec3(0.299, 0.587, 0.114));\n}\n\nvoid main(void) {\n\tvec3 color              = texture2D(texture, aTextureCoord).rgb;\n\tfloat h                 = pow(luma(color), 2.0) * uHeight * 0.5;\n\th \t\t\t\t\t\t= min(uCap, h);\n\tvec3 position           = aVertexPosition;\n\tposition.y \t\t\t\t= h;\n\tvec4 worldSpacePosition = uModelMatrix * vec4(position, 1.0);\n\tvec4 viewSpacePosition  = uViewMatrix * worldSpacePosition;\n\t\n\tvNormal                 = uNormalMatrix * aNormal;\n\tvPosition               = viewSpacePosition.xyz;\n\tvWsPosition             = worldSpacePosition.xyz;\n\t\n\tvec4 eyeDirViewSpace    = viewSpacePosition - vec4( 0, 0, 0, 1 );\n\tvEyePosition            = -vec3( uModelViewMatrixInverse * eyeDirViewSpace.xyz );\n\tvWsNormal               = normalize( uModelViewMatrixInverse * vNormal );\n\t\n\tgl_Position             = uProjectionMatrix * viewSpacePosition;\n\t\n\tvTextureCoord           = aTextureCoord;\n}",M="// pbr.frag\n\n#extension GL_EXT_shader_texture_lod : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D \ttexture;\nuniform sampler2D \ttextureNormal;\nuniform samplerCube uRadianceMap;\nuniform samplerCube uIrradianceMap;\n\nuniform vec3\t\tuBaseColor;\nuniform float\t\tuRoughness;\nuniform float\t\tuRoughness4;\nuniform float\t\tuMetallic;\nuniform float\t\tuSpecular;\n\nuniform float\t\tuExposure;\nuniform float\t\tuGamma;\n\nvarying vec3        vNormal;\nvarying vec3        vPosition;\nvarying vec3\t\tvEyePosition;\nvarying vec3\t\tvWsNormal;\nvarying vec3\t\tvWsPosition;\nvarying vec2 \t\tvTextureCoord;\n\n#define saturate(x) clamp(x, 0.0, 1.0)\n#define PI 3.1415926535897932384626433832795\n\n// Filmic tonemapping from\n// http://filmicgames.com/archives/75\n\nconst float A = 0.15;\nconst float B = 0.50;\nconst float C = 0.10;\nconst float D = 0.20;\nconst float E = 0.02;\nconst float F = 0.30;\n\nvec3 Uncharted2Tonemap( vec3 x )\n{\n\treturn ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\n}\n\n// https://www.unrealengine.com/blog/physically-based-shading-on-mobile\nvec3 EnvBRDFApprox( vec3 SpecularColor, float Roughness, float NoV )\n{\n\tconst vec4 c0 = vec4( -1, -0.0275, -0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, -0.04 );\n\tvec4 r = Roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( -9.28 * NoV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn SpecularColor * AB.x + AB.y;\n}\n\n// http://the-witness.net/news/2012/02/seamless-cube-map-filtering/\nvec3 fix_cube_lookup( vec3 v, float cube_size, float lod ) {\n\tfloat M = max(max(abs(v.x), abs(v.y)), abs(v.z));\n\tfloat scale = 1.0 - exp2(lod) / cube_size;\n\tif (abs(v.x) != M) v.x *= scale;\n\tif (abs(v.y) != M) v.y *= scale;\n\tif (abs(v.z) != M) v.z *= scale;\n\treturn v;\n}\n\nvec3 correctGamma(vec3 color, float g) {\n\treturn pow(color, vec3(1.0/g));\n}\n\nvec3 getPbr(vec3 N, vec3 V, vec3 baseColor, float roughness, float metallic, float specular) {\n\tvec3 diffuseColor\t= baseColor - baseColor * metallic;\n\tvec3 specularColor\t= mix( vec3( 0.08 * specular ), baseColor, specular );\t\n\n\tvec3 color;\n\tfloat roughness4 = pow(roughness, 4.0);\n\t\n\t// sample the pre-filtered cubemap at the corresponding mipmap level\n\tfloat numMips\t\t= 6.0;\n\tfloat mip\t\t\t= numMips - 1.0 + log2(roughness);\n\tvec3 lookup\t\t\t= -reflect( V, N );\n\tlookup\t\t\t\t= fix_cube_lookup( lookup, 512.0, mip );\n\tvec3 radiance\t\t= pow( textureCubeLodEXT( uRadianceMap, lookup, mip ).rgb, vec3( 2.2 ) );\n\tvec3 irradiance\t\t= pow( textureCube( uIrradianceMap, N ).rgb, vec3( 1 ) );\n\t\n\t// get the approximate reflectance\n\tfloat NoV\t\t\t= saturate( dot( N, V ) );\n\tvec3 reflectance\t= EnvBRDFApprox( specularColor, roughness4, NoV );\n\t\n\t// combine the specular IBL and the BRDF\n    vec3 diffuse  \t\t= diffuseColor * irradiance;\n    vec3 _specular \t\t= radiance * reflectance;\n\tcolor\t\t\t\t= diffuse + _specular;\n\n\treturn color;\n}\n\nfloat luma(vec3 color) {\n  return dot(color, vec3(0.299, 0.587, 0.114));\n}\n\nvoid main() {\n\tvec3 colorNormal \t= texture2D(textureNormal, vTextureCoord).rgb;\n\tvec3 N \t\t\t\t= normalize(colorNormal);\n\tvec3 V \t\t\t\t= normalize( vEyePosition );\n\n\tvec3 baseColor = texture2D(texture, vTextureCoord).rgb;\n\tfloat br = luma(baseColor);\n\tbr = pow(br + 0.0, 3.0);\n\n\tbaseColor = vec3(br);\n\t\n\tvec3 color \t\t\t= getPbr(N, V, baseColor, uRoughness, uMetallic, uSpecular);\n\n\t// apply the tone-mapping\n\tcolor\t\t\t\t= Uncharted2Tonemap( color * uExposure );\n\t// white balance\n\tcolor\t\t\t\t= color * ( 1.0 / Uncharted2Tonemap( vec3( 20.0 ) ) );\n\t\n\t// gamma correction\n\tcolor\t\t\t\t= pow( color, vec3( 1.0 / uGamma ) );\n\n\t// output the fragment color\n    gl_FragColor\t\t= vec4( color * 0.5, 1.0 );\n    // gl_FragColor\t\t= vec4( baseColor, 1.0 );\n\n}";var R=class extends i.a.View{constructor(){super(x,M)}_init(){const e=l.PLANE_SIZE;this.mesh=i.a.Geom.plane(e,e,120,"xz"),this.roughness=0,this.specular=1,this.metallic=0,this.baseColor=[100,100,100]}render(e,t,n,i){const o=this.baseColor.map(e=>e/255);this.shader.bind(),this.shader.uniform("texture","uniform1i",0),e.bind(0),this.shader.uniform("textureNormal","uniform1i",1),t.bind(1),this.shader.uniform("uRadianceMap","uniform1i",3),this.shader.uniform("uIrradianceMap","uniform1i",2),n.bind(3),i.bind(2),this.shader.uniform("uBaseColor","uniform3fv",o),this.shader.uniform("uRoughness","uniform1f",this.roughness),this.shader.uniform("uMetallic","uniform1f",this.metallic),this.shader.uniform("uSpecular","uniform1f",this.specular),this.shader.uniform("uExposure","uniform1f",params.exposure),this.shader.uniform("uGamma","uniform1f",params.gamma),this.shader.uniform("uCap","float",params.cap),this.shader.uniform("uHeight","float",params.height),r.GL.draw(this.mesh)}},A="// basic.vert\n\nprecision highp float;\n#define GLSLIFY 1\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\nuniform mat3 uModelViewMatrixInverse;\n\nuniform sampler2D texture;\nuniform float uCap;\nuniform float uHeight;\n\nvarying vec2 vTextureCoord;\n\nvarying vec3 vNormal;\nvarying vec3 vPosition;\nvarying vec3 vWsPosition;\nvarying vec3 vEyePosition;\nvarying vec3 vWsNormal;\n\nfloat luma(vec3 color) {\n  return dot(color, vec3(0.299, 0.587, 0.114));\n}\n\nvoid main(void) {\n\tvec3 color              = texture2D(texture, aTextureCoord).rgb;\n\tfloat h                 = luma(color) * uHeight;\n\th \t\t\t\t\t\t= min(uCap, h);\n\tvec3 position           = aVertexPosition;\n\tposition.y \t\t\t\t+= h;\n\tvec4 worldSpacePosition = uModelMatrix * vec4(position, 1.0);\n\tvec4 viewSpacePosition  = uViewMatrix * worldSpacePosition;\n\t\n\tvNormal                 = uNormalMatrix * aNormal;\n\tvPosition               = viewSpacePosition.xyz;\n\tvWsPosition             = worldSpacePosition.xyz;\n\t\n\tvec4 eyeDirViewSpace    = viewSpacePosition - vec4( 0, 0, 0, 1 );\n\tvEyePosition            = -vec3( uModelViewMatrixInverse * eyeDirViewSpace.xyz );\n\tvWsNormal               = normalize( uModelViewMatrixInverse * vNormal );\n\t\n\tgl_Position             = uProjectionMatrix * viewSpacePosition;\n\t\n\tvTextureCoord           = aTextureCoord;\n}",w="// pbr.frag\n\n#extension GL_EXT_shader_texture_lod : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D \ttexture;\nuniform sampler2D \ttextureNormal;\nuniform samplerCube uRadianceMap;\nuniform samplerCube uIrradianceMap;\n\nuniform vec3\t\tuBaseColor;\nuniform float\t\tuRoughness;\nuniform float\t\tuRoughness4;\nuniform float\t\tuMetallic;\nuniform float\t\tuSpecular;\n\nuniform float\t\tuExposure;\nuniform float\t\tuGamma;\n\nvarying vec3        vNormal;\nvarying vec3        vPosition;\nvarying vec3\t\tvEyePosition;\nvarying vec3\t\tvWsNormal;\nvarying vec3\t\tvWsPosition;\nvarying vec2 \t\tvTextureCoord;\n\n#define saturate(x) clamp(x, 0.0, 1.0)\n#define PI 3.1415926535897932384626433832795\n\n// Filmic tonemapping from\n// http://filmicgames.com/archives/75\n\nconst float A = 0.15;\nconst float B = 0.50;\nconst float C = 0.10;\nconst float D = 0.20;\nconst float E = 0.02;\nconst float F = 0.30;\n\nvec3 Uncharted2Tonemap( vec3 x )\n{\n\treturn ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\n}\n\n// https://www.unrealengine.com/blog/physically-based-shading-on-mobile\nvec3 EnvBRDFApprox( vec3 SpecularColor, float Roughness, float NoV )\n{\n\tconst vec4 c0 = vec4( -1, -0.0275, -0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, -0.04 );\n\tvec4 r = Roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( -9.28 * NoV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn SpecularColor * AB.x + AB.y;\n}\n\n// http://the-witness.net/news/2012/02/seamless-cube-map-filtering/\nvec3 fix_cube_lookup( vec3 v, float cube_size, float lod ) {\n\tfloat M = max(max(abs(v.x), abs(v.y)), abs(v.z));\n\tfloat scale = 1.0 - exp2(lod) / cube_size;\n\tif (abs(v.x) != M) v.x *= scale;\n\tif (abs(v.y) != M) v.y *= scale;\n\tif (abs(v.z) != M) v.z *= scale;\n\treturn v;\n}\n\nvec3 correctGamma(vec3 color, float g) {\n\treturn pow(color, vec3(1.0/g));\n}\n\nvec3 getPbr(vec3 N, vec3 V, vec3 baseColor, float roughness, float metallic, float specular) {\n\tvec3 diffuseColor\t= baseColor - baseColor * metallic;\n\tvec3 specularColor\t= mix( vec3( 0.08 * specular ), baseColor, specular );\t\n\n\tvec3 color;\n\tfloat roughness4 = pow(roughness, 4.0);\n\t\n\t// sample the pre-filtered cubemap at the corresponding mipmap level\n\tfloat numMips\t\t= 6.0;\n\tfloat mip\t\t\t= numMips - 1.0 + log2(roughness);\n\tvec3 lookup\t\t\t= -reflect( V, N );\n\tlookup\t\t\t\t= fix_cube_lookup( lookup, 512.0, mip );\n\tvec3 radiance\t\t= pow( textureCubeLodEXT( uRadianceMap, lookup, mip ).rgb, vec3( 2.2 ) );\n\tvec3 irradiance\t\t= pow( textureCube( uIrradianceMap, N ).rgb, vec3( 1 ) );\n\t\n\t// get the approximate reflectance\n\tfloat NoV\t\t\t= saturate( dot( N, V ) );\n\tvec3 reflectance\t= EnvBRDFApprox( specularColor, roughness4, NoV );\n\t\n\t// combine the specular IBL and the BRDF\n    vec3 diffuse  \t\t= diffuseColor * irradiance;\n    vec3 _specular \t\t= radiance * reflectance;\n\tcolor\t\t\t\t= diffuse + _specular;\n\n\treturn color;\n}\n\nfloat luma(vec3 color) {\n  return dot(color, vec3(0.299, 0.587, 0.114));\n}\n\nvoid main() {\n\tvec3 colorNormal \t= texture2D(textureNormal, vTextureCoord).rgb;\n\tvec3 N \t\t\t\t= normalize(colorNormal);\n\tvec3 V \t\t\t\t= normalize( vEyePosition );\n\n\tvec3 baseColor = texture2D(texture, vTextureCoord).rgb;\n\tfloat br = luma(baseColor);\n\tbr = pow(br + 0.1, 3.0);\n\n\tbaseColor = vec3(br);\n\t\n\tvec3 color \t\t\t= getPbr(N, V, baseColor, uRoughness, uMetallic, uSpecular);\n\n\t// apply the tone-mapping\n\tcolor\t\t\t\t= Uncharted2Tonemap( color * uExposure );\n\t// white balance\n\tcolor\t\t\t\t= color * ( 1.0 / Uncharted2Tonemap( vec3( 20.0 ) ) );\n\t\n\t// gamma correction\n\tcolor\t\t\t\t= pow( color, vec3( 1.0 / uGamma ) );\n\n\t// output the fragment color\n    gl_FragColor\t\t= vec4( color, 1.0 );\n    // gl_FragColor\t\t= vec4( baseColor, 1.0 );\n\n}";var P=class extends i.a.View{constructor(){super(A,w)}_init(){this.mesh=new i.a.Mesh(r.GL.LINES);const e=[],t=[],n=[];let o=0,a=-l.PLANE_SIZE/2;const u=l.PLANE_SIZE/100,s=(e,t)=>[a+e*u,.01,-a-t*u];for(let r=0;r<100;r++)for(let i=0;i<100;i++)e.push(s(r,i)),e.push(s(r+1,i)),t.push([r/100,i/100]),t.push([(r+1)/100,i/100]),n.push(o),n.push(o+1),o+=2;this.mesh.bufferVertex(e),this.mesh.bufferTexCoord(t),this.mesh.bufferIndex(n),this.roughness=0,this.specular=1,this.metallic=0,this.baseColor=[100,100,100]}render(e,t,n,i){const o=this.baseColor.map(e=>e/255);this.shader.bind(),this.shader.uniform("texture","uniform1i",0),e.bind(0),this.shader.uniform("textureNormal","uniform1i",1),t.bind(1),this.shader.uniform("uRadianceMap","uniform1i",3),this.shader.uniform("uIrradianceMap","uniform1i",2),n.bind(3),i.bind(2),this.shader.uniform("uCap","float",params.cap),this.shader.uniform("uHeight","float",params.height),this.shader.uniform("uBaseColor","uniform3fv",o),this.shader.uniform("uRoughness","uniform1f",this.roughness),this.shader.uniform("uMetallic","uniform1f",this.metallic),this.shader.uniform("uSpecular","uniform1f",this.specular),this.shader.uniform("uExposure","uniform1f",params.exposure),this.shader.uniform("uGamma","uniform1f",params.gamma),r.GL.draw(this.mesh)}};const L=(e,t)=>{var n=document.createElement("a"),r=(e=>{for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],r=atob(t[1]),i=r.length,o=new Uint8Array(i);i--;)o[i]=r.charCodeAt(i);return new Blob([o],{type:n})})(e.toDataURL({format:"png",multiplier:4})),i=URL.createObjectURL(r);n.download=`${t}.png`,n.href=i,n.click()},S=(e,t)=>{const{innerWidth:n,innerHeight:i}=window;e=e||n,t=t||i,r.GL.setSize(e,t);let o=Math.min(e,n),a=Math.min(t,i);const u=n/e,s=i/t,l=Math.min(u,s);o=e*l,a=t*l,r.GL.canvas.style.width=`${o}px`,r.GL.canvas.style.height=`${a}px`},O=mat4.fromValues(.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1);String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"g"),t)};window.addEventListener("keydown",e=>{if(83===e.keyCode&&e.metaKey){e.preventDefault();const t=new Date;let n=`${t.getFullYear()}.`+`${t.getMonth()+1}.`+`${t.getDate()}-`+`${t.getHours()}.`+`${t.getMinutes()}.`+`${t.getSeconds()}`;L(r.GL.canvas,n)}});var C="// copy.frag\n\n#define SHADER_NAME SIMPLE_TEXTURE\n\nprecision highp float;\n#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\nuniform float uCap;\nuniform float uHeight;\n\nconst vec2 size = vec2(0.05, 0.0);\nconst vec3 off = vec3(-1.0, 0.0, 1.0) * 0.01;\n\nfloat luma(vec3 color) {\n  return dot(color, vec3(0.299, 0.587, 0.114));\n}\n\nfloat getHeight(vec2 uv) {\n\tvec3 color = texture2D(texture, uv).rgb;\n\tfloat br = luma(color) * uHeight;\n\tbr = min(uCap, br);\n\treturn br;\n}\n\nvoid main(void) {\n    float s11      = getHeight(vTextureCoord);\n\t\n\tfloat s01      = getHeight(vTextureCoord + off.xy);\n\tfloat s21      = getHeight(vTextureCoord + off.zy);\n\tfloat s10      = getHeight(vTextureCoord + off.yx);\n\tfloat s12      = getHeight(vTextureCoord + off.yz);\n\t\n\tvec3 va        = normalize(vec3(size.xy,s21-s01));\n\tvec3 vb        = normalize(vec3(size.yx,s12-s10));\n\tvec3 n         = cross(va, vb).rbg;\n\n\tgl_FragColor = vec4(n, 1.0);\n}";var I=class extends i.a.View{constructor(){super(i.a.ShaderLibs.bigTriangleVert,C)}_init(){this.mesh=f()}render(e){this.shader.bind(),this.shader.uniform("texture","uniform1i",0),e.bind(0),this.shader.uniform("uCap","float",params.cap),this.shader.uniform("uHeight","float",params.height),r.GL.draw(this.mesh)}},N="// copy.frag\n\n#define SHADER_NAME SIMPLE_TEXTURE\n\nprecision highp float;\n#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\nuniform vec3 defaultColor;\nuniform float defaultOpacity;\nuniform float luminosityThreshold;\nuniform float smoothWidth;\n\nvoid main(void) {\n\n\tvec4 texel       = texture2D( texture, vTextureCoord );\n\t\n\tvec3 luma        = vec3( 0.299, 0.587, 0.114 );\n\tfloat v          = dot( texel.xyz, luma );\n\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\tfloat alpha      = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\tgl_FragColor = mix( outputColor, texel, alpha );\n}",F="// bloom.frag\n\nprecision highp float;\n#define GLSLIFY 1\n\n#define KERNEL_RADIUS ${kernelRadius}\n#define SIGMA ${kernelRadius}\n\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\nuniform vec2 texSize;\nuniform vec2 direction;\n\nfloat gaussianPdf(in float x, in float sigma) {\n\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n}\n\nvoid main() {\n\tvec2 invSize = 1.0 / texSize;\n\tfloat fSigma = float(SIGMA);\n\tfloat weightSum = gaussianPdf(0.0, fSigma);\n\tvec3 diffuseSum = texture2D( texture, vTextureCoord).rgb * weightSum;\n\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\tfloat x = float(i);\n\t\tfloat w = gaussianPdf(x, fSigma);\n\t\tvec2 uvOffset = direction * invSize * x;\n\t\tvec3 sample1 = texture2D( texture, vTextureCoord + uvOffset).rgb;\n\t\tvec3 sample2 = texture2D( texture, vTextureCoord - uvOffset).rgb;\n\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\tweightSum += 2.0 * w;\n\t}\n\n\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t// gl_FragColor = texture2D(texture, vTextureCoord);\n}",D="// copy.frag\n\n#define SHADER_NAME SIMPLE_TEXTURE\n\n#define NUM_MIPS ${NUM_MIPS}\n\nprecision highp float;\n#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nuniform sampler2D blurTexture1;\nuniform sampler2D blurTexture2;\nuniform sampler2D blurTexture3;\nuniform sampler2D blurTexture4;\nuniform sampler2D blurTexture5;\n\nuniform float bloomStrength;\nuniform float bloomRadius;\nuniform vec4 bloomTintColors[NUM_MIPS];\n\nfloat lerpBloomFactor(const in float factor) { \n\tfloat mirrorFactor = 1.2 - factor;\n\treturn mix(factor, mirrorFactor, bloomRadius);\n}\n\nvec4 getBloom() {\n\tvec4 color = vec4(0.0);\n\t${BLOOMS}\n\treturn color;\n}\n\nvoid main() {\n\tgl_FragColor = bloomStrength * getBloom();\n}";var U=class{constructor(e=5,t=.5){this._numMips=Math.min(e,5),this._startingScale=t,this._initTextures(),this._initViews()}_initTextures(){let e=Math.round(r.GL.width*this._startingScale),t=Math.round(r.GL.height*this._startingScale);this._fbos=[];for(let n=0;n<this._numMips;n++){const n=new i.a.FrameBuffer(e,t),r=new i.a.FrameBuffer(e,t);this._fbos.push({fboV:n,fboH:r}),e=Math.round(e/2),t=Math.round(t/2)}const n={minFilter:r.GL.LINEAR,magFilter:r.GL.LINEAR};window.GL=r.GL;const o=512;this._fboThreshold=new i.a.FrameBuffer(o,o,n),this._fboCompose=new i.a.FrameBuffer(o,o,n)}_initViews(){this.mesh=i.a.Geom.bigTriangle();const e=i.a.ShaderLibs.bigTriangleVert;this.shaderThreshold=new i.a.GLShader(e,N),this.uniformsThreshold={luminosityThreshold:.95,smoothWidth:.01,defaultOpacity:0,defaultColor:[0,0,0]},this.shaderThreshold.bind(),this.shaderThreshold.uniform("texture","uniform1i",0),this.shaderThreshold.uniform(this.uniformsThreshold);const t=[3,5,7,9,11];let n=Math.round(r.GL.width*this._startingScale),o=Math.round(r.GL.height*this._startingScale);this._shadersBloom=[];for(let r=0;r<this._numMips;r++){let a=t[r],u=F.replace(/\${kernelRadius}/g,a);const s=new i.a.GLShader(e,u);s.bind(),s.uniform("texSize","vec2",[n,o]),this._shadersBloom.push(s),n=Math.round(n/2),o=Math.round(o/2)}this.uniformsCompose={bloomStrength:.5,bloomRadius:.4};let a=D.replace(/\${NUM_MIPS}/g,this._numMips),u="";for(let e=0;e<this._numMips;e++)u+=`\tcolor += lerpBloomFactor(bloomTintColors[${e}].a) * vec4(bloomTintColors[${e}].rgb, 1.0) * texture2D(blurTexture${e+1}, vTextureCoord);`;a=a.replace(/\${BLOOMS}/g,u);let s=[];this.shaderCompose=new i.a.GLShader(e,a),this.shaderCompose.bind();for(let e=0;e<this._numMips;e++)this.shaderCompose.uniform(`blurTexture${e+1}`,"uniform1i",e),s=s.concat([1,1,1,1-.2*e]);this.shaderCompose.uniform("bloomTintColors","vec4",s),this.shaderCompose.uniform(this.uniformsCompose)}render(e){this._fboThreshold.bind(),r.GL.clear(0,0,0,0),this.shaderThreshold.bind(),this.shaderThreshold.uniform(this.uniformsThreshold),e.bind(0),r.GL.draw(this.mesh),this._fboThreshold.unbind();let t=this._fboThreshold.getTexture();for(let e=0;e<this._numMips;e++){const{fboV:n,fboH:i}=this._fbos[e],o=this._shadersBloom[e];o.bind(),o.uniform("texture","uniform1i",0),n.bind(),r.GL.clear(0,0,0,0),o.uniform("direction","vec2",[0,1]),t.bind(0),r.GL.draw(this.mesh),n.unbind(),i.bind(),r.GL.clear(0,0,0,0),o.uniform("direction","vec2",[1,0]),n.getTexture().bind(0),r.GL.draw(this.mesh),i.unbind(),t=i.getTexture()}this._fboCompose.bind(),r.GL.clear(0,0,0,0),this.shaderCompose.bind();for(let e=0;e<this._numMips;e++){const{fboH:t}=this._fbos[e];t.getTexture().bind(e)}this.shaderCompose.uniform(this.uniformsCompose),r.GL.draw(this.mesh),this._fboCompose.unbind()}get fbos(){return this._fbos}getTexture(){return this._fboCompose.getTexture()}resize(){}},B="// copy.frag\n\n#define SHADER_NAME SIMPLE_TEXTURE\n\nprecision highp float;\n#define GLSLIFY 1\nvarying vec3 vNormal;\n\nvoid main(void) {\n    gl_FragColor = vec4(vNormal * .5 + .5, 1.0);\n}";var k=class extends r.FrameBuffer{constructor(){super(32,32,{minFilter:r.GL.LINEAR,magFilter:r.GL.LINEAR});const e=new r.CameraOrtho;e.ortho(-1,1,1,-1),e.lookAt([0,0,3],[0,0,0]);const t=i.a.Geom.sphere(1,12),n=new i.a.GLShader(null,B);this.bind(),r.GL.clear(0,0,0,0),r.GL.setMatrices(e),n.bind(),r.GL.draw(t),this.unbind()}},V=[["#112F41","#068587","#4FB99F","#F2B134","#ED553B"],["#F23C50","#FFCB05","#E9F1DF","#4AD9D9","#36B1BF"],["#120D1E","#721825","#7E9DA4","#D8D0C5","#1B1414"],["#233656","#415B76","#7B9BA6","#CDD6D5","#EEF4F2"],["#F2BE54","#CDD4CA","#CDD4CA","#153E5C","#191A1D"],["#F5F4EC","#56638A","#42BA78","#FAC8CD","#F3B918"],["#CEF19E","#A7DDA7","#78BE97","#398689","#0B476D"],["#7B8D6D","#FEAE94","#FF8F7A","#7B403D","#CD5B56"],["#F8B195","#F67280","#C06C84","#6C5B7B","#355C7D"],["#CBD9D6","#8DA593","#D9CBA3","#F2A88C","#D98282"],["#E6E2AF","#A7A37E","#EFECCA","#046380","#002F2F"],["#2C3E50","#E74C3C","#ECF0F1","#3498DB","#2980B9"],["#225378","#1695A3","#ACF0F2","#F3FFE2","#EB7F00"],["#468966","#FFF0A5","#FFB03B","#B64926","#8E2800"],["#004358","#1F8A70","#BEDB39","#FFE11A","#FD7400"],["#DC3522","#D9CB9E","#374140","#2A2C2B","#1E1E20"],["#B9121B","#4C1B1B","#F6E497","#FCFAE1","#BD8D46"],["#2E0927","#D90000","#FF2D00","#FF8C00","#04756F"]],G=n(3),X=n.n(G);var j=(e=1,t="Array")=>{const n=Math.floor(Math.random()*V.length);let r=V[n];return"hex"===e?r:(r=r.map(e=>X()(e)),1===e&&r.forEach(e=>{e.red/=255,e.green/=255,e.blue/=255,e.alpha/=255}),r=r.map(e=>"Array"===t?[e.red,e.green,e.blue]:{r:e.red,g:e.green,b:e.blue}))},H="// basic.vert\n\nprecision highp float;\n#define GLSLIFY 1\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat4 uShadowMatrix;\n\nuniform sampler2D texture;\nuniform float uHeight;\nuniform vec2 uViewport;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vNormal;\nvarying float vHeight;\nvarying vec4 vShadowCoord;\n\nconst float radius = 0.006;\n// const float radius = 0.015;\n\nvoid main(void) {\n\tvec3 pos         = aVertexPosition;\n\tpos.xz           += (aNormal.xy - .5) * 0.01;\n\tvec2 uv          = aTextureCoord;\n\tuv.y             = 1.0 - aTextureCoord.y;\n\t// uv            += (aNormal.yz - 0.5) * 0.0;\n\tpos.y            = pow(texture2D(texture, uv).r, 2.0) * uHeight * 0.5;\n\tvec4 wsPosition  = uModelMatrix * vec4(pos, 1.0);\n\tgl_Position      = uProjectionMatrix * uViewMatrix * wsPosition;\n\tvTextureCoord    = aTextureCoord;\n\tvNormal          = aNormal;\n\t\n\tfloat distOffset = uViewport.y * uProjectionMatrix[1][1] * radius / gl_Position.w;\n\tgl_PointSize     = distOffset * (1.0 + aNormal.z * 0.5);\n\tvHeight          = pos.y / uHeight * 3.5;\n\n\tvShadowCoord = uShadowMatrix * wsPosition;\n}",Y="// copy.frag\n\n#define SHADER_NAME SIMPLE_TEXTURE\n#define uMapSize vec2(1024.0)\n#define FOG_DENSITY 0.2\n\nprecision highp float;\n#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nvarying float vHeight;\nvarying vec4 vShadowCoord;\nuniform sampler2D textureDepth;\nuniform sampler2D textureParticle;\nuniform vec3 uColors[5];\nuniform vec3 uLightPos;\n\nfloat diffuse(vec3 N, vec3 L) {\n\treturn max(dot(N, normalize(L)), 0.0);\n}\n\nvec3 diffuse(vec3 N, vec3 L, vec3 C) {\n\treturn diffuse(N, L) * C;\n}\n\nvec3 getColor(float index) {\n\tif(index < 0.5) {\n\t\treturn uColors[0];\n\t} else if(index < 1.5) {\n\t\treturn uColors[1];\n\t} else if(index < 2.5) {\n\t\treturn uColors[2];\n\t} else if(index < 3.5) {\n\t\treturn uColors[3];\n\t} else {\n\t\treturn uColors[4];\n\t}\n}\n\nfloat rand(vec4 seed4) {\n\tfloat dot_product = dot(seed4, vec4(12.9898,78.233,45.164,94.673));\n\treturn fract(sin(dot_product) * 43758.5453);\n}\n\nfloat PCFShadow(sampler2D depths, vec2 size, vec4 shadowCoord) {\n\tfloat result = 0.0;\n\tfloat bias = 0.005;\n\tvec2 uv = shadowCoord.xy;\n\n\tfor(int x=-1; x<=1; x++){\n\t\tfor(int y=-1; y<=1; y++){\n\t\t\tvec2 off = vec2(x,y) + rand(vec4(gl_FragCoord.xy, float(x), float(y)));\n\t\t\toff /= size;\n\n\t\t\tfloat d = texture2D(depths, uv + off).r;\n\t\t\tif(d < shadowCoord.z - bias) {\n\t\t\t\tresult += 1.0;\n\t\t\t}\n\n\t\t}\n\t}\n\treturn 1.0 -result/9.0;\n\n}\n\nfloat fogFactorExp2(const float dist, const float density) {\n\tconst float LOG2 = -1.442695;\n\tfloat d = density * dist;\n\treturn 1.0 - clamp(exp2(d * d * LOG2), 0.0, 1.0);\n}\n\nvoid main(void) {\n\tvec4 N = texture2D(textureParticle, gl_PointCoord);\n\tif(N.a <= 0.01) {\n\t\tdiscard;\n\t}\n\n\tvec3 normal      = normalize(N.xyz * 2.0 - 1.0);\n\tfloat d          = diffuse(normal, uLightPos);\n\td                = mix(d, 1.0, .5);\n\tvec3 color       = getColor(vHeight * 5.0);\n\t\n\tvec4 shadowCoord = vShadowCoord / vShadowCoord.w;\n\tfloat s          = PCFShadow(textureDepth, uMapSize, shadowCoord);\n\ts                = mix(s, 1.0, .5);\n\tcolor            = color * d * s;\n\tgl_FragColor     = vec4(color, 1.0);\n}",z="// copy.frag\n\n#define SHADER_NAME SIMPLE_TEXTURE\n\nprecision highp float;\n#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nvarying float vHeight;\nuniform sampler2D textureParticle;\nuniform vec3 uColors[5];\nuniform vec3 uLightPos;\n\nfloat diffuse(vec3 N, vec3 L) {\n\treturn max(dot(N, normalize(L)), 0.0);\n}\n\nvec3 diffuse(vec3 N, vec3 L, vec3 C) {\n\treturn diffuse(N, L) * C;\n}\n\nvec3 getColor(float index) {\n\tif(index < 0.5) {\n\t\treturn uColors[0];\n\t} else if(index < 1.5) {\n\t\treturn uColors[1];\n\t} else if(index < 2.5) {\n\t\treturn uColors[2];\n\t} else if(index < 3.5) {\n\t\treturn uColors[3];\n\t} else {\n\t\treturn uColors[4];\n\t}\n}\n\n#define L vec3(1.0, 0.1, 4.0)\n\nvoid main(void) {\n\tvec4 N = texture2D(textureParticle, gl_PointCoord);\n\tif(N.a <= 0.01) {\n\t\tdiscard;\n\t}\n    gl_FragColor = vec4(1.0);\n}";function q(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}var W=class extends i.a.View{constructor(){super(H,Y),this.shaderShadow=new i.a.GLShader(H,z)}_init(){const e=l.PLANE_SIZE,t=[],n=[],o=[],a=[];let u,s,c=0;for(let r=0;r<512;r++)for(let i=0;i<512;i++)u=-e/2+r/512*e,s=-e/2+i/512*e,t.push([u,0,s]),n.push([r/512,i/512]),a.push([Math.random(),Math.random(),Math.random()]),o.push(c),c++;this.mesh=new i.a.Mesh(r.GL.POINTS),this.mesh.bufferVertex(t),this.mesh.bufferNormal(a),this.mesh.bufferTexCoord(n),this.mesh.bufferIndex(o),this.textureParticle=(new k).texture,this.changeColor(),setTimeout(()=>{gui.add(this,"changeColor"),gui.add(this,"shuffle")},500)}changeColor(){const e=q(j());this._colors=e;let t=[];e.forEach(e=>{t=t.concat(e)}),this.shader.bind(),this.shader.uniform("uColors","vec3",t)}shuffle(){const e=q(this._colors);let t=[];e.forEach(e=>{t=t.concat(e)}),this.shader.bind(),this.shader.uniform("uColors","vec3",t)}renderShadow(e){const t=this.shaderShadow;t.bind(),t.uniform("texture","uniform1i",0),e.bind(0),t.uniform("textureParticle","uniform1i",1),this.textureParticle.bind(1),t.uniform("uViewport","vec2",[r.GL.width,r.GL.height]),t.uniform("uHeight","float",params.height),r.GL.draw(this.mesh)}render(e,t,n,i){this.shader.bind(),this.shader.uniform("texture","uniform1i",0),e.bind(0),this.shader.uniform("textureParticle","uniform1i",1),this.textureParticle.bind(1),this.shader.uniform("textureDepth","uniform1i",2),i.bind(2),this.shader.uniform("uShadowMatrix","mat4",n),this.shader.uniform("uViewport","vec2",[r.GL.width,r.GL.height]),this.shader.uniform("uHeight","float",params.height),this.shader.uniform("uLightPos","vec3",t),r.GL.draw(this.mesh)}};var Z=class extends r.Scene{constructor(){super(),this.camera.setPerspective(Math.PI/4,r.GL.aspectRatio,1,50),r.GL.enableAlphaBlending(),this.orbitalControl.rx.value=this.orbitalControl.ry.value=.3,this.orbitalControl.radius.value=10,this.orbitalControl.radius.limit(5,15),this.orbitalControl.rx.limit(.1,Math.PI/2-.1),this.lightPos=[5,.75,2],this._cameraLight=new i.a.CameraOrtho;const e=6.75;this._cameraLight.ortho(-e,e,e,-e,1,50),this._cameraLight.lookAt(this.lightPos,[0,0,0]),this._shadowMatrix=mat4.create(),mat4.multiply(this._shadowMatrix,this._cameraLight.projection,this._cameraLight.viewMatrix),mat4.multiply(this._shadowMatrix,O,this._shadowMatrix),this.resize()}_initTextures(){window.GL=r.GL,this._fboNormal=new i.a.FrameBuffer(1024,1024,{minFilter:r.GL.LINEAR,magFilter:r.GL.LINEAR});const e={minFilter:r.GL.LINEAR,magFilter:r.GL.LINEAR,type:r.GL.FLOAT};this._fboRender=new i.a.FrameBuffer(r.GL.width,r.GL.height,e),this._fboShadow=new i.a.FrameBuffer(1024,1024,{minFilter:r.GL.LINEAR,magFilter:r.GL.LINEAR})}_initViews(){this._bCopy=new i.a.BatchCopy,this._fluid=new y(this.camera),this._vPlane=new R,this._passNormal=new I,this._vLines=new P,this._passBloom=new U(3),this._vParticles=new W}_renderShadowMap(){this._fboShadow.bind(),r.GL.clear(0,0,0,0),r.GL.setMatrices(this._cameraLight),this._vParticles.renderShadow(this._fluid.density,this.lightPos),this._fboShadow.unbind()}render(){this._fluid.update(),this._fboNormal.bind(),r.GL.clear(0,0,0,0),this._passNormal.render(this._fluid.density),this._fboNormal.unbind(),this._renderShadowMap(),r.GL.setMatrices(this.camera),this._fboRender.bind(),r.GL.clear(.05,.05,.05,1),this._vParticles.render(this._fluid.density,this.lightPos,this._shadowMatrix,this._fboShadow.getDepthTexture()),r.GL.enableAdditiveBlending(),r.GL.disable(r.GL.DEPTH_TEST),this._vPlane.render(this._fluid.density,this._fboNormal.getTexture(),s.get("studio_radiance"),s.get("irr")),r.GL.enableAlphaBlending(),this._fboRender.unbind(),this._passBloom.render(this._fboRender.getTexture()),r.GL.clear(0,0,0,0),r.GL.disable(r.GL.DEPTH_TEST),r.GL.viewport(0,0,r.GL.width,r.GL.height),r.GL.enableAdditiveBlending(),this._bCopy.draw(this._fboRender.getTexture()),this._bCopy.draw(this._passBloom.getTexture()),r.GL.enableAlphaBlending();let e=Math.min(256,r.GL.width/4);e=400,r.GL.viewport(0,0,e,e),this._fluid.allTextures.forEach((t,n)=>{r.GL.viewport(n*e,0,e,e)}),r.GL.enable(r.GL.DEPTH_TEST)}resize(e,t){S(e,t),this.camera.setAspectRatio(r.GL.aspectRatio)}},K=n(4),Q=n.n(K);function $(){if(o.length>0){document.body.classList.add("isLoading");new Q.a({assets:o}).on("error",e=>{console.log("Error :",e)}).on("progress",e=>{const t=document.body.querySelector(".Loading-Bar");t&&(t.style.width=`${100*e}%`)}).on("complete",J).start()}else ee()}function J(e){console.log("Image Loaded : ",e),window.assets=e;const t=document.body.querySelector(".Loading-Bar");console.log("Loader :",t),t.style.width="100%",ee(),setTimeout(()=>{document.body.classList.remove("isLoading")},250)}function ee(){const e=document.createElement("canvas"),t=document.body.querySelector(".container");e.className="Main-Canvas",t.appendChild(e),r.GL.init(e,{ignoreWebgl2:!0,preserveDrawingBuffer:!0}),s.init();new Z;window.addEventListener("keydown",e=>{32===e.keyCode&&(params.type=(params.type+1)%3)})}document.body?$():window.addEventListener("DOMContentLoaded",$),window.params={gamma:2.2,exposure:5,highSetting:!0,cap:5,height:2,type:0}}]);